/*
 @overview es6-promise - a tiny implementation of Promises/A+.
 @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 @license   Licensed under MIT license
            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 @version   2.0.1
*/
(function(r,h){"object"===typeof exports&&"object"===typeof module?module.exports=h():"function"===typeof define&&define.amd?define([],h):"object"===typeof exports?exports.RxPlayer=h():r.RxPlayer=h()})(this,function(){return function(r){function h(n){if(c[n])return c[n].exports;var q=c[n]={exports:{},id:n,loaded:!1};r[n].call(q.exports,q,q.exports,h);q.loaded=!0;return q.exports}var c={};h.m=r;h.c=c;h.p="";return h(0)}([function(r,h,c){r.exports=c(33)},function(r,h){function c(a,d){for(var b=-1,e=
a?a.length:0;++b<e;)if(a[b]===d)return b;return-1}function n(a){return!!a&&"object"==typeof a&&"[object Date]"==m.call(a)||!1}function q(a){return!!a&&"function"==typeof a||!1}function f(a){return"number"==typeof a}function a(a){return!!a&&"object"==typeof a||!1}function b(a){return"string"==typeof a}function p(d){for(var b=arguments,e=1;e<b.length;e++){var m=b[e];if(a(m))for(var c=B(m),k=0,J=c.length;k<J;k++)d[c[k]]=m[c[k]]}return d}function x(a,d){for(var b=a?a.length:0,e=-1,m=Array(b);++e<b;)m[e]=
d(a[e],e);return m}function k(a,d,b){for(var e=a?a.length:0,m=-1;++m<e;)b=d(b,a[m],m);return b}function w(a,d){for(var b=a?a.length:0,e=-1,m=[];++e<b;)d(a[e],e)&&m.push(a[e]);return m}function u(a,m){for(var c in a)if(m.hasOwnProperty(c)){var k=a[c],p=m[c];b(k)||f(k)||n(k)?a[c]=p:e(k)?(k.length=0,d.apply(k,p)):a[c]=u(k,p)}return a}h=Object.prototype;var m=h.toString,C=h.hasOwnProperty,e=Array.isArray,d=Array.prototype.push,B=Object.keys||function(a){var d=[],b;for(b in a)a.hasOwnProperty(b)&&d.push(a[b]);
return d};h=function(){var a=0;return function(d){d||(d="");return""+d+a++}}();r.exports={chunk:function(a,d){for(var b=[],e=0,m=-1,c=a?a.length:0;++m<c;)b[e]?b[e].length===d?b[++e]=[a[m]]:b[e].push(a[m]):b[e]=[a[m]];return b},compact:function(a){return w(a,function(a){return null!=a})},contains:function(a,d){return-1<c(a,d)},cloneArray:function(a){for(var d=a?a.length:0,b=-1,e=Array(d);++b<d;)e[b]=a[b];return e},cloneObject:function(a){return p({},a)},defaults:function(a,d){for(var b in d)"undefined"==
typeof a[b]&&(a[b]=d[b]);return a},each:function(a,d){for(var b=a?a.length:0,e=-1;++e<b;)d(a[e],e)},extend:p,values:function(a){for(var d=B(a),b=-1,e=d.length,m=Array(e);++b<e;)m[b]=a[d[b]];return m},filter:w,find:function(a,d){for(var b=-1,e=a?a.length:0;++b<e;)if(d(a[b],b))return a[b]},between:function(a,b,d){for(var e=-1,m=a?a.length:0;++e<m;)if(a[e][b]<=d&&a[e+1]&&d<a[e+1][b])return a[e]},findLast:function(a,b){for(var d=a?a.length:0;0<=--d;)if(b(a[d],d))return a[d]},flatten:function(a,d){a=d?
x(a,d):a;d=-1;for(var b=a?a.length:0,e=[];++d<b;){var m=a[d];if(m&&"object"==typeof m&&"number"==typeof m.length){var c=-1,k=m.length,p=e.length;for(e.length+=k;++c<k;)e[p++]=m[c]}else e.push(m)}return e},groupBy:function(a,d){var b=q(d)?d:function(a){return a[d]};return k(a,function(a,d){var m=b(d);(e(a[m])?a[m]:a[m]=[]).push(d);return a},{})},identity:function(a){return a},indexOf:c,isArray:e,isDate:n,isFunction:q,isNumber:f,isObject:a,isString:b,isPromise:function(a){return!!a&&"function"==typeof a.then},
isObservable:function(a){return!!a&&"function"==typeof a.subscribe},keys:B,last:function(a){return a[a.length-1]},map:x,memoize:function(a,d){var b=function z(){var b=z.cache,e=d?d.apply(this,arguments):arguments[0];return C.call(b,e)?b[e]:b[e]=a.apply(this,arguments)};b.cache={};return b},noop:function(){},pad:function(a,d){a=a.toString();return a.length>=d?a:(Array(d+1).join("0")+a).slice(-d)},pick:function(a,d){return k(d,function(d,b){b in a&&(d[b]=a[b]);return d},{})},pluck:function(a,d){return x(a,
function(a){return a[d]})},reduce:k,simpleMerge:u,sortedIndex:function(a,d,b){var e=0,m=a?a.length:e;for(d=b(d);e<m;){var c=e+m>>>1;b(a[c])<d?e=c+1:m=c}return e},sortedMerge:function(a,d,b){for(var e=0,m=0,c=0,k=a.length,p=d.length,f=[];e<k&&m<p;)a[e][b]<=d[m][b]?(f[c]=a[e],e++,c++):0<c&&d[m][b]<=f[c-1][b]?m++:(f[c]=d[m],m++,c++);if(e<k)for(b=e;b<k;b++)f[c]=a[b],c++;else for(b=m;b<p;b++)f[c]=d[b],c++;return f},tryCatch:function(a){try{return a()}catch(M){return M}},uniqueId:h}},function(r,h){function c(n){this.name=
"AssertionError";this.message=n;Error.captureStackTrace&&Error.captureStackTrace(this,c)}function n(n,f){if(!n)throw new c(f);}c.prototype=Error();n.equal=function(c,f,a){return n(c===f,a)};n.iface=function(c,f,a){n(c,f+" should be an object");for(var b in a)n.equal(typeof c[b],a[b],f+" should have property "+b+" as a "+a[b])};r.exports=n},function(r,h,c){c(5);r.exports=c(13)},function(r,h){function c(){}var n={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4},q=function(){};c.error=q;c.warn=q;c.info=q;c.debug=
q;c.setLevel=function(f){"string"==typeof f&&(f=n[f]);c.error=f>=n.ERROR?console.error.bind(console):q;c.warn=f>=n.WARNING?console.warn.bind(console):q;c.info=f>=n.INFO?console.info.bind(console):q;c.debug=f>=n.DEBUG?console.log.bind(console):q};r.exports=c},function(r,h,c){h=c(13);var n=h.Observable,q=h.SingleAssignmentDisposable;h=h.config;var f=n.fromEvent,a=n.merge,b=n.timer,p=c(20).getBackedoffDelay,x=c(1),k=x.isArray,w=x.map,u=x.noop,m=c(21);h.useNativeEvents=!0;c=n.prototype;c.log=function(){return this};
c.each=function(a){return this.subscribe(a,u)};var C=function(a,d){return a===d};c.changes=function(a){return this.distinctUntilChanged(a,C)};c.customDebounce=function(a,d){var b=this;return n.create(function(e){var c=m(function(a){return e.onNext(a)},a,d),k=b.subscribe(c,function(a){return e.onError(a)},function(){return e.onCompleted()});return function(){c.dispose();k.dispose()}})};c.simpleTimeout=function(a){var d=1>=arguments.length||void 0===arguments[1]?"timeout":arguments[1],b=this;return n.create(function(e){var m=
new q,c=setTimeout(function(){return e.onError(Error(d))},a);m.setDisposable(b.subscribe(function(a){clearTimeout(c);e.onNext(a)},function(a){return e.onError(a)},function(a){return e.onCompleted()}));return function(){clearTimeout(c);m.dispose()}})};r.exports={on:function(b,d){return k(d)?a(w(d,function(a){return f(b,a)})):f(b,d)},first:function(a){return a.take(1)},only:function(a){return n.never().startWith(a)},retryWithBackoff:function(a,d){var e=d.retryDelay,c=d.totalRetry,k=d.shouldRetry;d=
d.resetDelay;var f=0;var n=0<d?m(function(){return f=0},d):u;return function E(){for(var d=0,m=arguments.length,u=Array(m);d<m;d++)u[d]=arguments[d];return a.apply(null,u)["catch"](function(a){if(k&&!k(a,f)||f++>=c)throw a;a=p(e,f);return b(a).flatMap(function(){n();return E.apply(null,u)})})}}}},function(r,h,c){r.exports=c(49).Promise},function(r,h,c){function n(a){for(var b=a.length,c=new Uint8Array(b),f=0;f<b;f++)c[f]=a.charCodeAt(f)&255;return c}function q(a,b){b||(b="");for(var c="",f=0;f<a.byteLength;f++)c+=
(a[f]>>>4).toString(16),c+=(a[f]&15).toString(16),b.length&&(c+=b);return c}var f=c(2);r.exports={totalBytes:function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].byteLength;return b},strToBytes:n,bytesToStr:function(a){return String.fromCharCode.apply(null,a)},bytesToUTF16Str:function(a){for(var b="",c=a.length,f=0;f<c;f+=2)b+=String.fromCharCode(a[f]);return b},hexToBytes:function(a){for(var b=a.length,c=new Uint8Array(b/2),f=0,k=0;f<b;f+=2,k++)c[k]=parseInt(a.substr(f,2),16)&255;return c},bytesToHex:q,
concat:function(){for(var a=arguments.length,b=-1,c=0,f;++b<a;)f=arguments[b],c+="number"===typeof f?f:f.length;for(var c=new Uint8Array(c),k=0,b=-1;++b<a;)f=arguments[b],"number"===typeof f?k+=f:0<f.length&&(c.set(f,k),k+=f.length);return c},be2toi:function(a,b){return(a[0+b]<<8)+(a[1+b]<<0)},be4toi:function(a,b){return 16777216*a[0+b]+65536*a[1+b]+256*a[2+b]+a[3+b]},be8toi:function(a,b){return 4294967296*(16777216*a[0+b]+65536*a[1+b]+256*a[2+b]+a[3+b])+16777216*a[4+b]+65536*a[5+b]+256*a[6+b]+a[7+
b]},le2toi:function(a,b){return(a[0+b]<<0)+(a[1+b]<<8)},le4toi:function(a,b){return a[0+b]+256*a[1+b]+65536*a[2+b]+16777216*a[3+b]},le8toi:function(a,b){return a[0+b]+256*a[1+b]+65536*a[2+b]+16777216*a[3+b]+(a[4+b]+256*a[5+b]+65536*a[6+b]+16777216*a[7+b]*4294967296)},itobe2:function(a){return new Uint8Array([a>>>8&255,a&255])},itobe4:function(a){return new Uint8Array([a>>>24&255,a>>>16&255,a>>>8&255,a&255])},itobe8:function(a){var b=a%4294967296;a=(a-b)/4294967296;return new Uint8Array([a>>>24&255,
a>>>16&255,a>>>8&255,a&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255])},itole2:function(a){return new Uint8Array([a&255,a>>>8&255])},itole4:function(a){return new Uint8Array([a&255,a>>>8&255,a>>>16&255,a>>>24&255])},itole8:function(a){var b=a%4294967296;a=(a-b)/4294967296;return new Uint8Array([a&255,a>>>8&255,a>>>16&255,a>>>24&255,b&255,b>>>8&255,b>>>16&255,b>>>24&255])},guidToUuid:function(a){f.equal(a.length,16,"UUID length should be 16");var b=n(a);a=b[0];var c=b[1],h=b[2],k=b[3],w=b[4],u=b[5],m=
b[6],C=b[7],e=b.subarray(8,10),b=b.subarray(10,16),d=new Uint8Array(16);d[0]=k;d[1]=h;d[2]=c;d[3]=a;d[4]=u;d[5]=w;d[6]=C;d[7]=m;d.set(e,8);d.set(b,10);return q(d)},toBase64URL:function(a){return btoa(a).replace(/\=+$/,"")}}},function(r,h,c){function n(a){return a&&"function"==typeof a.then?a:m.resolve(a)}function q(a){return function(){try{var d=a.apply(this,arguments)}catch(ua){return m.reject(ua)}return n(d)}}function f(a,d){return u.flatten(a,function(a){return u.map(d||R,function(d){return d+
a})})}function a(a,d){return u.find(d,function(d){var b=document.createElement(a.tagName);d="on"+d;d in b?b=!0:(b.setAttribute(d,"return;"),b=u.isFunction(b[d]));return b})}function b(d,b){var e;d=f(d,b);return function(b){return b instanceof S?("undefined"==typeof e&&(e=a(b,d)||null),e?I(b,e):M()):z(b,d)}}function p(a,d){function b(){var a=0>=arguments.length||void 0===arguments[0]?{}:arguments[0];a.errorCode&&(a={systemCode:a.systemCode,code:a.errorCode.code});this.name="KeySessionError";this.mediaKeyError=
a;this.message="MediaKeyError code:"+a.code+" and systemCode:"+a.systemCode}b.prototype=Error();return function(e,c){var t=u.isFunction(d)?d.call(this):this,O=U(t),k=Z(t).map(function(a){throw new b(t.error||a);});try{return a.call(this,e,c),J(O,k).take(1).toPromise()}catch(K){return m.reject(K)}}}function x(a,d){if(d instanceof H)return d._setVideo(a);if(a.setMediaKeys)return a.setMediaKeys(d);if(null!==d){if(a.WebkitSetMediaKeys)return a.WebkitSetMediaKeys(d);if(a.mozSetMediaKeys)return a.mozSetMediaKeys(d);
if(a.msSetMediaKeys)return new m(function(b,e){1<=a.readyState?(a.msSetMediaKeys(d),b()):a.addEventListener("loadedmetatdata",function(){try{a.msSetMediaKeys(d)}catch(Ka){return e(Ka)}finally{a.removeEventListener("loadedmetatdata")}b()})});throw Error("compat: cannot find setMediaKeys method");}}function k(){return!!(E.fullscreenElement||E.mozFullScreenElement||E.webkitFullscreenElement||E.msFullscreenElement)}var w=function(){function a(a,d){for(var b=0;b<d.length;b++){var e=d[b];e.enumerable=e.enumerable||
!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(a,e.key,e)}}return function(d,b,e){b&&a(d.prototype,b);e&&a(d,e);return d}}(),u=c(1);c(4);var m=c(6),C=c(10);h=c(7);var e=h.bytesToStr,d=h.strToBytes,B=c(2);h=c(3).Observable;var J=h.merge,M=h.never,I=h.fromEvent,W=h.just,z=c(5).on,E=document,D=window,R=["","webkit","moz","ms"],S=D.HTMLElement;c=D.HTMLVideoElement;var T=D.MediaSource||D.MozMediaSource||D.WebKitMediaSource||D.MSMediaSource,P=D.MediaKeys||D.MozMediaKeys||D.WebKitMediaKeys||
D.MSMediaKeys;h="Microsoft Internet Explorer"==navigator.appName||"Netscape"==navigator.appName&&/Trident\//.test(navigator.userAgent);var H=u.noop,X;navigator.requestMediaKeySystemAccess&&(X=function(a,d){return navigator.requestMediaKeySystemAccess(a,d)});var ca=function(){function a(d,b,e){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._keyType=d;this._mediaKeys=b;this._configuration=e}a.prototype.createMediaKeys=function(){return m.resolve(this._mediaKeys)};
a.prototype.getConfiguration=function(){return this._configuration};w(a,[{key:"keySystem",get:function(){return this._keyType}}]);return a}(),ea=b(h?["progress"]:["loadedmetadata"]),fa=b(["sourceopen","webkitsourceopen"]);h=b(["encrypted","needkey"]);var da=b(["keymessage","message"]),U=b(["keyadded","ready"]),Z=b(["keyerror","error"]),aa=b(["keystatuseschange"]);h={onEncrypted:h,onKeyMessage:da,onKeyStatusesChange:aa,onKeyError:Z};if(!X&&c.prototype.webkitGenerateKeyRequest){var ka=function(a,d){var b=
this;C.call(this);this._vid=a;this._key=d;this._con=J(da(a),U(a),Z(a)).subscribe(function(a){return b.trigger(a.type,a)})};ka.prototype=u.extend({},C.prototype,{generateRequest:q(function(a,d){this._vid.webkitGenerateKeyRequest(this._key,d)}),update:p(function(a,b){if(0<=this._key.indexOf("clearkey")){var m=JSON.parse(e(a));a=d(atob(m.keys[0].k));m=d(atob(m.keys[0].kid));this._vid.webkitAddKey(this._key,a,m,b)}else this._vid.webkitAddKey(this._key,a,null,b)}),close:q(function(){this._con&&this._con.dispose();
this._vid=this._con=null})});H=function(a){this.ks_=a};H.prototype={_setVideo:function(a){this._vid=a},createSession:function(){return new ka(this._vid,this.ks_)}};var F=function(a){var d=E.querySelector("video")||E.createElement("video");return d&&d.canPlayType?!!d.canPlayType("video/mp4",a):!1};X=function(a,d){if(!F(a))return m.reject();for(var b=0;b<d.length;b++){var e=d[b],c=e.videoCapabilities,t=e.audioCapabilities,k=e.initDataTypes,f=e.sessionTypes,O=e.distinctiveIdentifier,e=e.persistentState,
p=!0;if(p=(p=(p=(p=p&&(!k||!!u.find(k,function(a){return"cenc"===a})))&&(!f||u.filter(f,function(a){return"temporary"===a}).length===f.length))&&"required"!==O)&&"required"!==e)return d={videoCapabilities:c,audioCapabilities:t,initDataTypes:["cenc"],distinctiveIdentifier:"not-allowed",persistentState:"not-allowed",sessionTypes:["temporary"]},m.resolve(new ca(a,new H(a),d))}return m.reject()}}else if(P&&!X){var t=function(a){C.call(this);this._mk=a};t.prototype=u.extend(C.prototype,{generateRequest:q(function(a,
d){var b=this;this._ss=this._mk.memCreateSession("video/mp4",d);this._con=J(da(this._ss),U(this._ss),Z(this._ss)).subscribe(function(a){return b.trigger(a.type,a)})}),update:p(function(a,d){B(this._ss);this._ss.update(a,d)},function(){return this._ss}),close:q(function(){this._ss&&(this._ss.close(),this._ss=null,this._con.dispose(),this._con=null)})});P.prototype.alwaysRenew=!0;P.prototype.memCreateSession=P.prototype.createSession;P.prototype.createSession=function(){return new t(this)};X=function(a,
d){if(!P.isTypeSupported(a))return m.reject();for(var b=0;b<d.length;b++){var e=d[b],c=e.videoCapabilities,t=e.audioCapabilities,k=e.initDataTypes,e=e.distinctiveIdentifier,f=!0;if(f=(f=f&&(!k||u.find(k,function(a){return"cenc"===a})))&&"required"!==e)return d={videoCapabilities:c,audioCapabilities:t,initDataTypes:["cenc"],distinctiveIdentifier:"not-allowed",persistentState:"required",sessionTypes:["temporary","persistent-license"]},m.resolve(new ca(a,new H(a),d))}return m.reject()}}P||(aa=function(){throw Error("eme: MediaKeys is not available");
},P={create:aa,isTypeSupported:aa});D.WebKitSourceBuffer&&!D.WebKitSourceBuffer.prototype.addEventListener&&(aa=D.WebKitSourceBuffer.prototype,u.extend(aa,C.prototype),aa.__listeners=[],aa.appendBuffer=function(a){if(this.updating)throw Error("SourceBuffer updating");this.trigger("updatestart");this.updating=!0;try{this.append(a)}catch(ma){this.__emitUpdate("error",ma);return}this.__emitUpdate("update")},aa.__emitUpdate=function(a,d){var b=this;setTimeout(function(){b.trigger(a,d);b.updating=!1;b.trigger("updateend")},
0)});aa=b(["fullscreenchange","FullscreenChange"],R.concat("MS"));r.exports={HTMLVideoElement_:c,MediaSource_:T,isCodecSupported:function(a){return!!T&&T.isTypeSupported(a)},sourceOpen:function(a){return"open"==a.readyState?W():fa(a).take(1)},loadedMetadata:function(a){return a.readyState>=HTMLVideoElement.HAVE_METADATA?W():ea(a).take(1)},canPlay:function(a){return a.readyState>=HTMLVideoElement.HAVE_ENOUGH_DATA?W():z(a,"canplay").take(1)},KeySystemAccess:ca,requestMediaKeySystemAccess:X,setMediaKeys:function(a,
d){return n(x(a,d))},emeEvents:h,isFullscreen:k,onFullscreenChange:aa,requestFullscreen:function(a){if(!k()){if(a.requestFullscreen)return a.requestFullscreen();if(a.msRequestFullscreen)return a.msRequestFullscreen();if(a.mozRequestFullScreen)return a.mozRequestFullScreen();if(a.webkitRequestFullscreen)return a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}},exitFullscreen:function(){if(k()){if(E.exitFullscreen)return E.exitFullscreen();if(E.msExitFullscreen)return E.msExitFullscreen();if(E.mozCancelFullScreen)return E.mozCancelFullScreen();
if(E.webkitExitFullscreen)return E.webkitExitFullscreen()}},videoSizeChange:function(){return z(D,"resize")},visibilityChange:function(){var a;null!=E.hidden?a="":null!=E.mozHidden?a="moz":null!=E.msHidden?a="ms":null!=E.webkitHidden&&(a="webkit");var d=a?a+"Hidden":"hidden";return z(E,a+"visibilitychange").map(function(){return E[d]})}}},function(r,h,c){function n(a){if(x.isArray(a))return a;for(var b=-1,c=a.length,e=Array(c);++b<c;)e[b]={start:a.start(b),end:a.end(b),bitrate:0};return e}function q(a,
b){return a.start<=b&&b<a.end}function f(b,m){for(var c=0;c<m.length;c++)if(a(b,m[c]))return m[c];return null}function a(a,b){return q(a,b.start)||q(a,b.end)||q(b,a.start)}function b(a,b){return q(a,b.start)&&q(a,b.end)}function p(a,b,c){return{start:Math.min(a.start,b.start),end:Math.max(a.end,b.end),bitrate:c}}var x=c(1),k=c(2),w=1/60;h=function(){function c(a){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.ranges=a?n(a):[];this.length=this.ranges.length}c.prototype.start=
function(a){return this.ranges[a].start};c.prototype.end=function(a){return this.ranges[a].end};c.prototype.hasRange=function(a,b){b=a+b;for(var e=0;e<this.ranges.length;e++){var d=this.ranges[e],c=d.start,d=d.end;if(c-a<=w&&a-d<=w&&c-b<=w&&b-d<=w)return this.ranges[e]}return null};c.prototype.getRange=function(a){for(var b=0;b<this.ranges.length;b++)if(q(this.ranges[b],a))return this.ranges[b];return null};c.prototype.getOuterRanges=function(a){for(var b=[],e=0;e<this.ranges.length;e++)q(this.ranges[e],
a)||b.push(this.ranges[e]);return b};c.prototype.getGap=function(a){var b=this.getRange(a);return b?b.end-a:Infinity};c.prototype.getLoaded=function(a){var b=this.getRange(a);return b?a-b.start:0};c.prototype.getSize=function(a){return(a=this.getRange(a))?a.end-a.start:0};c.prototype.getNextRangeGap=function(a){for(var b=this.ranges,e=-1,d;++e<b.length;){var c=b[e].start;if(c>a){d=c;break}}return null!=d?d-a:Infinity};c.prototype.insert=function(c,f,e){var d=this.ranges;k(f<=e);if(f!=e){c={start:f,
end:e,bitrate:c};for(f=0;f<d.length;f++){e=d[f];var m=a(c,e),n=Math.abs(e.start-c.end)<w||Math.abs(e.end-c.start)<w;if(m||n)if(c.bitrate===e.bitrate)c=p(c,e,e.bitrate),d.splice(f--,1);else if(m)if(b(e,c))d.splice(++f,0,c),m=e.end,e.end=c.start,c={start:c.end,end:m,bitrate:e.bitrate};else if(b(c,e))d.splice(f--,1);else if(e.start<c.start)e.end=c.start;else{e.start=c.end;break}else break;else if(0===f){if(c.end<=d[0].start)break}else if(d[f-1].end<=c.start&&c.end<=e.start)break}d.splice(f,0,c);for(c=
0;c<d.length;c++)f=d[c],f.start===f.end&&d.splice(c++,1);for(c=1;c<d.length;c++)f=d[c-1],e=d[c],f.bitrate===e.bitrate&&(Math.abs(e.start-f.end)<w||Math.abs(e.end-f.start)<w)&&(f=p(f,e,e.bitrate),d.splice(--c,2,f))}this.length=this.ranges.length;return this.ranges};c.prototype.remove=function(a,b){this.intersect(new c([{start:0,end:a},{start:b,end:Infinity}]))};c.prototype.equals=function(a){a:{var b=this.ranges;a=a.ranges;for(var c=0;c<b.length;c++){var d=b[c],k=f(d,a);if(!k||k.start>d.start||k.end<
d.end){b=!1;break a}}b=!0}return b};c.prototype.intersect=function(a){var b=this.ranges;a=a.ranges;for(var c=0;c<b.length;c++){var d=b[c],k=f(d,a);k?(k.start>d.start&&(d.start=k.start),k.end<d.end&&(d.end=k.end)):b.splice(c--,1)}this.length=this.ranges.length;return this.ranges};return c}();r.exports={bufferedToArray:n,BufferedRanges:h}},function(r,h,c){function n(){this.__listeners={}}var q=c(1),f=c(2);n.prototype.addEventListener=function(a,b){f("function"==typeof b,"eventemitter: second argument should be a function");
this.__listeners[a]||(this.__listeners[a]=[]);this.__listeners[a].push(b)};n.prototype.removeEventListener=function(a,b){if(0===arguments.length)this.__listeners={};else if(this.__listeners.hasOwnProperty(a))if(1===arguments.length)delete this.__listeners[a];else{var c=this.__listeners[a],f=c.indexOf(b);~f&&c.splice(f,1);c.length||delete this.__listeners[a]}};n.prototype.trigger=function(a,b){this.__listeners.hasOwnProperty(a)&&(a=this.__listeners[a].slice(),q.each(a,function(a){try{a(b)}catch(x){console.error(x,
x.stack)}}))};n.prototype.on=n.prototype.addEventListener;n.prototype.off=n.prototype.removeEventListener;r.exports=n},function(r,h){var c=/^(?:[a-z]+:)?\/\//i,n=/\/[\.]{1,2}\//;r.exports={resolveURL:function(){var h=arguments.length;if(0===h)return"";for(var f="",a=0;a<h;a++){var b=arguments[a];"string"===typeof b&&""!==b&&(c.test(b)?f=b:("/"===b[0]&&(b=b.substr(1)),"/"===f[f.length-1]&&(f=f.substr(0,f.length-1)),f=f+"/"+b))}if(n.test(f)){h=[];f=f.split("/");a=0;for(b=f.length;a<b;a++)".."==f[a]?
h.pop():"."!=f[a]&&h.push(f[a]);h=h.join("/")}else h=f;return h},parseBaseURL:function(c){var f=c.lastIndexOf("/");return 0<=f?c.substring(0,f+1):c}}},function(r,h,c){function n(a,b,c){a.id=a.id||p.uniqueId();var d=a.adaptations,d=d.concat(c||[]),d=p.map(d,function(a){return q(a,b)}),d=p.filter(d,function(a){return 0>C.indexOf(a.type)?(x.info("not supported adaptation type",a.type),!1):!0});k(0<d.length);a.adaptations=p.groupBy(d,"type");return a}function q(b,d){k("undefined"!=typeof b.id);p.defaults(b,
d);var c=p.pick(b,m);d=p.map(b.representations,function(a){k("undefined"!=typeof a.id);p.defaults(a,c);var b=a.index;k(b);b.timescale||(b.timescale=1);a.bitrate||(a.bitrate=1);"mp4a.40.02"==a.codecs&&(a.codecs="mp4a.40.2");return a}).sort(function(a,b){return a.bitrate-b.bitrate});var e=b.type,f=b.mimeType;f||(f=d[0].mimeType);k(f);b.mimeType=f;e||(e=b.type=f.split("/")[0]);if("video"==e||"audio"==e)d=p.filter(d,function(b){return u(a(b))});k(0<d.length,"manifest: no compatible representation for this adaptation");
b.representations=d;b.bitrates=p.pluck(d,"bitrate");return b}function f(a){p.isArray(a)||(a=[a]);return p.flatten(a,function(a){var b=a.mimeType,d=a.url,c=a.language;a=a.languages;c&&(a=[c]);return p.map(a,function(a){return{id:p.uniqueId(),type:"text",lang:a,mimeType:b,rootURL:d,baseURL:"",representations:[{id:p.uniqueId(),mimeType:b,index:{indexType:"template",duration:Number.MAX_VALUE,timescale:1,startNumber:0}}]}})})}function a(a){return a.mimeType+';codecs="'+a.codecs+'"'}function b(a,b){return(b=
(a=a.adaptations)&&a[b])?b:[]}var p=c(1),x=c(4),k=c(2),w=c(11).parseBaseURL,u=c(8).isCodecSupported,m="profiles width height frameRate audioSamplingRate mimeType segmentProfiles codecs maximumSAPPeriod maxPlayoutRate codingDependency index".split(" "),C=["audio","video","text"];r.exports={normalizeManifest:function(a,b,c){k(b.transportType);b.id=b.id||p.uniqueId();b.type=b.type||"static";var d=b.locations;d&&d.length||(b.locations=[a]);b.isLive="dynamic"==b.type;var e={rootURL:w(b.locations[0]),baseURL:b.baseURL,
isLive:b.isLive};c&&(c=f(c));a=p.map(b.periods,function(a){return n(a,e,c)});p.extend(b,a[0]);b.periods=null;b.duration||(b.duration=Infinity);b.isLive&&(b.suggestedPresentationDelay=b.suggestedPresentationDelay||15,b.availabilityStartTime=b.availabilityStartTime||0);return b},mergeManifestsIndex:function(a,b){var d=a.adaptations;b=b.adaptations;for(var c in d){var e=b[c];p.each(d[c],function(a,b){p.simpleMerge(a.index,e[b].index)})}return a},mutateManifestLiveGap:function(a){var b=1>=arguments.length||
void 0===arguments[1]?1:arguments[1];a.isLive&&(a.presentationLiveGap+=b)},getCodec:a,getAdaptations:function(b){var d=b.adaptations;if(!d)return[];var c=[];p.each(p.keys(d),function(b){var e=d[b];c.push({type:b,adaptations:e,codec:a(e[0].representations[0])})});return c},getAdaptationsByType:b,getAvailableSubtitles:function(a){return b(a,"text").map(function(a){return a.lang})},getAvailableLanguages:function(a){return b(a,"audio").map(function(a){return a.lang})},createDirectFileManifest:function(){return{isLive:!1,
duration:Infinity,adaptations:null}}}},function(r,h,c){(function(n,h){function f(a){for(var l=a.length,v=Array(l),y=0;y<l;y++)v[y]=a[y];return v}function a(){try{return Ea.apply(this,arguments)}catch(l){return K.e=l,K}}function b(l){if(!V(l))throw new TypeError("fn must be a function");Ea=l;return a}function p(a){throw a;}function q(a,g){for(var l=Array(a),y=0;y<a;y++)l[y]=g();return l}function k(a){this._s=a}function w(a){this._s=a;this._l=a.length;this._i=0}function u(a){this._a=a}function m(a){this._a=
a;a=+a.length;if(isNaN(a))a=0;else if(0!==a&&"number"===typeof a&&F.isFinite(a)){var l=+a;l=0===l?l:isNaN(l)?l:0>l?-1:1;a=l*Math.floor(Math.abs(a));a=0>=a?0:a>eb?eb:a}this._l=a;this._i=0}function C(a){var l=a._es6shim_iterator_;if(!l&&"string"===typeof a)return a=new k(a),a._es6shim_iterator_();if(!l&&void 0!==a.length)return a=new u(a),a._es6shim_iterator_();if(!l)throw new TypeError("Object is not iterable");return a._es6shim_iterator_()}function e(a,g){this.observer=a;this.parent=g}function d(a,
g){ha(a)||(a=sa);return new Ra(g,a)}function B(a,g){this.observer=a;this.parent=g}function J(a,g){this.observer=a;this.parent=g}function M(a,g){return new N(function(l){var v=new Q,b=new qa;b.setDisposable(v);v.setDisposable(a.subscribe(new pb(l,b,g)));return b},a)}function I(){return!1}function W(){return[]}function z(){for(var a=arguments.length,g=Array(a),v=0;v<a;v++)g[v]=arguments[v];return g}function E(a){return function(l){return a.subscribe(l)}}function D(a,g){this.o=a;this.accumulator=g.accumulator;
this.hasSeed=g.hasSeed;this.seed=g.seed;this.hasAccumulation=!1;this.accumulation=null;this.isStopped=this.hasValue=!1}function R(a,g){return function(l){var v=l;for(l=0;l<g;l++)if(v=v[a[l]],"undefined"===typeof v)return;return v}}function S(a,g,v){return function(){for(var l=arguments.length,d=Array(l),c=0;c<l;c++)d[c]=arguments[c];if(V(v)){d=b(v).apply(g,d);if(d===K)return a.onError(d.e);a.onNext(d)}else if(1>=d.length)a.onNext(d[0]);else a.onNext(d);a.onCompleted()}}function T(a,g,v){return function(){var l;
if(l=arguments[0])return a.onError(l);var d=arguments.length;l=[];for(var c=1;c<d;c++)l[c-1]=arguments[c];if(V(v)){l=b(v).apply(g,l);if(l===K)return a.onError(l.e);a.onNext(l)}else if(1>=l.length)a.onNext(l[0]);else a.onNext(l);a.onCompleted()}}function P(a,g,v){this._e=a;this._n=g;this._fn=v;this._e.addEventListener(this._n,this._fn,!1);this.isDisposed=!1}function H(a,g,v){var l=Object.prototype.toString.call(a);if("[object NodeList]"===l||"[object HTMLCollection]"===l){for(var l=new Y,b=0,d=a.length;b<
d;b++)l.add(H(a.item(b),g,v));return l}return new P(a,g,v)}function X(a,g){return function(){var l=arguments[0];V(g)&&(l=g.apply(null,arguments));a.onNext(l)}}function ca(a,g){return new N(function(l){return g.scheduleWithAbsolute(a,function(){l.onNext(0);l.onCompleted()})})}function ea(a,g,v){return new N(function(l){var b=a,y=Wa(g);return v.scheduleRecursiveWithAbsoluteAndState(0,b,function(a,g){if(0<y){var d=v.now();b+=y;b<=d&&(b=d+y)}l.onNext(a);g(a+1,b)})})}function fa(a,g){return new N(function(l){return g.scheduleWithRelative(Wa(a),
function(){l.onNext(0);l.onCompleted()})})}function da(a,g,v){return a===g?new N(function(a){return v.schedulePeriodicWithState(0,g,function(l){a.onNext(l);return l+1})}):fb(function(){return ea(v.now()+a,g,v)})}function U(a,g,v){return new N(function(l){var b=!1,y=new qa,d=null,c=[],e=!1;var f=a.materialize().timestamp(v).subscribe(function(a){"E"===a.value.kind?(c=[],c.push(a),d=a.value.exception,a=!e):(c.push({value:a.value,timestamp:a.timestamp+g}),a=!b,b=!0);if(a)if(null!==d)l.onError(d);else a=
new Q,y.setDisposable(a),a.setDisposable(v.scheduleRecursiveWithRelative(g,function(a){if(null===d){e=!0;do{var g=null;0<c.length&&0>=c[0].timestamp-v.now()&&(g=c.shift().value);null!==g&&g.accept(l)}while(null!==g);var y=!1;var Fa=0;0<c.length?(y=!0,Fa=Math.max(0,c[0].timestamp-v.now())):b=!1;g=d;e=!1;if(null!==g)l.onError(g);else y&&a(Fa)}}))});return new Y(f,y)},a)}function Z(a,g,v){return fb(function(){return U(a,g-v.now(),v)})}function aa(a,g){return new N(function(l){function v(){c&&(c=!1,l.onNext(d));
b&&l.onCompleted()}var b=!1,d,c=!1,e=new Q;e.setDisposable(a.subscribe(function(a){c=!0;d=a},function(a){l.onError(a)},function(){b=!0;e.dispose()}));return new Y(e,g.subscribe(v,function(a){l.onError(a)},v))},a)}function ka(a,g,v){return new N(function(l){function y(a,g){f[g]=a;d[g]=!0;if(c||(c=d.every(ma))){if(t)return l.onError(t);a=b(v).apply(null,f);if(a===K)return l.onError(a.e);l.onNext(a)}e&&f[1]&&l.onCompleted()}var d=[!1,!1],c=!1,e=!1,f=Array(2),t;return new Y(a.subscribe(function(a){y(a,
0)},function(a){if(f[1])l.onError(a);else t=a},function(){e=!0;f[1]&&l.onCompleted()}),g.subscribe(function(a){y(a,1)},function(a){l.onError(a)},function(){e=!0;y(!0,1)}))},a)}var F=n,t={internals:{},config:{Promise:c(6)},helpers:{}},O=t.helpers.noop=function(){},ma=t.helpers.identity=function(a){return a},ua=t.helpers.defaultNow=Date.now,Va=t.helpers.defaultComparer=function(a,g){return za(a,g)},Ka=t.helpers.defaultSubComparer=function(a,g){return a>g?1:a<g?-1:0},Qa=t.helpers.defaultError=function(a){throw a;
},ja=t.helpers.isPromise=function(a){return!!a&&"function"!==typeof a.subscribe&&"function"===typeof a.then},V=t.helpers.isFunction=function(a){return"function"==typeof a||!1},K={e:{}},Ea;(t.EmptyError=function(){this.message="Sequence contains no elements.";this.name="EmptyError";Error.call(this)}).prototype=Error.prototype;var La=t.ObjectDisposedError=function(){this.message="Object has been disposed";this.name="ObjectDisposedError";Error.call(this)};La.prototype=Error.prototype;var Aa=t.ArgumentOutOfRangeError=
function(){this.message="Argument out of range";this.name="ArgumentOutOfRangeError";Error.call(this)};Aa.prototype=Error.prototype;var ga=t.NotSupportedError=function(a){this.message=a||"This operation is not supported";this.name="NotSupportedError";Error.call(this)};ga.prototype=Error.prototype;var Ma=t.NotImplementedError=function(a){this.message=a||"This operation is not implemented";this.name="NotImplementedError";Error.call(this)};Ma.prototype=Error.prototype;var wa=t.helpers.notImplemented=
function(){throw new Ma;},va=t.helpers.notSupported=function(){throw new ga;},ta=t.doneEnumerator={done:!0,value:void 0},Ya=t.helpers.isArrayLike=function(a){return a&&void 0!==a.length},xa=t.internals.bindCallback=function(a,g,v){return g?function(){return a.apply(g,arguments)}:a};t.internals.isObject=function(a){var g=typeof a;return a&&("function"==g||"object"==g)||!1};var za=t.internals.isEqual=function(a,g){if(a===g)return!0;if(!a||!g||"object"!==typeof a||"object"!==typeof g)return!1;for(var l in a)if(a.hasOwnProperty(l)&&
(!g.hasOwnProperty(l)||a[l]!==g[l]))return!1;for(l in g)if(g.hasOwnProperty(l)&&!a.hasOwnProperty(l))return!1;return!0},G=t.internals.inherits=function(a,g){function l(){this.constructor=a}l.prototype=g.prototype;a.prototype=new l},Ha=t.internals.addProperties=function(a){for(var g=1,l=arguments.length;g<l;g++){var b=arguments[g],d;for(d in b)a[d]=b[d]}},Y=t.CompositeDisposable=function(){var a;if(Array.isArray(arguments[0])){var g=arguments[0];var b=g.length}else for(b=arguments.length,g=Array(b),
a=0;a<b;a++)g[a]=arguments[a];for(a=0;a<b;a++)if(!Za(g[a]))throw new TypeError("Not a disposable");this.disposables=g;this.isDisposed=!1;this.length=g.length},$a=Y.prototype;$a.add=function(a){this.isDisposed?a.dispose():(this.disposables.push(a),this.length++)};$a.remove=function(a){var g=!1;if(!this.isDisposed){var l=this.disposables.indexOf(a);-1!==l&&(g=!0,this.disposables.splice(l,1),this.length--,a.dispose())}return g};$a.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var a=
this.disposables.length,g=Array(a),b=0;b<a;b++)g[b]=this.disposables[b];this.disposables=[];for(b=this.length=0;b<a;b++)g[b].dispose()}};var Ia=t.Disposable=function(a){this.isDisposed=!1;this.action=a||O};Ia.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var la=Ia.create=function(a){return new Ia(a)},oa=Ia.empty={dispose:O},Za=Ia.isDisposable=function(a){return a&&V(a.dispose)},ia=Ia.checkDisposed=function(a){if(a.isDisposed)throw new La;},Q=t.SingleAssignmentDisposable=
function(){this.isDisposed=!1;this.current=null};Q.prototype.getDisposable=function(){return this.current};Q.prototype.setDisposable=function(a){if(this.current)throw Error("Disposable has already been assigned");var g=this.isDisposed;!g&&(this.current=a);g&&a&&a.dispose()};Q.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var a=this.current;this.current=null}a&&a.dispose()};var qa=t.SerialDisposable=function(){this.isDisposed=!1;this.current=null};qa.prototype.getDisposable=
function(){return this.current};qa.prototype.setDisposable=function(a){var g=this.isDisposed;if(!g){var b=this.current;this.current=a}b&&b.dispose();g&&a&&a.dispose()};qa.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var a=this.current;this.current=null}a&&a.dispose()};t.RefCountDisposable=function(){function a(a){this.disposable=a;this.disposable.count++;this.isInnerDisposed=!1}function g(a){this.underlyingDisposable=a;this.isPrimaryDisposed=this.isDisposed=!1;this.count=0}
a.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,this.disposable.count--,0===this.disposable.count&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))};g.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,0===this.count&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))};g.prototype.getDisposable=function(){return this.isDisposed?
oa:new a(this)};return g}();var Na=t.internals.ScheduledItem=function(a,g,b,y,d){this.scheduler=a;this.state=g;this.action=b;this.dueTime=y;this.comparer=d||Ka;this.disposable=new Q};Na.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())};Na.prototype.compareTo=function(a){return this.comparer(this.dueTime,a.dueTime)};Na.prototype.isCancelled=function(){return this.disposable.isDisposed};Na.prototype.invokeCore=function(){return this.action(this.scheduler,this.state)};var ra=
t.Scheduler=function(){function a(a,g,b,l){this.now=a;this._schedule=g;this._scheduleRelative=b;this._scheduleAbsolute=l}function g(a,g){g();return oa}a.isScheduler=function(g){return g instanceof a};var b=a.prototype;b.schedule=function(a){return this._schedule(a,g)};b.scheduleWithState=function(a,g){return this._schedule(a,g)};b.scheduleWithRelative=function(a,b){return this._scheduleRelative(b,a,g)};b.scheduleWithRelativeAndState=function(a,g,b){return this._scheduleRelative(a,g,b)};b.scheduleWithAbsolute=
function(a,b){return this._scheduleAbsolute(b,a,g)};b.scheduleWithAbsoluteAndState=function(a,g,b){return this._scheduleAbsolute(a,g,b)};a.now=ua;a.normalize=function(a){0>a&&(a=0);return a};return a}(),Wa=ra.normalize,ha=ra.isScheduler;(function(a){function g(a,g){function b(g){var l=!1,d=!1,c=a.scheduleWithState(g,function(a,g){l?y.remove(c):d=!0;v(g,b);return oa});d||(y.add(c),l=!0)}var l=g[0],v=g[1],y=new Y;v(l,b);return y}function b(a,g,b){function l(g,v){var c=!1,Fa=!1,e=a[b](g,v,function(a,
g){c?d.remove(e):Fa=!0;y(g,l);return oa});Fa||(d.add(e),c=!0)}var v=g[0],y=g[1],d=new Y;y(v,l);return d}function l(a,g){return b(a,g,"scheduleWithRelativeAndState")}function d(a,g){return b(a,g,"scheduleWithAbsoluteAndState")}function c(a,g){a(function(b){g(a,b)})}a.scheduleRecursive=function(a){return this.scheduleRecursiveWithState(a,c)};a.scheduleRecursiveWithState=function(a,b){return this.scheduleWithState([a,b],g)};a.scheduleRecursiveWithRelative=function(a,g){return this.scheduleRecursiveWithRelativeAndState(g,
a,c)};a.scheduleRecursiveWithRelativeAndState=function(a,g,b){return this._scheduleRelative([a,b],g,l)};a.scheduleRecursiveWithAbsolute=function(a,g){return this.scheduleRecursiveWithAbsoluteAndState(g,a,c)};a.scheduleRecursiveWithAbsoluteAndState=function(a,g,b){return this._scheduleAbsolute([a,b],g,d)}})(ra.prototype);(function(a){ra.prototype.schedulePeriodic=function(a,b){return this.schedulePeriodicWithState(null,a,b)};ra.prototype.schedulePeriodicWithState=function(a,b,l){if("undefined"===typeof F.setInterval)throw new ga;
b=Wa(b);var g=a,v=F.setInterval(function(){g=l(g)},b);return la(function(){F.clearInterval(v)})}})(ra.prototype);var pa=ra.immediate=function(){return new ra(ua,function(a,g){return g(this,a)},va,va)}(),sa=ra.currentThread=function(){function a(){for(;0<g.length;){var a=g.shift();!a.isCancelled()&&a.invoke()}}var g,v=new ra(ua,function(l,v){l=new Na(this,l,v,this.now());if(g)g.push(l);else if(g=[l],v=b(a)(),g=null,v===K)return p(v.e);return l.disposable},va,va);v.scheduleRequired=function(){return!g};
return v}();t.internals.SchedulePeriodicRecursive=function(){function a(a,g){g(0,this._period);try{this._state=this._action(this._state)}catch(Fa){throw this._cancel.dispose(),Fa;}}function g(a,g,b,l){this._scheduler=a;this._state=g;this._period=b;this._action=l}g.prototype.start=function(){var g=new Q;this._cancel=g;g.setDisposable(this._scheduler.scheduleRecursiveWithRelativeAndState(0,this._period,a.bind(this)));return g};return g}();var Ja,ab,gb=function(){var a=O;if(F.setTimeout){var g=F.setTimeout;
a=F.clearTimeout}else if(F.WScript)g=function(a,g){F.WScript.Sleep(g);a()};else throw new ga;return{setTimeout:g,clearTimeout:a}}(),bb=gb.setTimeout,rb=gb.clearTimeout;(function(){function a(g){if(d)bb(function(){a(g)},0);else{var l=y[g];if(l&&(d=!0,l=b(l)(),ab(g),d=!1,l===K))return p(l.e)}}function g(){if(!F.postMessage||F.importScripts)return!1;var a=!1,g=F.onmessage;F.onmessage=function(){a=!0};F.postMessage("","*");F.onmessage=g;return a}var v=1,y={},d=!1;ab=function(a){delete y[a]};String(toString).replace(/[.*+?^${}()|[\]\\]/g,
"\\$&").replace(/toString| for [^\]]+/g,".*?");var c=n.setImmediate;if(V(c))Ja=function(g){var b=v++;y[b]=g;c(function(){a(b)});return b};else if("undefined"!==typeof h&&"[object process]"==={}.toString.call(h))Ja=function(g){var b=v++;y[b]=g;h.nextTick(function(){a(b)});return b};else if(g()){var e=function(g){"string"===typeof g.data&&g.data.substring(0,f.length)===f&&a(g.data.substring(f.length))},f="ms.rx.schedule"+Math.random();F.addEventListener?F.addEventListener("message",e,!1):F.attachEvent?
F.attachEvent("onmessage",e):F.onmessage=e;Ja=function(a){var g=v++;y[g]=a;F.postMessage(f+currentId,"*");return g}}else if(F.MessageChannel){var t=new F.MessageChannel;t.port1.onmessage=function(g){a(g.data)};Ja=function(a){var g=v++;y[g]=a;t.port2.postMessage(g);return g}}else Ja="document"in F&&"onreadystatechange"in F.document.createElement("script")?function(g){var b=F.document.createElement("script"),l=v++;y[l]=g;b.onreadystatechange=function(){a(l);b.onreadystatechange=null;b.parentNode.removeChild(b);
b=null};F.document.documentElement.appendChild(b);return l}:function(g){var b=v++;y[b]=g;bb(function(){a(b)},0);return b}})();var Ba=ra.timeout=ra["default"]=function(){return new ra(ua,function(a,g){var b=this,l=new Q,d=Ja(function(){!l.isDisposed&&l.setDisposable(g(b,a))});return new Y(l,la(function(){ab(d)}))},function(a,g,b){var l=this;g=ra.normalize(g);var v=new Q;if(0===g)return l.scheduleWithState(a,b);var d=bb(function(){!v.isDisposed&&v.setDisposable(b(l,a))},g);return new Y(v,la(function(){rb(d)}))},
function(a,g,b){return this.scheduleWithRelativeAndState(a,g-this.now(),b)})}(),ya=t.Notification=function(){function a(a,b,l,d,c,e){this.kind=a;this.value=b;this.exception=l;this._accept=d;this._acceptObservable=c;this.toString=e}a.prototype.accept=function(a,b,l){return a&&"object"===typeof a?this._acceptObservable(a):this._accept(a,b,l)};a.prototype.toObservable=function(a){var g=this;ha(a)||(a=pa);return new N(function(b){return a.scheduleWithState(g,function(a,g){g._acceptObservable(b);"N"===
g.kind&&b.onCompleted()})})};return a}(),sb=ya.createOnNext=function(){function a(a){return a(this.value)}function g(a){return a.onNext(this.value)}function b(){return"OnNext("+this.value+")"}return function(l){return new ya("N",l,null,a,g,b)}}(),tb=ya.createOnError=function(){function a(a,g){return g(this.exception)}function g(a){return a.onError(this.exception)}function b(){return"OnError("+this.exception+")"}return function(l){return new ya("E",null,l,a,g,b)}}(),ub=ya.createOnCompleted=function(){function a(a,
g,b){return b()}function g(a){return a.onCompleted()}function b(){return"OnCompleted()"}return function(){return new ya("C",null,null,a,g,b)}}(),Ca=t.Observer=function(){},Oa=Ca.create=function(a,g,b){a||(a=O);g||(g=Qa);b||(b=O);return new vb(a,g,b)},Pa=t.internals.AbstractObserver=function(a){function g(){this.isStopped=!1}G(g,a);g.prototype.next=wa;g.prototype.error=wa;g.prototype.completed=wa;g.prototype.onNext=function(a){!this.isStopped&&this.next(a)};g.prototype.onError=function(a){this.isStopped||
(this.isStopped=!0,this.error(a))};g.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())};g.prototype.dispose=function(){this.isStopped=!0};g.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.error(a),!0)};return g}(Ca),vb=t.AnonymousObserver=function(a){function g(g,b,l){a.call(this);this._onNext=g;this._onError=b;this._onCompleted=l}G(g,a);g.prototype.next=function(a){this._onNext(a)};g.prototype.error=function(a){this._onError(a)};g.prototype.completed=
function(){this._onCompleted()};return g}(Pa),A,L=t.Observable=function(){function a(a){this._subscribe=a}A=a.prototype;a.isObservable=function(a){return a&&V(a.subscribe)};A.subscribe=A.forEach=function(a,b,l){return this._subscribe("object"===typeof a?a:Oa(a,b,l))};A.subscribeOnNext=function(a,b){return this._subscribe(Oa("undefined"!==typeof b?function(g){a.call(b,g)}:a))};A.subscribeOnError=function(a,b){return this._subscribe(Oa(null,"undefined"!==typeof b?function(g){a.call(b,g)}:a))};A.subscribeOnCompleted=
function(a,b){return this._subscribe(Oa(null,null,"undefined"!==typeof b?function(){a.call(b)}:a))};return a}(),wb=t.internals.ScheduledObserver=function(a){function g(b,g){a.call(this);this.scheduler=b;this.observer=g;this.hasFaulted=this.isAcquired=!1;this.queue=[];this.disposable=new qa}G(g,a);g.prototype.next=function(a){var b=this;this.queue.push(function(){b.observer.onNext(a)})};g.prototype.error=function(a){var b=this;this.queue.push(function(){b.observer.onError(a)})};g.prototype.completed=
function(){var a=this;this.queue.push(function(){a.observer.onCompleted()})};g.prototype.ensureActive=function(){var a=!1;!this.hasFaulted&&0<this.queue.length&&(a=!this.isAcquired,this.isAcquired=!0);a&&this.disposable.setDisposable(this.scheduler.scheduleRecursiveWithState(this,function(a,g){if(0<a.queue.length){var l=a.queue.shift();l=b(l)();if(l===K)return a.queue=[],a.hasFaulted=!0,p(l.e);g(a)}else a.isAcquired=!1}))};g.prototype.dispose=function(){a.prototype.dispose.call(this);this.disposable.dispose()};
return g}(Pa),ba=t.ObservableBase=function(a){function g(a){return a&&V(a.dispose)?a:V(a)?la(a):oa}function l(a,l){a=l[0];l=l[1];l=b(l.subscribeCore).call(l,a);if(l===K&&!a.fail(K.e))return p(K.e);a.setDisposable(g(l))}function d(a){a=new hb(a);var b=[a,this];sa.scheduleRequired()?sa.scheduleWithState(b,l):l(null,b);return a}function c(){a.call(this,d)}G(c,a);c.prototype.subscribeCore=wa;return c}(L),Sa=function(a){function g(b,g,l,d){this.resultSelector=t.helpers.isFunction(l)?l:null;this.selector=
t.internals.bindCallback(t.helpers.isFunction(g)?g:function(){return g},d,3);this.source=b;a.call(this)}function l(a,b,g,l){this.i=0;this.selector=b;this.resultSelector=g;this.source=l;this.isStopped=!1;this.o=a}G(g,a);g.prototype.subscribeCore=function(a){return this.source.subscribe(new l(a,this.selector,this.resultSelector,this))};l.prototype._wrapResult=function(a,b,g){return this.resultSelector?a.map(function(a,l){return this.resultSelector(b,a,g,l)},this):a};l.prototype.onNext=function(a){if(!this.isStopped){var g=
this.i++,l=b(this.selector)(a,g,this.source);if(l===K)return this.o.onError(l.e);t.helpers.isPromise(l)&&(l=t.Observable.fromPromise(l));t.helpers.isArrayLike(l)&&(l=t.Observable.from(l));this.o.onNext(this._wrapResult(l,a,g))}};l.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};l.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};return g}(ba),Ga=t.internals.Enumerable=function(){},xb=function(a){function g(b){this.sources=
b;a.call(this)}function l(a,b,g){this.o=a;this.s=b;this.e=g;this.isStopped=!1}G(g,a);g.prototype.subscribeCore=function(a){var g,d=new qa,v=pa.scheduleRecursiveWithState(this.sources._es6shim_iterator_(),function(v,c){if(!g){var y=b(v.next).call(v);if(y===K)return a.onError(y.e);if(y.done)return a.onCompleted();y=y.value;ja(y)&&(y=na(y));var e=new Q;d.setDisposable(e);e.setDisposable(y.subscribe(new l(a,c,v)))}});return new Y(d,v,la(function(){g=!0}))};l.prototype.onNext=function(a){if(!this.isStopped)this.o.onNext(a)};
l.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};l.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.s(this.e))};l.prototype.dispose=function(){this.isStopped=!0};l.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return g}(ba);Ga.prototype.concat=function(){return new xb(this)};var yb=function(a){function g(b){this.sources=b;a.call(this)}G(g,a);g.prototype.subscribeCore=function(a){var g=this.sources._es6shim_iterator_(),
l,d=new qa,c=pa.scheduleRecursiveWithState(null,function(c,v){if(!l){var y=b(g.next).call(g);if(y===K)return a.onError(y.e);if(y.done)return null!==c?a.onError(c):a.onCompleted();c=y.value;ja(c)&&(c=na(c));y=new Q;d.setDisposable(y);y.setDisposable(c.subscribe(function(b){a.onNext(b)},v,function(){a.onCompleted()}))}});return new Y(d,c,la(function(){l=!0}))};return g}(ba);Ga.prototype.catchError=function(){return new yb(this)};Ga.prototype.catchErrorWhen=function(a){var g=this;return new N(function(l){var d=
new Da,c=new Da,v=a(d).subscribe(c),e=g._es6shim_iterator_(),f,t=new qa,k=pa.scheduleRecursive(function(a){if(!f){var g=b(e.next).call(e);if(g===K)return l.onError(g.e);if(g.done)l.onCompleted();else{g=g.value;ja(g)&&(g=na(g));var v=new Q,y=new Q;t.setDisposable(new Y(y,v));v.setDisposable(g.subscribe(function(a){l.onNext(a)},function(b){y.setDisposable(c.subscribe(a,function(a){l.onError(a)},function(){l.onCompleted()}));d.onNext(b)},function(){l.onCompleted()}))}}});return new Y(v,t,k,la(function(){f=
!0}))})};var zb=function(a){function b(a,b){this.v=a;this.c=null==b?-1:b}function l(a){this.v=a.v;this.l=a.c}G(b,a);b.prototype._es6shim_iterator_=function(){return new l(this)};l.prototype.next=function(){if(0===this.l)return ta;0<this.l&&this.l--;return{done:!1,value:this.v}};return b}(Ga),cb=Ga.repeat=function(a,b){return new zb(a,b)},Ab=function(a){function b(a,b,g){this.s=a;this.fn=b?xa(b,g,3):null}function l(a){this.i=-1;this.s=a.s;this.l=this.s.length;this.fn=a.fn}G(b,a);b.prototype._es6shim_iterator_=
function(){return new l(this)};l.prototype.next=function(){return++this.i<this.l?{done:!1,value:this.fn?this.fn(this.s[this.i],this.i,this.s):this.s[this.i]}:ta};return b}(Ga),ib=Ga.of=function(a,b,d){return new Ab(a,b,d)},Bb=function(a){function b(b){this.source=b;a.call(this)}function l(a){this.o=a;this.a=[];this.isStopped=!1}G(b,a);b.prototype.subscribeCore=function(a){return this.source.subscribe(new l(a))};l.prototype.onNext=function(a){this.isStopped||this.a.push(a)};l.prototype.onError=function(a){this.isStopped||
(this.isStopped=!0,this.o.onError(a))};l.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onNext(this.a),this.o.onCompleted())};l.prototype.dispose=function(){this.isStopped=!0};l.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return b}(ba);A.toArray=function(){return new Bb(this)};L.create=function(a,b){return new N(a,b)};var fb=L.defer=function(a){return new N(function(b){try{var g=a()}catch(y){return db(y).subscribe(b)}ja(g)&&
(g=na(g));return g.subscribe(b)})},jb=function(a){function b(b){this.scheduler=b;a.call(this)}function l(a,b){this.observer=a;this.scheduler=b}function d(a,b){b.onCompleted();return oa}G(b,a);b.prototype.subscribeCore=function(a){return(new l(a,this.scheduler)).run()};l.prototype.run=function(){return this.scheduler.scheduleWithState(this.observer,d)};return b}(ba),Cb=new jb(pa),Db=L.empty=function(a){ha(a)||(a=pa);return a===pa?Cb:new jb(a)},Fb=function(a){function b(b,g,l){this.iterable=b;this.mapper=
g;this.scheduler=l;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return(new Eb(a,this)).run()};return b}(ba),Eb=function(){function a(a,b){this.o=a;this.parent=b}a.prototype.run=function(){var a=C(Object(this.parent.iterable)),l=this.o,d=this.parent.mapper;return this.parent.scheduler.scheduleRecursiveWithState(0,function(g,c){var v=b(a.next).call(a);if(v===K)return l.onError(v.e);if(v.done)return l.onCompleted();v=v.value;if(V(d)&&(v=b(d)(v,g),v===K))return l.onError(v.e);l.onNext(v);
c(g+1)})};return a}(),eb=Math.pow(2,53)-1;k.prototype._es6shim_iterator_=function(){return new w(this._s)};w.prototype._es6shim_iterator_=function(){return this};w.prototype.next=function(){return this._i<this._l?{done:!1,value:this._s.charAt(this._i++)}:ta};u.prototype._es6shim_iterator_=function(){return new m(this._a)};m.prototype._es6shim_iterator_=function(){return this};m.prototype.next=function(){return this._i<this._l?{done:!1,value:this._a[this._i++]}:ta};var Gb=L.from=function(a,b,d,c){var g;
if(null==a)throw Error("iterable cannot be null.");if(b&&!V(b))throw Error("mapFn when provided must be a function");b&&(g=xa(b,d,2));ha(c)||(c=sa);return new Fb(a,g,c)},Ra=function(a){function b(b,g){this.args=b;this.scheduler=g;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return(new e(a,this)).run()};return b}(ba);e.prototype.run=function(){var a=this.observer,b=this.parent.args,d=b.length;return this.parent.scheduler.scheduleRecursiveWithState(0,function(g,l){if(g<d)a.onNext(b[g]),
l(g+1);else a.onCompleted()})};var Hb=L.fromArray=function(a,b){ha(b)||(b=sa);return new Ra(a,b)},Ib=new (function(a){function b(){a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return oa};return b}(ba));L.never=function(){return Ib};L.of=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];return new Ra(b,sa)};L.ofWithScheduler=function(a){for(var b=arguments.length,l=Array(b-1),d=1;d<b;d++)l[d-1]=arguments[d];return new Ra(l,a)};var Jb=function(a){function b(b,
g){this.obj=b;this.keys=Object.keys(b);this.scheduler=g;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return(new B(a,this)).run()};return b}(ba);B.prototype.run=function(){var a=this.observer,b=this.parent.obj,d=this.parent.keys,c=d.length;return this.parent.scheduler.scheduleRecursiveWithState(0,function(g,l){if(g<c){var v=d[g];a.onNext([v,b[v]]);l(g+1)}else a.onCompleted()})};L.pairs=function(a,b){b||(b=sa);return new Jb(a,b)};var Lb=function(a){function b(b,g,l){this.start=b;this.rangeCount=
g;this.scheduler=l;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return(new Kb(a,this)).run()};return b}(ba),Kb=function(){function a(a,b){this.observer=a;this.parent=b}a.prototype.run=function(){var a=this.parent.start,b=this.parent.rangeCount,l=this.observer;return this.parent.scheduler.scheduleRecursiveWithState(0,function(g,d){if(g<b)l.onNext(a+g),d(g+1);else l.onCompleted()})};return a}();L.range=function(a,b,d){ha(d)||(d=sa);return new Lb(a,b,d)};var Mb=function(a){function b(b,
g,l){this.value=b;this.repeatCount=null==g?-1:g;this.scheduler=l;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return(new J(a,this)).run()};return b}(ba);J.prototype.run=function(){var a=this.observer,b=this.parent.value;return this.parent.scheduler.scheduleRecursiveWithState(this.parent.repeatCount,function(g,l){if(-1===g||0<g)a.onNext(b),0<g&&g--;if(0===g)return a.onCompleted();l(g)})};L.repeat=function(a,b,d){ha(d)||(d=sa);return new Mb(a,b,d)};var Nb=function(a){function b(b,g){this.value=
b;this.scheduler=g;a.call(this)}function l(a,b,g){this.observer=a;this.value=b;this.scheduler=g}function d(a,b){a=b[1];a.onNext(b[0]);a.onCompleted();return oa}G(b,a);b.prototype.subscribeCore=function(a){return(new l(a,this.value,this.scheduler)).run()};l.prototype.run=function(){var a=[this.value,this.observer];return this.scheduler===pa?d(null,a):this.scheduler.scheduleWithState(a,d)};return b}(ba);L["return"]=L.just=function(a,b){ha(b)||(b=pa);return new Nb(a,b)};var Ob=function(a){function b(b,
g){this.error=b;this.scheduler=g;a.call(this)}function l(a,b){this.o=a;this.p=b}function d(a,b){b[1].onError(b[0])}G(b,a);b.prototype.subscribeCore=function(a){return(new l(a,this)).run()};l.prototype.run=function(){return this.p.scheduler.scheduleWithState([this.p.error,this.o],d)};return b}(ba),db=L["throw"]=function(a,b){ha(b)||(b=pa);return new Ob(a,b)},pb=function(a){function g(b,g,l){this._o=b;this._s=g;this._fn=l;a.call(this)}G(g,a);g.prototype.next=function(a){this._o.onNext(a)};g.prototype.completed=
function(){return this._o.onCompleted()};g.prototype.error=function(a){a=b(this._fn)(a);if(a===K)return this._o.onError(a.e);ja(a)&&(a=na(a));var g=new Q;this._s.setDisposable(g);g.setDisposable(a.subscribe(this._o))};return g}(Pa);A["catch"]=function(a){return V(a)?M(this,a):Pb([this,a])};var Pb=L["catch"]=function(){if(Array.isArray(arguments[0]))var a=arguments[0];else{var b=arguments.length;a=Array(b);for(var d=0;d<b;d++)a[d]=arguments[d]}return ib(a).catchError()};A.combineLatest=function(){for(var a=
arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];Array.isArray(b[0])?b[0].unshift(this):b.unshift(this);return Qb.apply(this,b)};var Qb=L.combineLatest=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];var c=V(b[a-1])?b.pop():z;Array.isArray(b[0])&&(b=b[0]);return new N(function(a){function g(b){l[b]=!0;if(y||(y=l.every(ma))){try{var g=c.apply(null,e)}catch(qb){return a.onError(qb)}a.onNext(g)}else if(v.filter(function(a,g){return g!==b}).every(ma))a.onCompleted()}
for(var d=b.length,l=q(d,I),y=!1,v=q(d,I),e=Array(d),f=Array(d),t=0;t<d;t++)(function(d){var l=b[d],c=new Q;ja(l)&&(l=na(l));c.setDisposable(l.subscribe(function(a){e[d]=a;g(d)},function(b){a.onError(b)},function(){v[d]=!0;v.every(ma)&&a.onCompleted()}));f[d]=c})(t);return new Y(f)},this)};A.concat=function(){for(var a=[],b=0,d=arguments.length;b<d;b++)a.push(arguments[b]);a.unshift(this);return Rb.apply(null,a)};var Sb=function(a){function b(b){this.sources=b;a.call(this)}function d(a,b){this.sources=
a;this.o=b}G(b,a);b.prototype.subscribeCore=function(a){return(new d(this.sources,a)).run()};d.prototype.run=function(){var a,b=new qa,g=this.sources,d=g.length,l=this.o,c=pa.scheduleRecursiveWithState(0,function(c,y){if(!a){if(c===d)return l.onCompleted();var e=g[c];ja(e)&&(e=na(e));var v=new Q;b.setDisposable(v);v.setDisposable(e.subscribe(function(a){l.onNext(a)},function(a){l.onError(a)},function(){y(c+1)}))}});return new Y(b,c,la(function(){a=!0}))};return b}(ba),Rb=L.concat=function(){if(Array.isArray(arguments[0]))var a=
arguments[0];else{a=Array(arguments.length);for(var b=0,d=arguments.length;b<d;b++)a[b]=arguments[b]}return new Sb(a)};A.concatAll=function(){return this.merge(1)};var Ub=function(a){function b(b,g){this.source=b;this.maxConcurrent=g;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){var b=new Y;b.add(this.source.subscribe(new Tb(a,this.maxConcurrent,b)));return b};return b}(ba),Tb=function(){function a(a,b,g){this.o=a;this.max=b;this.g=g;this.done=!1;this.q=[];this.activeCount=0;this.isStopped=
!1}function b(a,b){this.parent=a;this.sad=b;this.isStopped=!1}a.prototype.handleSubscribe=function(a){var g=new Q;this.g.add(g);ja(a)&&(a=na(a));g.setDisposable(a.subscribe(new b(this,g)))};a.prototype.onNext=function(a){this.isStopped||(this.activeCount<this.max?(this.activeCount++,this.handleSubscribe(a)):this.q.push(a))};a.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};a.prototype.onCompleted=function(){this.isStopped||(this.done=this.isStopped=!0,0===this.activeCount&&
this.o.onCompleted())};a.prototype.dispose=function(){this.isStopped=!0};a.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};b.prototype.onNext=function(a){if(!this.isStopped)this.parent.o.onNext(a)};b.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.parent.o.onError(a))};b.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=!0;var a=this.parent;a.g.remove(this.sad);0<a.q.length?a.handleSubscribe(a.q.shift()):(a.activeCount--,
a.done&&0===a.activeCount&&a.o.onCompleted())}};b.prototype.dispose=function(){this.isStopped=!0};b.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(a),!0)};return a}();A.merge=function(a){return"number"!==typeof a?Vb(this,a):new Ub(this,a)};var Vb=L.merge=function(){var a=[],b=arguments.length;if(arguments[0])if(ha(arguments[0])){var c=arguments[0];var e=1}else c=pa,e=0;else c=pa,e=1;for(;e<b;e++)a.push(arguments[e]);Array.isArray(a[0])&&(a=a[0]);return d(c,
a).mergeAll()},kb=t.CompositeError=function(a){this.name="NotImplementedError";this.innerErrors=a;this.message="This contains multiple errors. Check the innerErrors";Error.call(this)};kb.prototype=Error.prototype;L.mergeDelayError=function(){if(Array.isArray(arguments[0]))var a=arguments[0];else{var b=arguments.length;a=Array(b);for(var c=0;c<b;c++)a[c]=arguments[c]}var e=d(null,a);return new N(function(a){function b(){if(0===l.length)a.onCompleted();else if(1===l.length)a.onError(l[0]);else a.onError(new kb(l))}
var g=new Y,d=new Q,c=!1,l=[];g.add(d);d.setDisposable(e.subscribe(function(d){var e=new Q;g.add(e);ja(d)&&(d=na(d));e.setDisposable(d.subscribe(function(b){a.onNext(b)},function(a){l.push(a);g.remove(e);c&&1===g.length&&b()},function(){g.remove(e);c&&1===g.length&&b()}))},function(a){l.push(a);c=!0;1===g.length&&b()},function(){c=!0;1===g.length&&b()}));return g})};var Wb=function(a){function b(b){this.source=b;a.call(this)}function d(a,b){this.o=a;this.g=b;this.done=this.isStopped=!1}function c(a,
b){this.parent=a;this.sad=b;this.isStopped=!1}G(b,a);b.prototype.subscribeCore=function(a){var b=new Y,g=new Q;b.add(g);g.setDisposable(this.source.subscribe(new d(a,b)));return b};d.prototype.onNext=function(a){if(!this.isStopped){var b=new Q;this.g.add(b);ja(a)&&(a=na(a));b.setDisposable(a.subscribe(new c(this,b)))}};d.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};d.prototype.onCompleted=function(){this.isStopped||(this.done=this.isStopped=!0,1===this.g.length&&
this.o.onCompleted())};d.prototype.dispose=function(){this.isStopped=!0};d.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};c.prototype.onNext=function(a){if(!this.isStopped)this.parent.o.onNext(a)};c.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.parent.o.onError(a))};c.prototype.onCompleted=function(){if(!this.isStopped){var a=this.parent;this.isStopped=!0;a.g.remove(this.sad);a.done&&1===a.g.length&&a.o.onCompleted()}};c.prototype.dispose=
function(){this.isStopped=!0};c.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(a),!0)};return b}(ba);A.mergeAll=function(){return new Wb(this)};A.skipUntil=function(a){var b=this;return new N(function(g){var d=!1,c=new Y(b.subscribe(function(a){d&&g.onNext(a)},function(a){g.onError(a)},function(){d&&g.onCompleted()}));ja(a)&&(a=na(a));var l=new Q;c.add(l);l.setDisposable(a.subscribe(function(){d=!0;l.dispose()},function(a){g.onError(a)},function(){l.dispose()}));
return c},b)};var Xb=function(a){function b(b){this.source=b;a.call(this)}function d(a,b){this.o=a;this.inner=b;this.stopped=!1;this.latest=0;this.isStopped=this.hasLatest=!1}function c(a,b){this.parent=a;this.id=b;this.isStopped=!1}G(b,a);b.prototype.subscribeCore=function(a){var b=new qa;a=this.source.subscribe(new d(a,b));return new Y(a,b)};d.prototype.onNext=function(a){if(!this.isStopped){var b=new Q,g=++this.latest;this.hasLatest=!0;this.inner.setDisposable(b);ja(a)&&(a=na(a));b.setDisposable(a.subscribe(new c(this,
g)))}};d.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};d.prototype.onCompleted=function(){this.isStopped||(this.stopped=this.isStopped=!0,!this.hasLatest&&this.o.onCompleted())};d.prototype.dispose=function(){this.isStopped=!0};d.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};c.prototype.onNext=function(a){this.isStopped||this.parent.latest===this.id&&this.parent.o.onNext(a)};c.prototype.onError=function(a){this.isStopped||
(this.isStopped=!0,this.parent.latest===this.id&&this.parent.o.onError(a))};c.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.parent.latest===this.id&&(this.parent.hasLatest=!1,this.parent.isStopped&&this.parent.o.onCompleted()))};c.prototype.dispose=function(){this.isStopped=!0};c.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(a),!0)};return b}(ba);A["switch"]=A.switchLatest=function(){return new Xb(this)};var Yb=function(a){function b(b,
g){this.source=b;this.other=ja(g)?na(g):g;a.call(this)}function d(a){this.o=a;this.isStopped=!1}G(b,a);b.prototype.subscribeCore=function(a){return new Y(this.source.subscribe(a),this.other.subscribe(new d(a)))};d.prototype.onNext=function(a){if(!this.isStopped)this.o.onCompleted()};d.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};d.prototype.onCompleted=function(){!this.isStopped&&(this.isStopped=!0)};d.prototype.dispose=function(){this.isStopped=!0};d.prototype.fail=
function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return b}(ba);A.takeUntil=function(a){return new Yb(this,a)};A.withLatestFrom=function(){for(var a=arguments.length,g=Array(a),d=0;d<a;d++)g[d]=arguments[d];var c=g.pop(),e=this;Array.isArray(g[0])&&(g=g[0]);return new N(function(a){for(var d=g.length,l=q(d,I),f=!1,y=Array(d),t=Array(d+1),k=0;k<d;k++)(function(b){var d=g[b],c=new Q;ja(d)&&(d=na(d));c.setDisposable(d.subscribe(function(a){y[b]=a;l[b]=!0;f=l.every(ma)},function(b){a.onError(b)},
O));t[b]=c})(k);k=new Q;k.setDisposable(e.subscribe(function(g){g=[g].concat(y);if(f){g=b(c).apply(null,g);if(g===K)return a.onError(g.e);a.onNext(g)}},function(b){a.onError(b)},function(){a.onCompleted()}));t[d]=k;return new Y(t)},this)};A.zip=function(){if(0===arguments.length)throw Error("invalid arguments");for(var a=arguments.length,g=Array(a),d=0;d<a;d++)g[d]=arguments[d];var c=V(g[a-1])?g.pop():z;Array.isArray(g[0])&&(g=g[0]);var e=this;g.unshift(e);return new N(function(a){for(var d=g.length,
l=q(d,W),f=q(d,I),y=Array(d),t=0;t<d;t++)(function(d){var t=g[d],k=new Q;ja(t)&&(t=na(t));k.setDisposable(t.subscribe(function(g){l[d].push(g);if(l.every(function(a){return 0<a.length})){g=l.map(function(a){return a.shift()});g=b(c).apply(e,g);if(g===K)return a.onError(g.e);a.onNext(g)}else if(f.filter(function(a,b){return b!==d}).every(ma))a.onCompleted()},function(b){a.onError(b)},function(){f[d]=!0;f.every(ma)&&a.onCompleted()}));y[d]=k})(t);return new Y(y)},e)};L.zip=function(){for(var a=arguments.length,
b=Array(a),d=0;d<a;d++)b[d]=arguments[d];Array.isArray(b[0])&&(b=V(b[1])?b[0].concat(b[1]):b[0]);a=b.shift();return a.zip.apply(a,b)};A.zipIterable=function(){if(0===arguments.length)throw Error("invalid arguments");for(var a=arguments.length,d=Array(a),c=0;c<a;c++)d[c]=arguments[c];var e=V(d[a-1])?d.pop():z,t=this;d.unshift(t);return new N(function(a){for(var g=d.length,c=q(g,W),l=q(g,I),f=Array(g),y=0;y<g;y++)(function(g){var y=d[g],k=new Q;(Ya(y)||isIterable(y))&&(y=Gb(y));k.setDisposable(y.subscribe(function(d){c[g].push(d);
if(c.every(function(a){return 0<a.length})){d=c.map(function(a){return a.shift()});d=b(e).apply(t,d);if(d===K)return a.onError(d.e);a.onNext(d)}else if(l.filter(function(a,b){return b!==g}).every(ma))a.onCompleted()},function(b){a.onError(b)},function(){l[g]=!0;l.every(ma)&&a.onCompleted()}));f[g]=k})(y);return new Y(f)},t)};A.asObservable=function(){return new N(E(this),this)};A.dematerialize=function(){var a=this;return new N(function(b){return a.subscribe(function(a){return a.accept(b)},function(a){b.onError(a)},
function(){b.onCompleted()})},this)};var $b=function(a){function b(b,d,g){this.source=b;this.keyFn=d;this.comparer=g;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return this.source.subscribe(new Zb(a,this.keyFn,this.comparer))};return b}(ba),Zb=function(a){function d(b,d,g){this.o=b;this.keyFn=d;this.comparer=g;this.hasCurrentKey=!1;this.currentKey=null;a.call(this)}G(d,a);d.prototype.next=function(a){var d=a;if(V(this.keyFn)&&(d=b(this.keyFn)(a),d===K))return this.o.onError(d.e);if(this.hasCurrentKey){var g=
b(this.comparer)(this.currentKey,d);if(g===K)return this.o.onError(g.e)}this.hasCurrentKey&&g||(this.hasCurrentKey=!0,this.currentKey=d,this.o.onNext(a))};d.prototype.error=function(a){this.o.onError(a)};d.prototype.completed=function(){this.o.onCompleted()};return d}(Pa);A.distinctUntilChanged=function(a,b){b||(b=Va);return new $b(this,a,b)};var ac=function(a){function d(b,d,g,c){this.source=b;this._oN=d;this._oE=g;this._oC=c;a.call(this)}function c(a,b){this.o=a;this.t=!b._oN||V(b._oN)?Oa(b._oN||
O,b._oE||O,b._oC||O):b._oN;this.isStopped=!1}G(d,a);d.prototype.subscribeCore=function(a){return this.source.subscribe(new c(a,this))};c.prototype.onNext=function(a){if(!this.isStopped){var d=b(this.t.onNext).call(this.t,a);if(d===K)this.o.onError(d.e);this.o.onNext(a)}};c.prototype.onError=function(a){if(!this.isStopped){this.isStopped=!0;var d=b(this.t.onError).call(this.t,a);if(d===K)return this.o.onError(d.e);this.o.onError(a)}};c.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=
!0;var a=b(this.t.onCompleted).call(this.t);if(a===K)return this.o.onError(a.e);this.o.onCompleted()}};c.prototype.dispose=function(){this.isStopped=!0};c.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return d}(ba);A["do"]=A.tap=A.doAction=function(a,b,d){return new ac(this,a,b,d)};A.doOnNext=A.tapOnNext=function(a,b){return this.tap("undefined"!==typeof b?function(d){a.call(b,d)}:a)};A.doOnError=A.tapOnError=function(a,b){return this.tap(O,"undefined"!==
typeof b?function(d){a.call(b,d)}:a)};A.doOnCompleted=A.tapOnCompleted=function(a,b){return this.tap(O,null,"undefined"!==typeof b?function(){a.call(b)}:a)};A["finally"]=function(a){var d=this;return new N(function(g){var c=b(d.subscribe).call(d,g);return c===K?(a(),p(c.e)):la(function(){var d=b(c.dispose).call(c);a();d===K&&p(d.e)})},this)};var bc=function(a){function b(b){this.source=b;a.call(this)}function d(a){this.o=a;this.isStopped=!1}G(b,a);b.prototype.subscribeCore=function(a){return this.source.subscribe(new d(a))};
d.prototype.onNext=O;d.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};d.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};d.prototype.dispose=function(){this.isStopped=!0};d.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.observer.onError(a),!0)};return b}(ba);A.ignoreElements=function(){return new bc(this)};A.materialize=function(){var a=this;return new N(function(b){return a.subscribe(function(a){b.onNext(sb(a))},
function(a){b.onNext(tb(a));b.onCompleted()},function(){b.onNext(ub());b.onCompleted()})},a)};A.repeat=function(a){return cb(this,a).concat()};A.retry=function(a){return cb(this,a).catchError()};A.retryWhen=function(a){return cb(this).catchErrorWhen(a)};var cc=function(a){function b(b,d,g,c){this.source=b;this.accumulator=d;this.hasSeed=g;this.seed=c;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return this.source.subscribe(new D(a,this))};return b}(ba);D.prototype={onNext:function(a){if(!this.isStopped){!this.hasValue&&
(this.hasValue=!0);this.hasAccumulation?this.accumulation=b(this.accumulator)(this.accumulation,a):(this.accumulation=this.hasSeed?b(this.accumulator)(this.seed,a):a,this.hasAccumulation=!0);if(this.accumulation===K)return this.o.onError(this.accumulation.e);this.o.onNext(this.accumulation)}},onError:function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))},onCompleted:function(){this.isStopped||(this.isStopped=!0,!this.hasValue&&this.hasSeed&&this.o.onNext(this.seed),this.o.onCompleted())},
dispose:function(){this.isStopped=!0},fail:function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)}};A.scan=function(){var a=!1,b=arguments[0];if(2===arguments.length){a=!0;var d=arguments[1]}return new cc(this,b,a,d)};A.skipLast=function(a){if(0>a)throw new Aa;var b=this;return new N(function(d){var g=[];return b.subscribe(function(b){g.push(b);g.length>a&&d.onNext(g.shift())},function(a){d.onError(a)},function(){d.onCompleted()})},b)};A.startWith=function(){var a=0;if(arguments.length&&
ha(arguments[0])){var b=arguments[0];a=1}else b=pa;for(var d=[],c=arguments.length;a<c;a++)d.push(arguments[a]);return ib([Hb(d,b),this]).concat()};A.takeLast=function(a){if(0>a)throw new Aa;var b=this;return new N(function(d){var g=[];return b.subscribe(function(b){g.push(b);g.length>a&&g.shift()},function(a){d.onError(a)},function(){for(;0<g.length;)d.onNext(g.shift());d.onCompleted()})},b)};A.flatMapConcat=A.concatMap=function(a,b,d){return(new Sa(this,a,b,d)).merge(1)};var lb=function(a){function d(b,
d,g){this.source=b;this.selector=xa(d,g,3);a.call(this)}function c(a,b){return function(d,g,c){return a.call(this,b.selector(d,g,c),g,c)}}function l(a,b,d){this.o=a;this.selector=b;this.source=d;this.i=0;this.isStopped=!1}G(d,a);d.prototype.internalMap=function(a,b){return new d(this.source,c(a,this),b)};d.prototype.subscribeCore=function(a){return this.source.subscribe(new l(a,this.selector,this))};l.prototype.onNext=function(a){if(!this.isStopped){a=b(this.selector)(a,this.i++,this.source);if(a===
K)return this.o.onError(a.e);this.o.onNext(a)}};l.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};l.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};l.prototype.dispose=function(){this.isStopped=!0};l.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return d}(ba);A.map=A.select=function(a,b){var d="function"===typeof a?a:function(){return a};return this instanceof lb?this.internalMap(d,
b):new lb(this,d,b)};A.pluck=function(){var a=arguments.length,b=Array(a);if(0===a)throw Error("List of properties cannot be empty.");for(var d=0;d<a;d++)b[d]=arguments[d];return this.map(R(b,a))};A.flatMap=A.selectMany=function(a,b,d){return(new Sa(this,a,b,d)).mergeAll()};t.Observable.prototype.flatMapWithMaxConcurrent=function(a,b,d,c){return(new Sa(this,b,d,c)).merge(a)};t.Observable.prototype.flatMapLatest=function(a,b,d){return(new Sa(this,a,b,d)).switchLatest()};var dc=function(a){function b(b,
d){this.source=b;this.skipCount=d;a.call(this)}function d(a,b){this.r=this.c=b;this.o=a;this.isStopped=!1}G(b,a);b.prototype.subscribeCore=function(a){return this.source.subscribe(new d(a,this.skipCount))};d.prototype.onNext=function(a){if(!this.isStopped)if(0>=this.r)this.o.onNext(a);else this.r--};d.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};d.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};d.prototype.dispose=
function(){this.isStopped=!0};d.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return b}(ba);A.skip=function(a){if(0>a)throw new Aa;return new dc(this,a)};A.skipWhile=function(a,b){var d=this,g=xa(a,b,3);return new N(function(a){var b=0,c=!1;return d.subscribe(function(l){if(!c)try{c=!g(l,b++,d)}catch(Xa){a.onError(Xa);return}c&&a.onNext(l)},function(b){a.onError(b)},function(){a.onCompleted()})},d)};A.take=function(a,b){if(0>a)throw new Aa;if(0===a)return Db(b);
var d=this;return new N(function(b){var g=a;return d.subscribe(function(a){0<g--&&(b.onNext(a),0>=g&&b.onCompleted())},function(a){b.onError(a)},function(){b.onCompleted()})},d)};A.takeWhile=function(a,b){var d=this,g=xa(a,b,3);return new N(function(a){var b=0,c=!0;return d.subscribe(function(l){if(c){try{c=g(l,b++,d)}catch(Xa){a.onError(Xa);return}if(c)a.onNext(l);else a.onCompleted()}},function(b){a.onError(b)},function(){a.onCompleted()})},d)};var mb=function(a){function d(b,d,g){this.source=b;
this.predicate=xa(d,g,3);a.call(this)}function c(a,b){return function(d,g,c){return b.predicate(d,g,c)&&a.call(this,d,g,c)}}function l(a,b,d){this.o=a;this.predicate=b;this.source=d;this.i=0;this.isStopped=!1}G(d,a);d.prototype.subscribeCore=function(a){return this.source.subscribe(new l(a,this.predicate,this))};d.prototype.internalFilter=function(a,b){return new d(this.source,c(a,this),b)};l.prototype.onNext=function(a){if(!this.isStopped){var d=b(this.predicate)(a,this.i++,this.source);if(d===K)return this.o.onError(d.e);
d&&this.o.onNext(a)}};l.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};l.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};l.prototype.dispose=function(){this.isStopped=!0};l.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return d}(ba);A.filter=A.where=function(a,b){return this instanceof mb?this.internalFilter(a,b):new mb(this,a,b)};L.fromCallback=function(a,b,d){return function(){"undefined"===
typeof b&&(b=this);for(var c=arguments.length,g=Array(c),l=0;l<c;l++)g[l]=arguments[l];c=b;l=new Ta;g.push(S(l,c,d));a.apply(c,g);return l.asObservable()}};L.fromNodeCallback=function(a,b,d){return function(){"undefined"===typeof b&&(b=this);for(var c=arguments.length,g=Array(c),l=0;l<c;l++)g[l]=arguments[l];c=b;l=new Ta;g.push(T(l,c,d));a.apply(c,g);return l.asObservable()}};P.prototype.dispose=function(){this.isDisposed||(this._e.removeEventListener(this._n,this._fn,!1),this.isDisposed=!0)};L.fromEvent=
function(a,b,d){return a.addListener?ec(function(d){a.addListener(b,d)},function(d){a.removeListener(b,d)},d):new N(function(c){return H(a,b,X(c,d))})};var ec=L.fromEventPattern=function(a,d,c,e){ha(e)||(e=pa);return(new N(function(g){function l(){var a=arguments[0];if(V(c)&&(a=b(c).apply(null,arguments),a===K))return g.onError(a.e);g.onNext(a)}var e=a(l);return la(function(){V(d)&&d(l,e)})})).publish().refCount()},fc=function(a){function b(b){this.p=b;a.call(this)}G(b,a);b.prototype.subscribeCore=
function(a){this.p.then(function(b){a.onNext(b);a.onCompleted()},function(b){a.onError(b)});return oa};return b}(ba),na=L.fromPromise=function(a){return new fc(a)};A.toPromise=function(a){a||(a=t.config.Promise);if(!a)throw new ga("Promise type not provided nor in Rx.config.Promise");var b=this;return new a(function(a,d){var c,g=!1;b.subscribe(function(a){c=a;g=!0},d,function(){g&&a(c)})})};L.startAsync=function(a){try{var b=a()}catch(v){return db(v)}return na(b)};A.multicast=function(a,b){var d=
this;return"function"===typeof a?new N(function(c){var g=d.multicast(a());return new Y(b(g).subscribe(c),g.connect())},d):new gc(d,a)};A.publish=function(a){return a&&V(a)?this.multicast(function(){return new Da},a):this.multicast(new Da)};A.share=function(){return this.publish().refCount()};A.publishLast=function(a){return a&&V(a)?this.multicast(function(){return new Ta},a):this.multicast(new Ta)};A.publishValue=function(a,b){return 2===arguments.length?this.multicast(function(){return new nb(b)},
a):this.multicast(new nb(a))};A.shareValue=function(a){return this.publishValue(a).refCount()};A.replay=function(a,b,d,c){return a&&V(a)?this.multicast(function(){return new ob(b,d,c)},a):this.multicast(new ob(b,d,c))};A.shareReplay=function(a,b,d){return this.replay(null,a,b,d).refCount()};var gc=t.ConnectableObservable=function(a){function b(b,d){var c=!1,g,e=b.asObservable();this.connect=function(){c||(c=!0,g=new Y(e.subscribe(d),la(function(){c=!1})));return g};a.call(this,function(a){return d.subscribe(a)})}
G(b,a);b.prototype.refCount=function(){var a,b=0,d=this;return new N(function(c){var g=1===++b,e=d.subscribe(c);g&&(a=d.connect());return function(){e.dispose();0===--b&&a.dispose()}})};return b}(L),hc=L.interval=function(a,b){return da(a,a,ha(b)?b:Ba)};L.timer=function(a,b,d){var c;ha(d)||(d=Ba);null!=b&&"number"===typeof b?c=b:ha(b)&&(d=b);return a instanceof Date&&void 0===c?ca(a.getTime(),d):a instanceof Date&&void 0!==c?ea(a.getTime(),b,d):void 0===c?fa(a,d):da(a,c,d)};A.delay=function(a,b){ha(b)||
(b=Ba);return a instanceof Date?Z(this,a.getTime(),b):U(this,a,b)};A.debounce=function(a,b){ha(b)||(b=Ba);var d=this;return new N(function(c){var g=new qa,e=!1,l,t=0,f=d.subscribe(function(d){e=!0;l=d;t++;var f=t;d=new Q;g.setDisposable(d);d.setDisposable(b.scheduleWithRelative(a,function(){e&&t===f&&c.onNext(l);e=!1}))},function(a){g.dispose();c.onError(a);e=!1;t++},function(){g.dispose();e&&c.onNext(l);c.onCompleted();e=!1;t++});return new Y(f,g)},this)};A.throttle=function(a,b){return this.debounce(a,
b)};A.timestamp=function(a){ha(a)||(a=Ba);return this.map(function(b){return{value:b,timestamp:a.now()}})};A.sample=A.throttleLatest=function(a,b){ha(b)||(b=Ba);return"number"===typeof a?aa(this,hc(a,b)):aa(this,a)};A.timeout=function(a,b,d){null!=b&&"string"!==typeof b||(b=db(Error(b||"Timeout")));ha(d)||(d=Ba);var c=this,g=a instanceof Date?"scheduleWithAbsolute":"scheduleWithRelative";return new N(function(e){function l(){var c=t;m.setDisposable(d[g](a,function(){t===c&&(ja(b)&&(b=na(b)),k.setDisposable(b.subscribe(e)))}))}
var t=0,f=new Q,k=new qa,m=new qa;k.setDisposable(f);l();f.setDisposable(c.subscribe(function(a){t++;e.onNext(a);l()},function(a){t++;e.onError(a)},function(){t++;e.onCompleted()}));return new Y(k,m)},c)};A.throttleFirst=function(a,b){ha(b)||(b=Ba);var d=+a||0;if(0>=d)throw new RangeError("windowDuration cannot be less or equal zero.");var c=this;return new N(function(a){var g=0;return c.subscribe(function(c){var e=b.now();if(0===g||e-g>=d)g=e,a.onNext(c)},function(b){a.onError(b)},function(){a.onCompleted()})},
c)};var ic=function(a){function b(a){var b=this.source.publish();a=b.subscribe(a);var d=oa,c=this.pauser.distinctUntilChanged().subscribe(function(a){a?d=b.connect():(d.dispose(),d=oa)});return new Y(a,d,c)}function d(d,c){this.source=d;this.controller=new Da;this.pauser=c&&c.subscribe?this.controller.merge(c):this.controller;a.call(this,b,d)}G(d,a);d.prototype.pause=function(){this.controller.onNext(!1)};d.prototype.resume=function(){this.controller.onNext(!0)};return d}(L);A.pausable=function(a){return new ic(this,
a)};var jc=function(a){function b(a){function b(){for(;0<d.length;)a.onNext(d.shift())}var d=[],c;return ka(this.source,this.pauser.startWith(!1).distinctUntilChanged(),function(a,b){return{data:a,shouldFire:b}}).subscribe(function(g){if(void 0!==c&&g.shouldFire!=c)(c=g.shouldFire)&&b();else if(c=g.shouldFire)a.onNext(g.data);else d.push(g.data)},function(d){b();a.onError(d)},function(){b();a.onCompleted()})}function d(d,c){this.source=d;this.controller=new Da;this.pauser=c&&c.subscribe?this.controller.merge(c):
this.controller;a.call(this,b,d)}G(d,a);d.prototype.pause=function(){this.controller.onNext(!1)};d.prototype.resume=function(){this.controller.onNext(!0)};return d}(L);A.pausableBuffered=function(a){return new jc(this,a)};var lc=function(a){function b(a){return this.source.subscribe(a)}function d(d,c,g){a.call(this,b,d);this.subject=new kc(c,g);this.source=d.multicast(this.subject).refCount()}G(d,a);d.prototype.request=function(a){return this.subject.request(null==a?-1:a)};return d}(L),kc=function(a){function b(a){return this.subject.subscribe(a)}
function d(d,c){null==d&&(d=!0);a.call(this,b);this.subject=new Da;this.queue=(this.enableQueue=d)?[]:null;this.requestedCount=0;this.error=this.requestedDisposable=null;this.hasCompleted=this.hasFailed=!1;this.scheduler=c||sa}G(d,a);Ha(d.prototype,Ca,{onCompleted:function(){this.hasCompleted=!0;this.enableQueue&&0!==this.queue.length?this.queue.push(ya.createOnCompleted()):(this.subject.onCompleted(),this.disposeCurrentRequest())},onError:function(a){this.hasFailed=!0;this.error=a;this.enableQueue&&
0!==this.queue.length?this.queue.push(ya.createOnError(a)):(this.subject.onError(a),this.disposeCurrentRequest())},onNext:function(a){0>=this.requestedCount?this.enableQueue&&this.queue.push(ya.createOnNext(a)):(0===this.requestedCount--&&this.disposeCurrentRequest(),this.subject.onNext(a))},_processRequest:function(a){if(this.enableQueue)for(;0<this.queue.length&&(0<a||"N"!==this.queue[0].kind);){var b=this.queue.shift();b.accept(this.subject);"N"===b.kind?a--:(this.disposeCurrentRequest(),this.queue=
[])}return a},request:function(a){this.disposeCurrentRequest();var b=this;return this.requestedDisposable=this.scheduler.scheduleWithState(a,function(a,d){a=b._processRequest(d);if(!b.hasCompleted&&!b.hasFailed&&0<a)return b.requestedCount=a,la(function(){b.requestedCount=0})})},disposeCurrentRequest:function(){this.requestedDisposable&&(this.requestedDisposable.dispose(),this.requestedDisposable=null)}});return d}(L);A.controlled=function(a,b){a&&ha(a)&&(b=a,a=!0);null==a&&(a=!0);return new lc(this,
a,b)};A.pipe=function(a){function b(){d.resume()}var d=this.pausableBuffered();a.addListener("drain",b);d.subscribe(function(b){!a.write(String(b))&&d.pause()},function(b){a.emit("error",b)},function(){!a._isStdio&&a.end();a.removeListener("drain",b)});d.resume();return a};var N=t.AnonymousObservable=function(a){function d(a){return a&&V(a.dispose)?a:V(a)?la(a):oa}function c(a,c){a=c[0];c=c[1];c=b(c.__subscribe).call(c,a);if(c===K&&!a.fail(K.e))return p(K.e);a.setDisposable(d(c))}function e(a){a=
new hb(a);var b=[a,this];sa.scheduleRequired()?sa.scheduleWithState(b,c):c(null,b);return a}function t(b,d){this.source=d;this.__subscribe=b;a.call(this,e)}G(t,a);return t}(L),hb=function(a){function d(b){a.call(this);this.observer=b;this.m=new Q}G(d,a);var c=d.prototype;c.next=function(a){a=b(this.observer.onNext).call(this.observer,a);a===K&&(this.dispose(),p(a.e))};c.error=function(a){a=b(this.observer.onError).call(this.observer,a);this.dispose();a===K&&p(a.e)};c.completed=function(){var a=b(this.observer.onCompleted).call(this.observer);
this.dispose();a===K&&p(a.e)};c.setDisposable=function(a){this.m.setDisposable(a)};c.getDisposable=function(){return this.m.getDisposable()};c.dispose=function(){a.prototype.dispose.call(this);this.m.dispose()};return d}(Pa),Ua=function(a,b){this.subject=a;this.observer=b};Ua.prototype.dispose=function(){if(!this.subject.isDisposed&&null!==this.observer){var a=this.subject.observers.indexOf(this.observer);this.subject.observers.splice(a,1);this.observer=null}};var Da=t.Subject=function(a){function b(a){ia(this);
if(!this.isStopped)return this.observers.push(a),new Ua(this,a);if(this.hasError)return a.onError(this.error),oa;a.onCompleted();return oa}function d(){a.call(this,b);this.isStopped=this.isDisposed=!1;this.observers=[];this.hasError=!1}G(d,a);Ha(d.prototype,Ca.prototype,{hasObservers:function(){return 0<this.observers.length},onCompleted:function(){ia(this);if(!this.isStopped){this.isStopped=!0;for(var a=0,b=f(this.observers),d=b.length;a<d;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){ia(this);
if(!this.isStopped){this.isStopped=!0;this.error=a;this.hasError=!0;for(var b=0,d=f(this.observers),c=d.length;b<c;b++)d[b].onError(a);this.observers.length=0}},onNext:function(a){ia(this);if(!this.isStopped)for(var b=0,d=f(this.observers),c=d.length;b<c;b++)d[b].onNext(a)},dispose:function(){this.isDisposed=!0;this.observers=null}});d.create=function(a,b){return new mc(a,b)};return d}(L),Ta=t.AsyncSubject=function(a){function b(a){ia(this);if(!this.isStopped)return this.observers.push(a),new Ua(this,
a);if(this.hasError)a.onError(this.error);else{if(this.hasValue)a.onNext(this.value);a.onCompleted()}return oa}function d(){a.call(this,b);this.hasValue=this.isStopped=this.isDisposed=!1;this.observers=[];this.hasError=!1}G(d,a);Ha(d.prototype,Ca,{hasObservers:function(){ia(this);return 0<this.observers.length},onCompleted:function(){var a;ia(this);if(!this.isStopped){this.isStopped=!0;var b=f(this.observers);var d=b.length;if(this.hasValue)for(a=0;a<d;a++){var c=b[a];c.onNext(this.value);c.onCompleted()}else for(a=
0;a<d;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){ia(this);if(!this.isStopped){this.hasError=this.isStopped=!0;this.error=a;for(var b=0,d=f(this.observers),c=d.length;b<c;b++)d[b].onError(a);this.observers.length=0}},onNext:function(a){ia(this);this.isStopped||(this.value=a,this.hasValue=!0)},dispose:function(){this.isDisposed=!0;this.value=this.exception=this.observers=null}});return d}(L),mc=t.AnonymousSubject=function(a){function b(a){return this.observable.subscribe(a)}
function d(d,c){this.observer=d;this.observable=c;a.call(this,b)}G(d,a);Ha(d.prototype,Ca.prototype,{onCompleted:function(){this.observer.onCompleted()},onError:function(a){this.observer.onError(a)},onNext:function(a){this.observer.onNext(a)}});return d}(L),nb=t.BehaviorSubject=function(a){function b(a){ia(this);if(!this.isStopped)return this.observers.push(a),a.onNext(this.value),new Ua(this,a);if(this.hasError)a.onError(this.error);else a.onCompleted();return oa}function d(d){a.call(this,b);this.value=
d;this.observers=[];this.hasError=this.isStopped=this.isDisposed=!1}G(d,a);Ha(d.prototype,Ca,{getValue:function(){ia(this);if(this.hasError)throw this.error;return this.value},hasObservers:function(){return 0<this.observers.length},onCompleted:function(){ia(this);if(!this.isStopped){this.isStopped=!0;for(var a=0,b=f(this.observers),d=b.length;a<d;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){ia(this);if(!this.isStopped){this.hasError=this.isStopped=!0;this.error=a;for(var b=
0,d=f(this.observers),c=d.length;b<c;b++)d[b].onError(a);this.observers.length=0}},onNext:function(a){ia(this);if(!this.isStopped){this.value=a;for(var b=0,d=f(this.observers),c=d.length;b<c;b++)d[b].onNext(a)}},dispose:function(){this.isDisposed=!0;this.exception=this.value=this.observers=null}});return d}(L),ob=t.ReplaySubject=function(a){function b(a,b){return la(function(){b.dispose();!a.isDisposed&&a.observers.splice(a.observers.indexOf(b),1)})}function d(a){a=new wb(this.scheduler,a);var d=
b(this,a);ia(this);this._trim(this.scheduler.now());this.observers.push(a);for(var c=0,g=this.q.length;c<g;c++)a.onNext(this.q[c].value);if(this.hasError)a.onError(this.error);else if(this.isStopped)a.onCompleted();a.ensureActive();return d}function c(b,c,g){this.bufferSize=null==b?e:b;this.windowSize=null==c?e:c;this.scheduler=g||sa;this.q=[];this.observers=[];this.hasError=this.isDisposed=this.isStopped=!1;this.error=null;a.call(this,d)}var e=Math.pow(2,53)-1;G(c,a);Ha(c.prototype,Ca.prototype,
{hasObservers:function(){return 0<this.observers.length},_trim:function(a){for(;this.q.length>this.bufferSize;)this.q.shift();for(;0<this.q.length&&a-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(a){ia(this);if(!this.isStopped){var b=this.scheduler.now();this.q.push({interval:b,value:a});this._trim(b);for(var b=0,d=f(this.observers),c=d.length;b<c;b++){var g=d[b];g.onNext(a);g.ensureActive()}}},onError:function(a){ia(this);if(!this.isStopped){this.isStopped=!0;this.error=a;this.hasError=
!0;var b=this.scheduler.now();this._trim(b);for(var b=0,d=f(this.observers),c=d.length;b<c;b++){var g=d[b];g.onError(a);g.ensureActive()}this.observers.length=0}},onCompleted:function(){ia(this);if(!this.isStopped){this.isStopped=!0;var a=this.scheduler.now();this._trim(a);for(var a=0,b=f(this.observers),d=b.length;a<d;a++){var c=b[a];c.onCompleted();c.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0;this.observers=null}});return c}(L);t.Pauser=function(a){function b(){a.call(this)}
G(b,a);b.prototype.pause=function(){this.onNext(!1)};b.prototype.resume=function(){this.onNext(!0)};return b}(Da);r.exports=t}).call(h,function(){return this}(),c(15))},function(r,h,c){(function(n){function h(a,b,c){var d=3>=arguments.length||void 0===arguments[3]?null:arguments[3];this.name="RequestError";this.url=a;this.xhr=b;this.code=b.status;this.reason=d;this.message="request: "+c+" ("+a+")";Error.captureStackTrace&&Error.captureStackTrace(this,h)}function f(a,b){var d=b.code,c=b.method;b=b.message;
this.name="RestCallMethodError";this.url=a;this.code=d;this.message="restmethodcall: webservice error status "+d+" ("+a+")"+(c?" ("+c+")":"")+(b?"\n"+b:"");Error.captureStackTrace&&Error.captureStackTrace(this,f)}function a(a,b,c){a=a.querySelector("RestCallResult");var d=+a.querySelector("Status").textContent;if(0>d)throw new f(b,{code:d,method:c});return{output:a.querySelector("Output"),status:d}}function b(a){return"rest-call-method"==a.format?k(a):w.create(function(b){function d(a){var d=a.target,
c=d.status;if(200>c||300<=c)return b.onError(new h(e,d,d.statusText));var c=Date.now()-C;var f="document"==m?(new n.DOMParser).parseFromString(d.responseText,"text/xml"):d.response;if("json"==m&&"string"==typeof f)try{f=JSON.parse(f)}catch(Z){f=null}if(null==f)return b.onError(new h(e,d,'null response with format "'+m+'" (error while parsing or wrong content-type)'));if(p){if(w){var k=w;for(var u={},D,q=0;q<k.length;q++)D=k[q],u[D]=d.getResponseHeader(D);k=u}b.onNext({blob:f,size:a.total,duration:c,
headers:k,url:d.responseURL||e,xhr:d})}else b.onNext(f);b.onCompleted()}function c(a){b.onError(new h(e,a,"error event"))}var e=a.url,f=a.data,k=a.headers,m=a.format,p=a.withMetadata,w=a.responseHeaders,u=new XMLHttpRequest;u.open(a.method||"GET",e,!0);u.responseType="document"==m?"text":m||"text";if(k)for(var q in k)u.setRequestHeader(q,k[q]);u.addEventListener("load",d,!1);u.addEventListener("error",c,!1);var C=Date.now();u.send(f);return function(){var a=u.readyState;0<a&&4>a&&(u.removeEventListener("load",
d),u.removeEventListener("error",c),u.abort());u=null}})}function p(a){return(a||"").toString().replace(u,function(a){return m[a]})}function x(a){var b="",c;for(c in a)var e=a[c],e="object"==typeof e?x(e):p(e),b=b+("<"+c+">"+e+"</"+c+">");return b}function k(c){c.method="POST";c.headers={"Content-Type":"application/xml"};c.data=C.replace("{payload}",x(c.data));c.format="document";return b(c).map(function(b){return a(b,c.url,c.ScriptInfo)})}var w=c(3).Observable;h.prototype=Error();f.prototype=Error();
var u=/[&<>]/g,m={"&":"&amp;","<":"&lt;",">":"&gt;"},C='<RestCallMethod xmlns:i="http://www.w3.org/2001/XMLSchema-instance">{payload}</RestCallMethod>';b.escapeXml=p;b.RequestError=h;b.RestCallMethodError=f;b.RestCallResult=a;b.getNodeTextContent=function(a,b){return(a=a.querySelector(b))&&a.textContent};r.exports=b}).call(h,function(){return this}())},function(r,h){function c(){throw Error("setTimeout has not been defined");}function n(){throw Error("clearTimeout has not been defined");}function q(a){if(k===
setTimeout)return setTimeout(a,0);if((k===c||!k)&&setTimeout)return k=setTimeout,setTimeout(a,0);try{return k(a,0)}catch(B){try{return k.call(null,a,0)}catch(J){return k.call(this,a,0)}}}function f(a){if(w===clearTimeout)return clearTimeout(a);if((w===n||!w)&&clearTimeout)return w=clearTimeout,clearTimeout(a);try{return w(a)}catch(B){try{return w.call(null,a)}catch(J){return w.call(this,a)}}}function a(){m&&C&&(m=!1,C.length?u=C.concat(u):e=-1,u.length&&b())}function b(){if(!m){var b=q(a);m=!0;for(var c=
u.length;c;){C=u;for(u=[];++e<c;)C&&C[e].run();e=-1;c=u.length}C=null;m=!1;f(b)}}function p(a,b){this.fun=a;this.array=b}function x(){}r=r.exports={};try{var k="function"===typeof setTimeout?setTimeout:c}catch(d){k=c}try{var w="function"===typeof clearTimeout?clearTimeout:n}catch(d){w=n}var u=[],m=!1,C,e=-1;r.nextTick=function(a){var d=Array(arguments.length-1);if(1<arguments.length)for(var c=1;c<arguments.length;c++)d[c-1]=arguments[c];u.push(new p(a,d));1!==u.length||m||q(b)};p.prototype.run=function(){this.fun.apply(null,
this.array)};r.title="browser";r.browser=!0;r.env={};r.argv=[];r.version="";r.versions={};r.on=x;r.addListener=x;r.once=x;r.off=x;r.removeListener=x;r.removeAllListeners=x;r.emit=x;r.prependListener=x;r.prependOnceListener=x;r.listeners=function(a){return[]};r.binding=function(a){throw Error("process.binding is not supported");};r.cwd=function(){return"/"};r.chdir=function(a){throw Error("process.chdir is not supported");};r.umask=function(){return 0}},function(r,h,c){function n(a,b){if(!(a instanceof
b))throw new TypeError("Cannot call a class as a function");}function q(a){if("number"==typeof a)return a;for(var b=0,d,c=0;c<a.length;c++)d=a[c],b=(b<<5)-b+d,b&=b;return b}function f(a){if(!ka||!Z||Z.alwaysRenew)return null;var b=aa;return(a=e.find(a,function(a){return a.type!==ka.type||a.persistentLicense&&"required"!=b.persistentState||a.distinctiveIdentifierRequired&&"required"!=b.distinctiveIdentifier?!1:!0}))?{keySystem:a,keySystemAccess:new R(ka,Z,aa)}:null}function a(a){var b=["temporary"],
d="optional",c="optional";a.persistentLicense&&(d="required",b.push("persistent-license"));a.persistentStateRequired&&(d="required");a.distinctiveIdentifierRequired&&(c="required");return{videoCapabilities:void 0,audioCapabilities:void 0,initDataTypes:["cenc"],distinctiveIdentifier:c,persistentState:d,sessionTypes:b}}function b(b){var c=f(b);if(c)return d.debug("eme: found compatible keySystem quickly",c),D(c);var t=e.flatten(b,function(a){return e.map(ea[a.type],function(b){return{keyType:b,keySystem:a}})});
return M.create(function(b){function c(f){if(!e)if(f>=t.length)b.onError(Error("eme: could not find a compatible key system"));else{var k=t[f],m=k.keyType,F=k.keySystem,p=[a(F)];d.debug("eme: request keysystem access "+m+","+(f+1+" of "+t.length),p);S(m,p).then(function(a){d.info("eme: found compatible keysystem",m,p);b.onNext({keySystem:F,keySystemAccess:a});b.onCompleted()},function(){d.debug("eme: rejected access to keysystem",m,p);c(f+1)})}}var e=!1;c(0);(function(){return e=!0})})}function p(a,
b,c){var e=F,f=Z;return z(c.createMediaKeys().then(function(t){Z=t;aa=c.getConfiguration();ka=b;F=a;if(a.mediaKeys===t)return Promise.resolve(t);f&&f!==Z&&U.dispose();if(e&&e!==F)return d.debug("eme: unlink old video element and set mediakeys"),T(e,null).then(function(){return T(F,t)}).then(function(){return t});d.debug("eme: set mediakeys");return T(F,t).then(function(){return t})}))}function x(a,b){a=a.createSession(b);a.sessionType=b;return a}function k(a,b,c){d.debug("eme: generate request",b,
c);return z(a.generateRequest(b,c).then(function(){return a}))}function w(a,b){d.debug("eme: load persisted session",b);return z(a.load(b).then(function(b){return{success:b,session:a}}))}function u(a,b){var c=Error(a);b&&(c.reason=b);d.error(a,b);throw c;}function m(a){return e.isPromise(a)?z(a):e.isObservable(a)?a:D(a)}function C(a,c){function e(b,c){var e=c.keySystem;c=c.keySystemAccess;e.persistentLicense&&da.setStorage(e.licenseStorage);var k=new Uint8Array(b.initData),t=b.initDataType,m=c.getConfiguration();
d.info("eme: encrypted event",b);return p(a,e,c).flatMap(function(a){return f(a,m,e,t,k).tap(function(a){da.add(k,a);U.add(k,a)},function(a){d.error("eme: error during session management handler",a)})}).flatMap(function(a){return n(a,e).tapOnError(function(b){d.error("eme: error in session messages handler",a,b);da["delete"](k);U.deleteAndClose(a.sessionId)})})}function f(a,b,c,e,f){var k=U.get(f);if(k)return d.debug("eme: reuse loaded session",k.sessionId),D(k);b=(k=0<=b.sessionTypes.indexOf("persistent-license"))&&
c.persistentLicense?"persistent-license":"temporary";return k&&c.persistentLicense&&(c=da.get(f))?F(a,c,e,f):t(a,b,e,f)}function t(a,b,c,e){d.debug("eme: create a new "+b+" session");var f=x(a,b);return k(f,c,e)["catch"](function(f){var t=U.getFirst();if(!t)throw f;d.warn("eme: could not create a new session, retry after closing a currently loaded session",f);return M.from(t.close()).flatMap(function(){return k(x(a,b),c,e)})})}function F(a,b,c,e){d.debug("eme: create a new persistent-license session");
var f=x(a,"persistent-license");return w(f,b)["catch"](function(f){d.warn("eme: failed to load persisted session, do fallback",b,f);da["delete"](e);U["delete"](b);return t(a,"persistent-license",c,e).map(function(a){return{success:!0,session:a}})}).flatMap(function(f){var k=f.session;if(f.success)return d.debug("eme: successfully loaded session"),D(k);d.warn("eme: no data stored for the loaded session, removing it",b);da["delete"](e);U["delete"](b);k.remove()["catch"](function(a){return d.warn("eme: could not remove session",
a)});f=t(a,"persistent-license",c,e);return E(f,D(k))})}function n(a,b){d.debug("eme: handle message events for session",a.sessionId);var c=void 0,e=X(a).map(function(a){return u("eme: keyerror event "+a.errorCode+" / "+a.systemCode,a)}),f=ca(a).flatMap(function(e){c=e.sessionId;d.debug("eme: keystatuseschange event",c,a,e);for(var f=a.keyStatuses.values(),k=f.next();!k.done;k=f.next())(k=fa[k.value])&&u(k);if(!b.onKeyStatusesChange)return d.warn("eme: keystatuseschange event not handled"),W();f=
void 0;try{f=b.onKeyStatusesChange(e,a)}catch(va){f=M["throw"](va)}return m(f)["catch"](function(a){return u("eme: onKeyStatusesChange has failed "+("(reason:"+(a&&a.message||"unknown")+")"),a)})}),k=H(a).flatMap(function(e){c=e.sessionId;var f=new Uint8Array(e.message),k=e.messageType||"license-request";d.debug("eme: event message type "+k,a,e);e=void 0;try{e=b.getLicense(f,k)}catch(va){e=M["throw"](va)}return m(e)["catch"](function(a){return u("eme: getLicense has failed "+("(reason: "+(a&&a.message||
"unknown")+")"),a)})}),f=E(k,f).concatMap(function(b){d.debug("eme: update session",c,b);return a.update(b,c)["catch"](function(a){return u("eme: error on session update "+c,a)})}).map(function(){return{type:"eme",value:{session:a,name:"session-updated"}}});return E(f,e)}return I(P(a),b(c),function(a,b){return[a,b]}).take(1).flatMap(function(a){return e(a[0],a[1])})}var e=c(1),d=c(4),B=c(6),J=c(2),M=c(3).Observable,I=M.combineLatest,W=M.empty,z=M.fromPromise,E=M.merge,D=M.just;h=c(8);var R=h.KeySystemAccess,
S=h.requestMediaKeySystemAccess,T=h.setMediaKeys;h=h.emeEvents;var P=h.onEncrypted,H=h.onKeyMessage,X=h.onKeyError,ca=h.onKeyStatusesChange,ea={clearkey:["webkit-org.w3.clearkey","org.w3.clearkey"],widevine:["com.widevine.alpha"],playready:["com.youtube.playready","com.microsoft.playready"]},fa={"output-not-allowed":"eme: the required output protection is not available.",expired:"eme: a required key has expired and the content cannot be decrypted.","internal-error":"eme: an unknown error has occurred in the CDM."};
h=function(){function a(){n(this,a);this._entries=[]}a.prototype.getFirst=function(){if(0<this._entries.length)return this._entries[0].session};a.prototype.get=function(a){a=q(a);var b=e.find(this._entries,function(b){return b.initData===a});if(b)return b.session};a.prototype.add=function(a,b){var c=this;a=q(a);if(!this.get(a)){var e=function(){if(!b.sessionId)return{v:void 0};var e={session:b,initData:a};d.debug("eme-mem-store: add session",e);c._entries.push(e);b.closed.then(function(){d.debug("eme-mem-store: remove closed session",
e);var a=c._entries.indexOf(e);0<=a&&c._entries.splice(a,1)})}();if("object"===typeof e)return e.v}};a.prototype["delete"]=function(a){var b=e.find(this._entries,function(b){return b.session.sessionId===a});if(b){d.debug("eme-mem-store: delete session",a);var c=this._entries.indexOf(b);this._entries.splice(c,1);return b.session}};a.prototype.deleteAndClose=function(a){var b=this["delete"](a);return b?(d.debug("eme-mem-store: close session",a),b.close()):B.resolve()};a.prototype.dispose=function(){var a=
this._entries.map(function(a){return a.session.close()});this._entires=[];return B.all(a)};return a}();var da=new (function(){function a(b){n(this,a);this.setStorage(b)}a.prototype.setStorage=function(a){if(this._storage!==a){J(a,"eme: no licenseStorage given for keySystem with persistentLicense");J.iface(a,"licenseStorage",{save:"function",load:"function"});this._storage=a;try{this._entries=this._storage.load(),J(Array.isArray(this._entries))}catch(ma){d.warn("eme-persitent-store: could not get entries from license storage",
ma),this.dispose()}}};a.prototype.get=function(a){a=q(a);var b=e.find(this._entries,function(b){return b.initData===a});if(b)return b.sessionId};a.prototype.add=function(a,b){a=q(a);if("persistent-license"==b.sessionType&&!this.get(a)){var c=b.sessionId;c&&(d.info("eme-persitent-store: add new session",c,b),this._entries.push({sessionId:c,initData:a}),this._save())}};a.prototype["delete"]=function(a){a=q(a);var b=e.find(this._entries,function(b){return b.initData===a});b&&(d.warn("eme-persitent-store: delete session from store",
b),b=this._entries.indexOf(b),this._entries.splice(b,1),this._save())};a.prototype.dispose=function(){this._entries=[];this._save()};a.prototype._save=function(){try{this._storage.save(this._entries)}catch(O){d.warn("eme-persitent-store: could not save licenses in localStorage")}};return a}())({load:function(){return[]},save:function(){}}),U=new h,Z=void 0,aa=void 0,ka=void 0,F=void 0;C.onEncrypted=P;C.getCurrentKeySystem=function(){return ka&&ka.type};C.dispose=function(){ka=Z=null;U.dispose()};
r.exports=C},function(r,h,c){function n(a){this.name="OutOfIndexError";this.type=a;this.message="out of range in index "+a}function q(c){switch(c.indexType){case "template":return a;case "timeline":return b;case "list":return p;case "base":return x;default:throw Error("index-handler: unrecognized indexType "+c.indexType);}}c(2);var f=c(12).getAdaptationsByType,a=c(31),b=c(18),p=c(30),x=c(29);n.prototype=Error();h=function(){function a(b,c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
this.adaptation=b;this.representation=c;this.index=c.index;this.handler=new (q(this.index))(this.index)}a.prototype.getInitSegment=function(){var a=this.index.initialization||{};return{id:"init_"+this.adaptation.id+"_"+this.representation.id,init:!0,media:a.media,range:a.range,indexRange:this.index.indexRange}};a.prototype.normalizeRange=function(a,b,c){var f=this.index.presentationTimeOffset||0,e=this.index.timescale||1;b||(b=0);c||(c=0);b=Math.min(b,c);return{time:a*e-f,up:(a+b)*e-f,to:(a+c)*e-
f}};a.prototype.getSegments=function(a,b,c){a=this.normalizeRange(a,b,c);b=a.up;c=a.to;if(!this.handler.checkRange(a.time))throw new n(this.index.indexType);return this.handler.getSegments(b,c)};a.prototype.insertNewSegments=function(a,b){for(var c=[],f=0;f<a.length;f++)this.handler.addSegment(a[f],b)&&c.push(a[f]);return c};a.prototype.setTimescale=function(a){var b=this.index;return b.timescale!==a?(b.timescale=a,!0):!1};a.prototype.scale=function(a){return a/this.index.timescale};return a}();r.exports=
{OutOfIndexError:n,IndexHandler:h,getLiveEdge:function(a){var b=f(a,"video")[0].representations[0].index;return q(b).getLiveEdge(b,a)}}},function(r,h,c){function n(c){var a=c.ts,b=c.d;c=c.r;return-1===b?a:a+(c+1)*b}var q=c(1);h=function(){function c(a){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.index=a;this.timeline=a.timeline}c.getLiveEdge=function(a,b){b=n(q.last(a.timeline))/a.timescale-b.suggestedPresentationDelay;return Math.max(a.timeline[0].ts/a.timescale+
1,b)};c.prototype.createSegment=function(a,b,c){return{id:a,media:this.index.media,time:a,number:void 0,range:b,duration:c}};c.prototype.calculateRepeat=function(a,b){var c=a.r||0;0>c&&(c=Math.ceil(((b?b.t:Infinity)-a.ts)/a.d)-1);return c};c.prototype.checkRange=function(a){var b=q.last(this.timeline);if(!b)return!0;0>b.d&&(b={ts:b.ts,d:0,r:b.r});return a<=n(b)};c.prototype.getSegmentIndex=function(a){for(var b=this.timeline,c=0,f=b.length;c<f;){var k=c+f>>>1;b[k].ts<a?c=k+1:f=k}return 0<c?c-1:c};
c.prototype.getSegmentNumber=function(a,b,c){a=b-a;return 0<a?Math.floor(a/c):0};c.prototype.getSegments=function(a,b){var c=this.index.timeline,f=[],k=c.length,n=this.getSegmentIndex(a)-1,h=c.length&&c[0].d||0;a:for(;!(++n>=k);){var m=c[n],q=m.d,e=m.ts,d=m.range,h=Math.max(h,q);if(0>q){e+h<b&&f.push(this.createSegment(e,d,void 0));break}for(var m=this.calculateRepeat(m,c[n+1]),B=this.getSegmentNumber(e,a,q),r;(r=e+B*q)<b;)if(B++<=m)f.push(this.createSegment(r,d,q));else continue a;break}return f};
c.prototype.addSegment=function(a,b){var c=this.timeline,f=c.length,k=c[f-1];if(b&&a.ts===b.ts){a=a.ts+a.d;b=a-(k.ts+k.d*k.r);if(0>=b)return!1;-1===k.d&&((f=c[f-2])&&f.d===b?(f.r++,c.pop()):k.d=b);c.push({d:-1,ts:a,r:0});return!0}return a.ts>=n(k)?(k.d===a.d?k.r++:c.push({d:a.d,ts:a.ts,r:0}),!0):!1};return c}();r.exports=h},function(r,h,c){function n(a,b){var c=a.playbackRate,n=a.duration,k=a.currentTime,h=a.readyState;a=new f(a.buffered);var u=a.getRange(k),m=a.getGap(k);return{name:b,ts:k,range:u,
gap:m,duration:n,playback:c,readyState:h,stalled:null,buffered:a}}var q=c(3).Observable,f=c(9).BufferedRanges;r.exports={getEmptyTimings:function(){return{name:"timeupdate",ts:0,range:null,gap:Infinity,duration:0,playback:1,readyState:0,stalled:!1,buffered:new f}},getTimings:n,timingsSampler:function(a){return q.create(function(b){function c(c){var k=f,m=c&&c.type||"timeupdate";c=n(a,m);var k=k.stalled,h=c.gap;(m="loadedmetadata"==m||k)||(m=(m=c.range)?.5>=c.duration-(h+m.end):!1);c.stalled=m||!(.5>=
h||Infinity===h)?k&&Infinity>h&&h>("seeking"==k.name?.5:5)?null:k:{name:c.name,playback:c.playback};f=c;b.onNext(f)}var f=n(a,"init"),k=setInterval(c,1E3);a.addEventListener("play",c);a.addEventListener("progress",c);a.addEventListener("seeking",c);a.addEventListener("seeked",c);a.addEventListener("loadedmetadata",c);b.onNext(f);return function(){clearInterval(k);a.removeEventListener("play",c);a.removeEventListener("progress",c);a.removeEventListener("seeking",c);a.removeEventListener("seeked",c);
a.removeEventListener("loadedmetadata",c)}}).shareValue({name:"init",stalled:null})},seekingsSampler:function(a){return a.filter(function(a){return"seeking"==a.name&&(Infinity===a.gap||-2>a.gap)}).skip(1).startWith(!0)},getLiveGap:function(a,b){if(!b.isLive)return Infinity;var c=b.availabilityStartTime;b=b.presentationLiveGap;return Date.now()/1E3-a-(c+b+10)},toWallClockTime:function(a,b){return new Date(1E3*(a+b.availabilityStartTime))},fromWallClockTime:function(a,b){var c=b.suggestedPresentationDelay,
f=b.presentationLiveGap,k=b.timeShiftBufferDepth;"number"!=typeof a&&(a=a.getTime());var n=Date.now();return Math.max(Math.min(a,n-1E3*(f+c)),n-1E3*k)/1E3-b.availabilityStartTime}}},function(r,h){function c(c){return c*(1+.3*(2*Math.random()-1))}r.exports={getFuzzedDelay:c,getBackedoffDelay:function(n){return c(n*Math.pow(2,(1>=arguments.length||void 0===arguments[1]?1:arguments[1])-1))}}},function(r,h){r.exports=function(c,n,h){function f(){var a=p-Date.now();if(0<a)b=setTimeout(f,a);else switch(b=
null,q.length){case 0:return c();case 1:return c(q[0]);case 2:return c(q[0],q[1]);case 3:return c(q[0],q[1],q[2]);default:return c.apply(null,q)}}function a(){var c=arguments.length,m=0;for(q=Array(c);m<c;m++)q[m]=arguments[m];if(k&&!w)return w=!0,p=Date.now(),f();c=p;p=Date.now()+n;if(!b||p<c)b&&clearTimeout(b),b=setTimeout(f,n);return a}var b=null,p=0,q=[],k=!(!h||!h.leading),w=!1;a.isWaiting=function(){return!!b};a.dispose=function(){b&&(clearTimeout(b),b=null)};return a}},function(r,h){r.exports=
function(c){c.webpackPolyfill||(c.deprecate=function(){},c.paths=[],c.children=[],c.webpackPolyfill=1);return c}},function(r,h){function c(c){return function(n,f){return null==n?f:c*f+(1-c)*n}}r.exports=function(n,h){return n.map(function(c){return c.value.response}).filter(function(c){return 2E3<c.size}).map(function(c){return c.size/c.duration*8E3}).scan(c(h.alpha))}},function(r,h,c){function n(a,b){return"number"==typeof a&&0<a?a:b}function q(a,b){var d=2>=arguments.length||void 0===arguments[2]?
0:arguments[2];return p.findLast(a,function(a){return a/b<=1-d})||a[0]}function f(a,b){return(a=p.find(a,function(a){return a.width>=b}))?a.bitrate:Infinity}function a(a,b){return b?p.find(a,function(a){return a.lang===b}):null}function b(a,b){return a.filter(function(a){return a.type===b})}var p=c(1),x=c(4);h=c(3);var k=h.BehaviorSubject,w=h.CompositeDisposable,u=h.Observable.combineLatest,m=c(5).only,C=c(23),e={defaultLanguage:"fra",defaultSubtitle:"",defaultBufferSize:5,defaultBufferThreshold:.3};
r.exports=function(d,c,h){function r(b){return H.changes().map(function(d){return a(b,d)||b[0]})}function B(b){return X.changes().map(function(d){return a(b,d)})}var J=p.defaults(3>=arguments.length||void 0===arguments[3]?{}:arguments[3],e),z=J.defaultSubtitle,E=J.defaultBufferSize,D=J.defaultBufferThreshold,R=J.initVideoBitrate,S=J.initAudioBitrate,T=h.videoWidth,P=h.inBackground,H=new k(J.defaultLanguage),X=new k(z),ca={audio:C(b(d,"audio"),{alpha:.6}).publishValue(S||0),video:C(b(d,"video"),{alpha:.6}).publishValue(R||
0)},ea=new w(p.map(p.values(ca),function(a){return a.connect()})),fa={audio:new k(Infinity),video:new k(Infinity)},da={audio:new k(Infinity),video:new k(Infinity)},U={audio:new k(E),video:new k(E),text:new k(E)};return{setLanguage:function(a){H.onNext(a)},setSubtitle:function(a){X.onNext(a)},getLanguage:function(){return H.value},getSubtitle:function(){return X.value},getAverageBitrates:function(){return ca},getAudioMaxBitrate:function(){return da.audio.value},getVideoMaxBitrate:function(){return da.video.value},
getAudioBufferSize:function(){return U.audio.value},getVideoBufferSize:function(){return U.video.value},setAudioBitrate:function(a){fa.audio.onNext(n(a,Infinity))},setVideoBitrate:function(a){fa.video.onNext(n(a,Infinity))},setAudioMaxBitrate:function(a){da.audio.onNext(n(a,Infinity))},setVideoMaxBitrate:function(a){da.video.onNext(n(a,Infinity))},setAudioBufferSize:function(a){U.audio.onNext(n(a,E))},setVideoBufferSize:function(a){U.video.onNext(n(a,E))},getBufferAdapters:function(a){var b=a.type,
d=a.bitrates,c=a.representations;a=c[0];if(1<c.length){a=fa[b];var e=da[b],n=ca[b].map(function(a,b){return q(d,a,0===b?0:D)}).changes().customDebounce(2E3,{leading:!0});"video"==b&&(e=u(e,T,P,function(a,b,e){if(e)return d[0];b=f(c,b);return b<a?b:a}));a=u(a,e,n,function(a,b,d){return Infinity>a?a:Infinity>b?Math.min(b,d):d}).map(function(a){return p.find(c,function(b){return b.bitrate===q(d,a)})}).changes(function(a){return a.id}).tap(function(a){return x.info("bitrate",b,a.bitrate)})}else a=m(a);
return{representations:a,bufferSizes:U[b]||new k(E)}},getAdaptationsChoice:function(a,b){if("audio"==a)return r(b);if("text"==a)return B(b);if(1==b.length)return m(b[0]);throw Error("adaptive: unknown type "+a+" for adaptation chooser");},dispose:function(){ea&&(ea.dispose(),ea=null)}}}},function(r,h,c){var n=c(1),q=c(4);c(2);var f=c(9).BufferedRanges;h=c(3);var a=h.Observable,b=h.Subject,p=a.combineLatest,x=a.empty,k=a.from,w=a.just,u=a.merge,m=a.timer,C=c(5).on,e=c(47).ArraySet;h=c(17);var d=h.IndexHandler,
B=h.OutOfIndexError,J=c(26);r.exports=function(a){function c(a,b){var d=a.ts,c=a.buffered;a=c.getRange(d);var c=c.getOuterRanges(d),e=[];e.push.apply(e,c);a&&(q.debug("buffer: gc removing part of inner range",e),d-b>a.start&&e.push({start:a.start,end:d-b}));return e}function h(){q.warn("buffer: running garbage collector");return T.take(1).flatMap(function(a){var b=c(a,240);0===b.length&&(b=c(a,30));q.debug("buffer: gc cleaning",b);return k(b.map(function(a){return P.removeBuffer(a)})).concatAll()})}
function r(a){function b(b){if(C.test(b.id))return!1;if(b.init||null==b.time)return!0;var d=O.scale(b.time);b=O.scale(b.duration);return(d=Z.hasRange(d,b))?1.5*d.bitrate<a.bitrate:!0}function t(b,d,c,e){var f=[];e&&(q.debug("add init segment",H),f.push(O.getInitSegment()));if(0===d.readyState)return f;e=d.ts;d=Math.max(0,Math.min(c,d.liveGap,(d.duration||Infinity)-e));b=b.getGap(e);b=b>ea&&Infinity>b?Math.min(b,fa):0;(c=Z.getRange(e))&&c.bitrate===a.bitrate&&(c=Math.floor(c.end-e),c>b&&(b=c));e=O.getSegments(e,
b,d);return f.concat(e)}var O=new d(D,a),C=new e,S=p(T,U,aa,function(a,b){return{timing:a,bufferSize:b}}).flatMap(function(a){var b=a.timing;a=a.bufferSize;var d=c({ts:b.ts,buffered:new f(E.buffered)},5);return k(d.map(function(a){return P.removeBuffer(a)})).concatAll().ignoreElements().concat(w({timing:b,bufferSize:a}))}).flatMap(function(d,c){var e=d.timing;d=d.bufferSize;var m=new f(E.buffered);X&&!Z.equals(m)&&(q.debug("intersect new buffer",H),Z.intersect(m));try{var F=t(m,e,d,0===c);F=n.filter(F,
b)}catch(K){if(K instanceof B)return ca.onNext({type:"out-of-index",value:K}),x();throw K;}return k(n.map(F,function(b){C.add(b.id);return{adaptation:D,representation:a,segment:b}}))}).concatMap(R).concatMap(function(a){var b=a.parsed.blob;return P.appendBuffer(b)["catch"](function(a){if("QuotaExceededError"==a.name)return h().flatMap(function(){return P.appendBuffer(b)});throw a;}).map(a)}).map(function(b){var d=b.parsed;C.remove(b.segment.id);var c=d.timescale;c&&O.setTimescale(c);c=d.nextSegments;
d=d.currentSegment;c=c?O.insertNewSegments(c,d):[];d&&Z.insert(a.bitrate,O.scale(d.ts),O.scale(d.ts+d.d));return{type:"segment",value:n.extend({addedSegments:c},b)}});return u(S,ca)["catch"](function(b){if(412!==b.code)throw b;return w({type:"precondition-failed",value:b}).concat(m(2E3)).concat(r(a))})}var E=a.sourceBuffer,D=a.adaptation,R=a.pipeline,S=a.adapters,T=a.timings;a=a.seekings;var P=new J(E),H=D.type,X="audio"==H||"video"==H,ca=new b,ea="video"==H?4:1,fa="video"==H?6:1,da=S.representations,
U=S.bufferSizes,Z=new f,aa=u(C(E,"update"),C(E,"error").map(function(a){if(a.target&&a.target.error)throw a.target.error;q.error("buffer: error event",a);throw Error("buffer: error event");})).share().ignoreElements().startWith(!0);return p(da,a,n.identity).flatMapLatest(r)}},function(r,h,c){function n(c){this.buffer=c;this.queue=[];this.flushing=null;this._onUpdate=this.onUpdate.bind(this);this._onError=this.onError.bind(this);this._flush=this.flush.bind(this);this.buffer.addEventListener("update",
this._onUpdate);this.buffer.addEventListener("error",this._onError);this.buffer.addEventListener("updateend",this._flush)}var q=c(3).Subject;n.prototype={dispose:function(){this.buffer.removeEventListener("update",this._onUpdate);this.buffer.removeEventListener("error",this._onError);this.buffer.removeEventListener("updateend",this._flush);this.buffer=null;this.queue.length=0;this.flushing=null},onUpdate:function(c){this.flushing&&(this.flushing.onNext(c),this.flushing.onCompleted(),this.flushing=
null)},onError:function(c){this.flushing&&(this.flushing.onError(c),this.flushing=null)},queueAction:function(c,a){var b=new q;1===this.queue.unshift({type:c,args:a,subj:b})&&this.flush();return b},appendBuffer:function(c){return this.queueAction("append",c)},removeBuffer:function(c){return this.queueAction("remove",{start:c.start,end:c.end})},appendStream:function(c){return this.queueAction("stream",c)},flush:function(){if(!this.flushing&&0!==this.queue.length&&!this.buffer.updating){var c=this.queue.pop(),
a=c.type,b=c.args;this.flushing=c.subj;try{switch(a){case "append":this.buffer.appendBuffer(b);break;case "stream":this.buffer.appendStream(b);break;case "remove":this.buffer.remove(b.start,b.end)}}catch(p){this.onError(p)}}}};r.exports=n},function(r,h){h=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.cache={}}c.prototype.add=function(c,h){c=c.segment;c.init&&(this.cache[c.id]=h)};c.prototype.get=function(c){c=c.segment;return c.init&&
(c=this.cache[c.id],null!=c)?c:null};return c}();r.exports={InitializationSegmentCache:h}},function(r,h,c){h=c(3).Observable;var n=h.merge,q=h.interval;c=c(8);var f=c.visibilityChange,a=c.videoSizeChange,b=window.devicePixelRatio||1;r.exports=function(c){var h=f().filter(function(a){return!1===a}),k=f().customDebounce(6E4).filter(function(a){return!0===a}),h=n(h,k).startWith(!1);return{videoWidth:n(q(2E4),a().customDebounce(500)).startWith("init").map(function(){return c.clientWidth*b}).changes(),
inBackground:h}}},function(r,h,c){function n(c,f){if("function"!==typeof f&&null!==f)throw new TypeError("Super expression must either be null or a function, not "+typeof f);c.prototype=Object.create(f&&f.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});f&&(Object.setPrototypeOf?Object.setPrototypeOf(c,f):c.__proto__=f)}h=function(c){function f(a){if(!(this instanceof f))throw new TypeError("Cannot call a class as a function");c.call(this,a)}n(f,c);f.getLiveEdge=function(){throw Error("not implemented");
};f.prototype.addSegment=function(a){this.index.timeline.push(a);return!0};return f}(c(18));r.exports=h},function(r,h){h=function(){function c(h){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.index=h}c.getLiveEdge=function(){throw Error("not implemented");};c.prototype.checkRange=function(c){var h=this.index,f=h.list;c=Math.floor(c/h.duration);return 0<=c&&c<f.length};c.prototype.createSegment=function(c,h){var f=this.index.list[c];return{id:c,media:f.media,
time:h,number:void 0,range:f.range,duration:this.index.duration}};c.prototype.getSegments=function(c,h){var f=this.index.duration;c=Math.floor(c/f);h=Math.floor(h/f);for(var a=[];c<h;)a.push(this.createSegment(c,c*f)),c++;return a};c.prototype.addSegment=function(){return!1};return c}();r.exports=h},function(r,h){h=function(){function c(h){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.index=h}c.getLiveEdge=function(c,h){return Date.now()/1E3-h.availabilityStartTime-
h.suggestedPresentationDelay};c.prototype.checkRange=function(){return!0};c.prototype.createSegment=function(c){var h=this.index,f=h.startNumber,h=h.duration;null==f&&(f=1);c=Math.floor(c/h)+f;return{id:c,media:this.index.media,time:c*h,number:c,range:void 0,duration:this.index.duration}};c.prototype.getSegments=function(c,h){for(var f=this.index.duration,a=[];c<=h;c+=f)a.push(this.createSegment(c));return a};c.prototype.addSegment=function(){return!1};return c}();r.exports=h},function(r,h,c){function n(c,
f,h){function k(a){return e(a).simpleTimeout(w,"timeout").map(function(b){b=q.extend({response:b},a);r.add(a,b);h.onNext({type:c,value:b});return b})}var n=f.resolver,e=f.loader,d=f.parser,u=3>=arguments.length||void 0===arguments[3]?{}:arguments[3];d||(d=p);e||(e=p);n||(n=p);var u=q.defaults(u,{totalRetry:3,timeout:1E4,cache:x}),w=u.timeout,r=u.cache,I={retryDelay:500,totalRetry:u.totalRetry,shouldRetry:function(a){return 500<=a.code||200>a.code||/timeout/.test(a.message)||/request: error event/.test(a.message)}};
return function(c){return n(c).flatMap(function(c){var d=a(function(){return k(c)},I),e=r.get(c);return q.isPromise(e)?b(e)["catch"](d):null===e?d():p(e)}).flatMap(function(a){return d(a).map(function(b){return q.extend({parsed:b},a)})})}}var q=c(1);h=c(3);var f=h.Subject;h=h.Observable;var a=c(5).retryWithBackoff,b=h.fromPromise,p=h.just,x={add:function(){},get:function(){return null}};r.exports=function(){var a=new f;return{createPipelines:function(b,c){c=c||{};var f=[],k;for(k in b)f[k]=n(k,b[k],
a,c[k]);return f},metrics:a}}},function(r,h,c){function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function q(a){B(a.man,"player: no manifest loaded")}function f(a,b){return a.filter(function(a){return a.type==b}).pluck("value")}var a=c(6),
b=c(1),p=c(4);h=c(3);var x=h.CompositeDisposable,k=h.BehaviorSubject,w=h.Observable,u=h.Subject,m=w.combineLatest,C=w.defer,e=c(5).on;h=c(10);var d=c(48),B=c(2),w=c(8),J=w.HTMLVideoElement_,M=w.exitFullscreen,I=w.requestFullscreen,W=w.isFullscreen,z=w.onFullscreenChange,w=c(19),E=w.getEmptyTimings,D=w.timingsSampler,R=w.toWallClockTime,S=w.fromWallClockTime,T=w.getLiveGap,P=c(27).InitializationSegmentCache,H=c(9).BufferedRanges,X=c(37).parseTimeFragment,ca=c(28),ea=c(12),fa=c(41),da=c(32),U=c(24),
Z=c(35),aa=c(16);c=function(c){function h(a){var b=this;if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");var d=a.videoElement,e=a.transport,f=a.transportOptions,t=a.defaultLanguage,m=a.defaultSubtitle,n=a.initVideoBitrate;a=a.initAudioBitrate;c.call(this);this.defaultTransport=e;this.defaultTransportOptions=f||{};d||(d=document.createElement("video"));B(d instanceof J,"requires an actual HTMLVideoElement");d.preload="auto";this.version="1.4.1";this.video=d;this.fullscreen=
z(d).subscribe(function(){return b.trigger("fullscreenChange",b.isFullscreen())});this.playing=new k;this.stream=new u;var f=da(),e=f.createPipelines,f=f.metrics,F=D(d),d=ca(d);this.createPipelines=e;this.metrics=f;this.timings=F;this.adaptive=U(f,F,d,{initVideoBitrate:n,initAudioBitrate:a,defaultLanguage:t,defaultSubtitle:m});this.muted=.1;this._setState("STOPPED");this.resetStates();this.log=p}n(h,c);h.prototype.resetStates=function(){this.man=null;this.reps={video:null,audio:null,text:null};this.adas=
{video:null,audio:null,text:null};this.evts={};this.frag={start:null,end:null}};h.prototype._clear=function(){this.subscriptions&&(this.subscriptions.dispose(),this.subscriptions=null)};h.prototype.stop=function(){"STOPPED"!==this.state&&(this.resetStates(),this._clear(),this._setState("STOPPED"))};h.prototype.dispose=function(){this.stop();this.metrics.dispose();this.adaptive.dispose();this.fullscreen.dispose();this.stream.dispose();this.video=this.createPipelines=this.timings=this.stream=this.fullscreen=
this.adaptive=this.metrics=null};h.prototype.__recordState=function(a,b){this.evts[a]!==b&&(this.evts[a]=b,this.trigger(a+"Change",b))};h.prototype._parseOptions=function(a){var c=b.defaults(b.cloneObject(a),{transport:this.defaultTransport,transportOptions:{},keySystems:[],timeFragment:{},subtitles:[],autoPlay:!1,directFile:!1}),d=c.transport,e=c.transportOptions,f=c.url,k=c.manifests,h=c.keySystems,t=c.timeFragment,m=c.subtitles,n=c.autoPlay,c=c.directFile,t=X(t);B(!!k^!!f,"player: you have to pass either a url or a list of manifests");
k&&(h=k[0],f=h.url,m=h.subtitles||[],h=b.compact(b.pluck(k,"keySystem")));b.isString(d)&&(d=fa[d]);b.isFunction(d)&&(d=d(b.defaults(e,this.defaultTransportOptions)));B(d,"player: transport "+a.transport+" is not supported");c&&(c=ea.createDirectFileManifest());return{url:f,keySystems:h,subtitles:m,timeFragment:t,autoPlay:n,transport:d,directFile:c}};h.prototype.loadVideo=function(){var a=this,c=0>=arguments.length||void 0===arguments[0]?{}:arguments[0],c=this._parseOptions(c);p.info("loadvideo",c);
var d=c,k=d.url,h=d.keySystems,n=d.subtitles,D=d.timeFragment,F=d.autoPlay,c=d.transport,u=d.directFile;this.stop();this.frag=D;this.playing.onNext(F);var w=this.createPipelines(c,{audio:{cache:new P},video:{cache:new P}}),ea=this.adaptive,c=this.timings,d=this.video;try{var H=Z({url:k,keySystems:h,subtitles:n,timings:c,timeFragment:D,adaptive:ea,pipelines:w,videoElement:d,autoPlay:F,directFile:u})}catch(ga){H=C(function(){throw ga;})}H=H.publish();var k=f(H,"segment"),h=f(H,"manifest"),n=f(H,"stalled").startWith(null),
D=f(H,"loaded").filter(function(a){return!0===a}),u=u?D:m(D,f(k.pluck("adaptation"),"audio"),f(k.pluck("adaptation"),"video"),b.noop),u=u.take(1),n=u.map("LOADED").concat(m(this.playing,n,function(a,b){return b?"seeking"==b.name?"SEEKING":"BUFFERING":a?"PLAYING":"PAUSED"})).changes().startWith("LOADING"),q=this.subscriptions=new x;H=[e(d,["play","pause"]).each(function(b){return a.playing.onNext("play"==b.type)}),k.each(function(b){var c=b.adaptation.type,d=b.representation,e=b.adaptation;a.reps[c]=
d;a.adas[c]=e;"text"==c&&a.__recordState("subtitle",e.lang);"video"==c&&a.__recordState("videoBitrate",d.bitrate);"audio"==c&&(a.__recordState("language",e.lang),a.__recordState("audioBitrate",d.bitrate));a.trigger("progress",b)}),h.each(function(b){a.man=b;a.trigger("manifestChange",b)}),n.each(function(b){return a._setState(b)}),c.each(function(b){return a._triggerTimeChange(b)}),H.subscribe(function(){},function(b){a.resetStates();a.trigger("error",b);a._setState("STOPPED");a._clear()},function(){a.resetStates();
a._setState("ENDED");a._clear()}),H.subscribe(function(b){return a.stream.onNext(b)},function(b){return a.stream.onNext({type:"error",value:b})}),H.connect()];b.each(H,function(a){return q.add(a)});this.subscriptions||q.dispose();this._triggerTimeChange();return u.toPromise()};h.prototype._setState=function(a){this.state!==a&&(this.state=a,this.trigger("playerStateChange",a))};h.prototype._triggerTimeChange=function(a){this.man&&a?(this.man.isLive&&0<a.ts&&(a.wallClockTime=R(a.ts,this.man),a.liveGap=
T(a.ts,this.man)),this.trigger("currentTimeChange",a)):this.trigger("currentTimeChange",E())};h.prototype.getManifest=function(){return this.man};h.prototype.getVideoElement=function(){return this.video};h.prototype.getNativeTextTrack=function(){return this.video.textTracks[0]};h.prototype.getPlayerState=function(){return this.state};h.prototype.isLive=function(){q(this);return this.man.isLive};h.prototype.getUrl=function(){q(this);return this.man.locations[0]};h.prototype.getVideoDuration=function(){return this.video.duration};
h.prototype.getVideoLoadedTime=function(){return(new H(this.video.buffered)).getSize(this.video.currentTime)};h.prototype.getVideoPlayedTime=function(){return(new H(this.video.buffered)).getLoaded(this.video.currentTime)};h.prototype.getCurrentTime=function(){if(!this.man)return 0;var a=this.video.currentTime;return this.man.isLive?R(a,this.man):a};h.prototype.getStartTime=function(){return this.frag.start};h.prototype.getEndTime=function(){return this.frag.end};h.prototype.getPlaybackRate=function(){return this.video.playbackRate};
h.prototype.getVolume=function(){return this.video.volume};h.prototype.isFullscreen=function(){return W()};h.prototype.getAvailableLanguages=function(){return this.man&&ea.getAvailableLanguages(this.man)||[]};h.prototype.getAvailableSubtitles=function(){return this.man&&ea.getAvailableSubtitles(this.man)||[]};h.prototype.getLanguage=function(){return this.adaptive.getLanguage()};h.prototype.getSubtitle=function(){return this.adaptive.getSubtitle()};h.prototype.getAvailableVideoBitrates=function(){var a=
ea.getAdaptationsByType(this.man,"video");return a[0]&&a[0].bitrates||[]};h.prototype.getAvailableAudioBitrates=function(){var a=this.adas.audio;return a&&a.bitrates||[]};h.prototype.getVideoBitrate=function(){return this.evts.videoBitrate};h.prototype.getAudioBitrate=function(){return this.evts.audioBitrate};h.prototype.getVideoMaxBitrate=function(){return this.adaptive.getVideoMaxBitrate()};h.prototype.getAudioMaxBitrate=function(){return this.adaptive.getAudioMaxBitrate()};h.prototype.getVideoBufferSize=
function(){return this.adaptive.getVideoBufferSize()};h.prototype.getAudioBufferSize=function(){return this.adaptive.getAudioBufferSize()};h.prototype.getAverageBitrates=function(){return this.adaptive.getAverageBitrates()};h.prototype.getMetrics=function(){return this.metrics};h.prototype.getTimings=function(){return this.timings};h.prototype.play=function(){this.video.play()};h.prototype.pause=function(){this.video.pause()};h.prototype.setPlaybackRate=function(b){var c=this;return new a(function(a){return a(c.video.playbackRate=
b)})};h.prototype.goToStart=function(){return this.seekTo(this.getStartTime())};h.prototype.seekTo=function(b){var c=this;return new a(function(a){B(c.man);var d=c.video.currentTime;c.man.isLive&&(b=S(b,c.man));b!==d?(p.info("seek to",b),a(c.video.currentTime=b)):a(d)})};h.prototype.setFullscreen=function(){!1===(0>=arguments.length||void 0===arguments[0]?!0:arguments[0])?M():I(this.video)};h.prototype.setVolume=function(a){a!==this.video.volume&&(this.video.volume=a,this.trigger("volumeChange",a))};
h.prototype.mute=function(){this.muted=this.getVolume()||.1;this.setVolume(0)};h.prototype.unMute=function(){0===this.getVolume()&&this.setVolume(this.muted)};h.prototype.setLanguage=function(c){var d=this;return new a(function(a){B(b.contains(d.getAvailableLanguages(),c),"player: unknown language");a(d.adaptive.setLanguage(c))})};h.prototype.setSubtitle=function(c){var d=this;return(new a(function(a){B(!c||b.contains(d.getAvailableSubtitles(),c),"player: unknown subtitle");a(d.adaptive.setSubtitle(c||
""))})).then(function(){c||d.__recordState("subtitle",null)})};h.prototype.setVideoBitrate=function(c){var d=this;return new a(function(a){B(0===c||b.contains(d.getAvailableVideoBitrates(),c),"player: video bitrate unavailable");a(d.adaptive.setVideoBitrate(c))})};h.prototype.setAudioBitrate=function(c){var d=this;return new a(function(a){B(0===c||b.contains(d.getAvailableAudioBitrates(),c),"player: audio bitrate unavailable");a(d.adaptive.setAudioBitrate(c))})};h.prototype.setVideoMaxBitrate=function(b){var c=
this;return new a(function(a){a(c.adaptive.setVideoMaxBitrate(b))})};h.prototype.setAudioMaxBitrate=function(b){var c=this;return new a(function(a){a(c.adaptive.setAudioMaxBitrate(b))})};h.prototype.setVideoBufferSize=function(b){var c=this;return new a(function(a){return a(c.adaptive.setVideoBufferSize(b))})};h.prototype.setAudioBufferSize=function(b){var c=this;return new a(function(a){return a(c.adaptive.setAudioBufferSize(b))})};h.prototype.getStreamObservable=function(){return this.stream};h.prototype.getDebug=
function(){return d.getDebug(this)};h.prototype.showDebug=function(){d.showDebug(this,this.video)};h.prototype.hideDebug=function(){d.hideDebug()};h.prototype.toggleDebug=function(){d.toggleDebug(this,this.video)};h.prototype.getCurrentKeySystem=function(){return aa.getCurrentKeySystem()};return h}(h);r.exports=c},function(r,h,c){function n(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&
c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}h=c(10);var q=c(9).BufferedRanges,f=c(6),a=c(2);c=function(b){function c(a){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");b.call(this);this.codec=a;this.updating=!1;this.readyState="opened";this.buffered=new q}n(c,b);c.prototype.appendBuffer=function(a){var b=this;return this._lock(function(){return b._append(a)})};c.prototype.remove=
function(a,b){var c=this;return this._lock(function(){return c._remove(a,b)})};c.prototype.abort=function(){this.remove(0,Infinity);this.updating=!1;this.readyState="closed";this._abort()};c.prototype._append=function(){};c.prototype._remove=function(){};c.prototype._abort=function(){};c.prototype._lock=function(b){var c=this;a(!this.updating,"text-buffer: cannot remove while updating");this.updating=!0;this.trigger("updatestart");return(new f(function(a){return a(b())})).then(function(){return c._unlock("update")},
function(a){return c._unlock("error",a)})};c.prototype._unlock=function(a,b){this.trigger(a,b);this.updating=!1;this.trigger("updateend")};return c}(h);r.exports=c},function(r,h,c){function n(a,b){return p.create(function(c){b.src=a;c.onNext({url:a});return function(){b.src=""}})}function q(a){return"audio"==a||"video"==a}var f=c(1),a=c(4),b=c(2),p=c(3).Observable;h=c(5);var x=h.first,k=h.on;h=c(19);var w=h.getLiveGap,u=h.seekingsSampler,m=h.fromWallClockTime,C=c(5).retryWithBackoff,e=p.empty,d=p.never,
B=p.just,J=p.merge,M=p.combineLatest,I=Math.min;h=c(8);var W=h.MediaSource_,z=h.sourceOpen,E=h.canPlay,D=h.loadedMetadata,R=c(36),S=c(17).getLiveEdge,T=c(25),P=c(16);c=c(12);var H=c.normalizeManifest,X=c.mergeManifestsIndex,ca=c.mutateManifestLiveGap,ea=c.getAdaptations;r.exports=function(c){function h(b,c,d){var e=d.type;d=d.codec;if(q(e))za[e]?b=za[e]:(a.info("add sourcebuffer",d),b=c.addSourceBuffer(d),za[e]=b);else{if(c=G[e])try{c.abort()}catch(la){a.warn(la)}finally{delete G[e]}if("text"==e)a.info("add text sourcebuffer",
d),b=new R(b,d);else throw e="stream: unknown buffer type "+e,a.error(e),Error(e);G[e]=b}return b}function r(b,c,d){b=d.type;var e=q(b);e?(d=za[b],delete za[b]):(d=G[b],delete G[b]);if(d)try{d.abort(),e&&c.removeSourceBuffer(d)}catch(la){a.warn(la)}}function fa(a){var b=K.map(function(b){if(Ya){var c=f.cloneObject(b);c.ts=I(b.ts,ta);c.duration=I(b.duration,ta)}else c=b;c.liveGap=w(b.ts,a);return c}),c=u(b);return{timings:b,seekings:c}}function aa(b,c,f,k){var m=c.type;return La.getAdaptationsChoice(m,
c.adaptations).flatMapLatest(function(t){if(!t)return r(ga,b,c),d();var n=La.getBufferAdapters(t);t=T({sourceBuffer:h(ga,b,c),pipeline:Aa[m],adaptation:t,timings:f,seekings:k,adapters:n});return q(m)?t:t["catch"](function(b){a.error("buffer",m,"has crashed",b);return e()})})}function ka(c){var d=D(ga).tap(function(){var d=c.duration,e=va,k=ta,h=/^\d*(\.\d+)? ?%$/;f.isString(e)&&h.test(e)&&(e=parseFloat(e)/100*d);f.isString(k)&&h.test(k)&&(ta=parseFloat(k)/100*d);if(Infinity===k||"100%"===k)k=d;c.isLive?
e=e?m(e,c):S(c):b(e<d&&k<=d,"stream: bad startTime and endTime");a.info("set initial time",e);ga.currentTime=e}),e=E(ga).tap(function(){a.info("canplay event");Ma&&ga.play();Ma=!0});return x(M(d,e,f.noop)).map({type:"loaded",value:!0}).startWith({type:"loaded",value:!1})}function F(){return ja&&ja.length?P(ga,ja):P.onEncrypted(ga).map(function(){a.error("eme: ciphered media and no keySystem passed");throw Error("eme: ciphered media and no keySystem passed");})}function t(b){var c=1>=arguments.length||
void 0===arguments[1]?!0:arguments[1];return b.distinctUntilChanged(null,function(b,d){var e=d.stalled,f=b.stalled;b=f||e?f&&e?f.name==e.name:!1:!0;!b&&c&&(f?(a.info("resume playback",d.ts,d.name),ga.playbackRate=f.playback):(a.info("stop playback",d.ts,d.name),ga.playbackRate=0));e&&(e=d.buffered.getNextRangeGap(d.ts),1>e&&(f=d.ts+e+1/60,ga.currentTime=f,a.warn("discontinuity seek",d.ts,e,f)));return b}).map(function(a){return{type:"stalled",value:a.stalled}})}function O(a){return a&&"out-of-index"==
a.type}function ma(b,c){if(O(c))return a.info("out of index"),xa({url:b.locations[0]}).map(function(a){a=a.parsed;return{type:"manifest",value:X(b,H(a.url,a.manifest,V))}});c&&"precondition-failed"==c.type&&(ca(b,1),a.warn("precondition failed",b.presentationLiveGap));return B(c)}function ua(a,b,c,d){var e=f.map(ea(b),function(b){return aa(a,b,c,d)}),e=J(e);return b.isLive?e.distinctUntilChanged(null,function(a,b){return O(b)&&O(a)}).concatMap(function(a){return ma(b,a)}):e}function Va(b,c){var d=
fa(c),e=d.timings,f=d.seekings,d=B({type:"manifest",value:c}),h=ka(c);b=ua(b,c,e,f);c=F();e=t(e,!0);f=k(ga,"error").flatMap(function(){var b="stream: video element MEDIA_ERR code "+ga.error.code;a.error(b);throw Error(b);});return J(d,h,c,b,e,f)}function Ka(){var a=fa(wa,{timeInterval:1E3}).timings,b=B({type:"manifest",value:wa}),c=ka(wa),a=t(a,!1);return J(b,c,a)}var Qa=c.url,ja=c.keySystems,V=c.subtitles,K=c.timings,Ea=c.timeFragment,La=c.adaptive,Aa=c.pipelines,ga=c.videoElement,Ma=c.autoPlay,
wa=c.directFile;b(W,"player: browser is required to support MediaSource");var va=Ea.start,ta=Ea.end,Ya=Infinity>ta,xa=Aa.manifest,za={},G={};c=K.filter(function(a){var b=a.ts;a=a.duration;return 0<a&&.2>I(a,ta)-b}).take(1).share();if(wa)return n(Qa,ga).flatMap(Ka).takeUntil(c);Ea=C(function(b){var c=b.url,d=b.mediaSource;b=z(d);return xa({url:c}).zip(b,f.identity).flatMap(function(b){b=b.parsed;b=H(b.url,b.manifest,V);d.duration=Infinity===b.duration?Number.MAX_VALUE:b.duration;a.info("set duration",
d.duration);return Va(d,b)})},{retryDelay:500,totalRetry:3,resetDelay:6E4,shouldRetry:function(b,c){if(/MEDIA_ERR/.test(b.message))return!1;a.warn("stream retry",b,c);return!0}});return function(b,c){return p.create(function(d){var e=new W,k=c.src=URL.createObjectURL(e);d.onNext({url:b,mediaSource:e});a.info("create mediasource object",k);return function(){if(e&&"closed"!=e.readyState){var b=e.readyState;f.each(f.cloneArray(e.sourceBuffers),function(c){try{"open"==b&&c.abort(),e.removeSourceBuffer(c)}catch(ia){a.warn("error while disposing souceBuffer",
ia)}})}f.each(f.keys(G),function(b){b=G[b];try{b.abort()}catch(ia){a.warn("error while disposing souceBuffer",ia)}});c.src="";if(k)try{URL.revokeObjectURL(k)}catch(Za){a.warn("error while revoking ObjectURL",Za)}k=e=G=za=null}})}(Qa,ga).flatMap(Ea).takeUntil(c)}},function(r,h,c){function n(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,
configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}var q=c(6),f=c(1);h=c(34);var a=window.VTTCue||window.TextTrackCue;h=function(b){function c(a,f){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");b.call(this,f);this.video=a;this.codec=f;this.isVTT=/^text\/vtt/.test(f);f=document.createElement("track");var k=f.track;this.trackElement=f;this.track=k;f.kind="subtitles";k.mode="showing";a.appendChild(f)}n(c,b);c.prototype.createCuesFromArray=
function(b){return b.length?f.compact(f.map(b,function(b){var c=b.start,f=b.end;if(b=b.text)return new a(c,f,b)})):[]};c.prototype._append=function(a){var b=this;if(this.isVTT)a=new Blob([a],{type:"text/vtt"}),a=URL.createObjectURL(a),this.trackElement.src=a,this.buffered.insert(0,Infinity);else{var c=this.createCuesFromArray(a);c.length&&(f.each(c,function(a){return b.track.addCue(a)}),a=c[0],c=f.last(c),this.buffered.insert(0,a.startTime,c.endTime))}return q.resolve()};c.prototype._remove=function(a,
b){var c=this.track;f.each(f.cloneArray(c.cues),function(f){var k=f.startTime,h=f.endTime;k>=a&&k<=b&&h<=b&&c.removeCue(f)})};c.prototype._abort=function(){var a=this.trackElement,b=this.video;a&&b&&b.hasChildNodes(a)&&b.removeChild(a);this.track.mode="disabled";this.size=0;this.video=this.track=this.trackElement=null};return c}(h);r.exports=h},function(r,h,c){function n(a){if(!a)return!1;a=a.replace(/^npt\:/,"").replace(/\.$/,"");a=a.split(":");var b=a.length;switch(b){case 3:var c=parseInt(a[0],
10);var f=parseInt(a[1],10);a=parseFloat(a[2]);break;case 2:c=0;f=parseInt(a[0],10);a=parseFloat(a[1]);break;case 1:f=c=0;a=parseFloat(a[0]);break;default:return!1}p(23>=c,x);p(59>=f,x);p(1>=b||60>a,x);return 3600*c+60*f+a}function q(a){if(!a)return!1;a=a.split(":");switch(a.length){case 3:var b=parseInt(a[0],10);var c=parseInt(a[1],10);var f=parseInt(a[2],10);var h=a=0;break;case 4:b=parseInt(a[0],10);c=parseInt(a[1],10);f=parseInt(a[2],10);-1===a[3].indexOf(".")?(a=parseInt(a[3],10),h=0):(h=a[3].split("."),
a=parseInt(h[0],10),h=parseInt(h[1],10));break;default:return!1}p(23>=b,x);p(59>=c,x);p(59>=f,x);return 3600*b+60*c+f+.001*a+1E-6*h}function f(a){return new Date(Date.parse(a))}function a(a){return a?a:!1}var b=c(1),p=c(2),x="Invalid MediaFragment";r.exports={parseTimeFragment:function(c){if(b.isString(c)){var h=c,k=h.split(",");p(2>=k.length,x);c=k[0]?k[0]:"";k=k[1]?k[1]:"";p((c||k)&&(!c||k||-1===h.indexOf(",")),x);c=c.replace(/^smpte(-25|-30|-30-drop)?\:/,"").replace("clock:","");var h=/^((npt\:)?((\d+\:(\d\d)\:(\d\d))|((\d\d)\:(\d\d))|(\d+))(\.\d*)?)?$/,
m=/^(\d+\:\d\d\:\d\d(\:\d\d(\.\d\d)?)?)?$/,r=/^((\d{4})(-(\d{2})(-(\d{2})(T(\d{2})\:(\d{2})(\:(\d{2})(\.(\d+))?)?(Z|(([-\+])(\d{2})\:(\d{2})))?)?)?)?)?$/,e=/^(\d*(\.\d+)? ?%)?$/;if(h.test(c)&&h.test(k))h=n;else if(m.test(c)&&m.test(k))h=q;else if(r.test(c)&&r.test(k))h=f;else if(e.test(c)&&e.test(k))h=a;else throw Error(x);c=h(c);k=h(k);p(!1!==c||!1!==k,x);c={start:!1===c?"":c,end:!1===k?"":k}}else c=b.pick(c,["start","end"]);b.isString(c.start)&&b.isString(c.end)?(c.start||(c.start="0%"),c.end||
(c.end="100%")):(c.start||(c.start=0),c.end||(c.end=Infinity));b.isString(c.start)&&b.isString(c.end)?(p(0<=parseFloat(c.start)&&100>=parseFloat(c.start),"player: startTime should be between 0% and 100%"),p(0<=parseFloat(c.end)&&100>=parseFloat(c.end),"player: endTime should be between 0% and 100%")):(p((b.isNumber(c.start)||b.isDate(c.start))&&(b.isNumber(c.end)||b.isDate(c.end)),"player: timeFragment should have interface { start, end } where start and end are numbers or dates"),p(c.start<c.end,
"player: startTime should be lower than endTime"),p(0<=c.start,"player: startTime should be greater than 0"));return c}}},function(r,h,c){function n(a){var b=a[0];return(a=a[1])&&Infinity!==a?"bytes="+ +b+"-"+ +a:"bytes="+ +b+"-"}var q=c(1);h=c(3).Observable;var f=h.empty,a=h.merge,b=h.just;c(2);var p=c(14),x=c(11).resolveURL;h=c(39);var k=h.parseSidx,w=h.patchPssh,u=c(40),m=function(a){a.withMetadata=!0;return p(a)};r.exports=function(){var c=(0>=arguments.length||void 0===arguments[0]?{}:arguments[0]).contentProtectionParser;
c||(c=q.noop);var e={loader:function(b){var c=b.adaptation,d=b.representation,e=b.segment,h=e.media,k=e.range;b=e.indexRange;if(e.init&&!(h||k||b))return f();k=q.isArray(k)?{Range:n(k)}:null;if(h)var p=e.time,e=e.number,h=-1===h.indexOf("$")?h:h.replace(/\$\$/g,"$").replace(/\$RepresentationID\$/g,d.id).replace(/\$Bandwidth\$/g,d.bitrate).replace(/\$Number\$/g,e).replace(/\$Time\$/g,p);else h="";c=x(c.rootURL,c.baseURL,d.baseURL,h);d=m({url:c,format:"arraybuffer",headers:k});return q.isArray(b)?(b=
m({url:c,format:"arraybuffer",headers:{Range:n(b)}}),a(d,b)):d},parser:function(a){var c=a.adaptation,d=a.segment;a=new Uint8Array(a.response.blob);var e=d.init,f=d.indexRange,h;if(f=k(a,f?f[0]:0)){var m=f.segments;var n=f.timescale}e||(0<=d.time&&0<=d.duration?h={ts:d.time,d:d.duration}:f&&1===f.segments.length&&(h={ts:f.segments[0].ts,d:f.segments[0].d}));e&&c.contentProtection&&(a=w(a,c.contentProtection));return b({blob:a,currentSegment:h,nextSegments:m,timescale:n})}};return{manifest:{loader:function(a){return m({url:a.url,
format:"document"})},parser:function(a){a=a.response;return b({manifest:u(a.blob,c),url:a.url})}},audio:e,video:e,text:{loader:function(){}}}}},function(r,h,c){function n(a,b){for(var c=0,d=a.length,h,k;c+8<d&&(k=p(a,c),h=p(a,c+4),f(0<k,"dash: out of range size"),h!==b);)c+=k;if(c>=d)return-1;f(c+k<=d,"dash: atom out of range");return c}function q(b){var c=b.systemId;b=b.privateData;c=c.replace(/-/g,"");f(32===c.length);c=u(4,k(c),a(b.length),b);return u(a(c.length+8),w("pssh"),c)}var f=c(2);h=c(7);
var a=h.itobe4,b=h.be8toi,p=h.be4toi,x=h.be2toi,k=h.hexToBytes,w=h.strToBytes,u=h.concat;r.exports={parseSidx:function(a,c){var e=n(a,1936286840);if(-1==e)return null;var d=p(a,e),e=e+4+4,f=a[e],e=e+8,h=p(a,e),e=e+4;if(0===f)f=p(a,e),e+=4,c+=p(a,e)+d,e+=4;else if(1===f)f=b(a,e),e+=8,c+=b(a,e)+d,e+=8;else return null;for(var d=[],e=e+2,k=x(a,e),e=e+2;0<=--k;){var m=p(a,e),e=e+4,q=m&2147483647;if(1==(m&2147483648)>>>31)throw Error("not implemented");m=p(a,e);e+=4;e+=4;d.push({ts:f,d:m,r:0,range:[c,
c+q-1]});f+=m;c+=q}return{segments:d,timescale:h}},patchPssh:function(b,c){if(!c||!c.length)return b;var e=n(b,1836019574);if(-1==e)return b;for(var d=p(b,e),f=[b.subarray(e,e+d)],h=0;h<c.length;h++)f.push(q(c[h]));f=u.apply(null,f);f.set(a(f.length),0);return u(b.subarray(0,e),f,b.subarray(e+d))}}},function(r,h,c){function n(a){var b=R.last(a.timeline);return(b.ts+(b.r+1)*b.d)/a.timescale}function q(a,b){var c=ca[a.nodeName];S(c,"parser: no attributes for "+a.nodeName);return R.reduce(c,function(b,
c){var d=c.k,e=c.fn,f=c.n;c=c.def;a.hasAttribute(d)?b[f||d]=e(a.getAttribute(d)):null!=c&&(b[f||d]=c);return b},b||{})}function f(a){return a}function a(a){return"true"==a}function b(a){return"true"==a?!0:"false"==a?!1:parseInt(a)}function p(a){return new Date(Date.parse(a))}function x(a){if(!a)return 0;var b=T.exec(a);S(b,"parser: "+a+" is not a valid ISO8601 duration");return 31536E3*parseFloat(b[2]||0)+2592E3*parseFloat(b[4]||0)+86400*parseFloat(b[6]||0)+3600*parseFloat(b[8]||0)+60*parseFloat(b[10]||
0)+parseFloat(b[12]||0)}function k(a){var b=H.exec(a);if(!b)return-1;a=parseInt(b[1])||0;b=parseInt(b[2])||0;return 0<b?a/b:a}function w(a){return a}function u(a){return(a=P.exec(a))?[+a[1],+a[2]]:null}function m(a,b,c){for(a=a.firstElementChild;a;)c=b(c,a.nodeName,a),a=a.nextElementSibling;return c}function C(a){var b=m(a,function(a,b,c){if("Initialization"==b){var d,e;c.hasAttribute("range")&&(d=u(c.getAttribute("range")));c.hasAttribute("sourceURL")&&(e=c.getAttribute("sourceURL"));a.initialization=
{range:d,media:e}}return a},q(a));"SegmentBase"==a.nodeName&&(b.indexType="base",b.timeline=[]);return b}function e(a){return m(a,function(a,b,c){"SegmentTimeline"==b&&(a.indexType="timeline",a.timeline=d(c));return a},C(a))}function d(a){return m(a,function(a,b,c){b=a.length;c=q(c);null==c.ts&&(b=0<b&&a[b-1],c.ts=b?b.ts+b.d*(b.r+1):0);null==c.r&&(c.r=0);a.push(c);return a},[])}function B(a){a=e(a);a.indexType||(a.indexType="template");return a}function J(a){var b=e(a);b.list=[];b.indexType="list";
return m(a,function(a,b,c){"SegmentURL"==b&&a.list.push(q(c));return a},b)}function M(a){var b=m(a,function(a,b,c){switch(b){case "BaseURL":a.baseURL=c.textContent;break;case "SegmentBase":a.index=C(c);break;case "SegmentList":a.index=J(c);break;case "SegmentTemplate":a.index=B(c)}return a},{});return q(a,b)}function I(a,b){var c=m(a,function(a,c,d){switch(c){case "ContentProtection":c=b(q(d),d);a.contentProtection=c;break;case "ContentComponent":a.contentComponent=q(d);break;case "BaseURL":a.baseURL=
d.textContent;break;case "SegmentBase":a.index=C(d);break;case "SegmentList":a.index=J(d);break;case "SegmentTemplate":a.index=B(d);break;case "Representation":c=M(d),null==c.id&&(c.id=a.representations.length),a.representations.push(c)}return a},{representations:[]});return q(a,c)}function W(a,b){var c=q(a,m(a,function(a,c,d){switch(c){case "BaseURL":a.baseURL=d.textContent;break;case "AdaptationSet":c=I(d,b),null==c.id&&(c.id=a.adaptations.length),a.adaptations.push(c)}return a},{adaptations:[]}));
c.baseURL&&R.each(c.adaptations,function(a){return R.defaults(a,{baseURL:c.baseURL})});return c}function z(a,b){var c=a.documentElement;S.equal(c.nodeName,"MPD","parser: document root should be MPD");a=m(c,function(a,c,d){switch(c){case "BaseURL":a.baseURL=d.textContent;break;case "Location":a.locations.push(d.textContent);break;case "Period":a.periods.push(W(d,b))}return a},{transportType:"dash",periods:[],locations:[]});a=q(c,a);/isoff-live/.test(a.profiles)&&(c=(c=R.find(a.periods[0].adaptations,
function(a){return"video/mp4"==a.mimeType}))&&c.index,c=c.timeline?n(c):Date.now()/1E3-60,a.availabilityStartTime=a.availabilityStartTime.getTime()/1E3,a.presentationLiveGap=Date.now()/1E3-(c+a.availabilityStartTime));return a}function E(a,b){return z((new DOMParser).parseFromString(a,"application/xml"),b)}function D(a,b){if(R.isString(a))return E(a,b);if(a instanceof window.Document)return z(a,b);throw Error("parser: unsupported type to parse");}var R=c(1),S=c(2),T=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,
P=/([0-9]+)-([0-9]+)/,H=/([0-9]+)(\/([0-9]+))?/;h=[{k:"profiles",fn:f},{k:"width",fn:parseInt},{k:"height",fn:parseInt},{k:"frameRate",fn:k},{k:"audioSamplingRate",fn:f},{k:"mimeType",fn:f},{k:"segmentProfiles",fn:f},{k:"codecs",fn:f},{k:"maximumSAPPeriod",fn:parseFloat},{k:"maxPlayoutRate",fn:parseFloat},{k:"codingDependency",fn:a}];c=[{k:"timescale",fn:parseInt},{k:"presentationTimeOffset",fn:parseFloat,def:0},{k:"indexRange",fn:u},{k:"indexRangeExact",fn:a},{k:"availabilityTimeOffset",fn:parseFloat},
{k:"availabilityTimeComplete",fn:a}];var X=c.concat([{k:"duration",fn:parseInt},{k:"startNumber",fn:parseInt}]),ca={ContentProtection:[{k:"schemeIdUri",fn:f},{k:"value",fn:f}],SegmentURL:[{k:"media",fn:f},{k:"mediaRange",fn:u},{k:"index",fn:f},{k:"indexRange",fn:u}],S:[{k:"t",fn:parseInt,n:"ts"},{k:"d",fn:parseInt},{k:"r",fn:parseInt}],SegmentTimeline:[],SegmentBase:c,SegmentTemplate:X.concat([{k:"initialization",fn:function(a){return{media:a,range:void 0}}},{k:"index",fn:f},{k:"media",fn:f},{k:"bitstreamSwitching",
fn:f}]),SegmentList:X,ContentComponent:[{k:"id",fn:f},{k:"lang",fn:f},{k:"contentType",fn:f},{k:"par",fn:w}],Representation:h.concat([{k:"id",fn:f},{k:"bandwidth",fn:parseInt,n:"bitrate"},{k:"qualityRanking",fn:parseInt}]),AdaptationSet:h.concat([{k:"id",fn:f},{k:"group",fn:parseInt},{k:"lang",fn:f},{k:"contentType",fn:f},{k:"par",fn:w},{k:"minBandwidth",fn:parseInt,n:"minBitrate"},{k:"maxBandwidth",fn:parseInt,n:"maxBitrate"},{k:"minWidth",fn:parseInt},{k:"maxWidth",fn:parseInt},{k:"minHeight",fn:parseInt},
{k:"maxHeight",fn:parseInt},{k:"minFrameRate",fn:k},{k:"maxFrameRate",fn:k},{k:"segmentAlignment",fn:b},{k:"subsegmentAlignment",fn:b},{k:"bitstreamSwitching",fn:a}]),Period:[{k:"id",fn:f},{k:"start",fn:x},{k:"duration",fn:x},{k:"bitstreamSwitching",fn:a}],MPD:[{k:"id",fn:f},{k:"profiles",fn:f},{k:"type",fn:f},{k:"availabilityStartTime",fn:p},{k:"availabilityEndTime",fn:p},{k:"publishTime",fn:p},{k:"mediaPresentationDuration",fn:x,n:"duration"},{k:"minimumUpdatePeriod",fn:x},{k:"minBufferTime",fn:x},
{k:"timeShiftBufferDepth",fn:x},{k:"suggestedPresentationDelay",fn:x},{k:"maxSegmentDuration",fn:x},{k:"maxSubsegmentDuration",fn:x}]};D.parseFromString=E;D.parseFromDocument=z;r.exports=D},function(r,h,c){r.exports={smooth:c(42),dash:c(38)}},function(r,h,c){function n(a){return(a=a.match(D))&&a[1]||""}function q(a,b){return b?a.replace(D,"?token="+b):a.replace(D,"")}function f(a,b,c){return k(a.rootURL,a.baseURL,b.baseURL).replace(/\{bitrate\}/g,b.bitrate).replace(/\{start time\}/g,c.time)}h=c(1);
var a=c(3).Observable,b=a.empty,p=a.just,x=c(14),k=c(11).resolveURL,w=c(7).bytesToStr,u=c(4),m=c(44),a=c(43),C=a.patchSegment,e=a.createVideoInitSegment,d=a.createAudioInitSegment,B=a.getMdat,J=a.getTraf,M=a.parseTfrf,I=a.parseTfxd,a=c(45).parseSami;c=c(46).parseTTML;var W={"application/x-sami":a,"application/smil":a,"application/ttml+xml":c,"application/ttml+xml+mp4":c,"text/vtt":h.identity},z=/\.(isml?)(\?token=\S+)?$/,E=/\.wsx?(\?token=\S+)?/,D=/\?token=(\S+)/,R=function(a){a.withMetadata=!0;return x(a)};
r.exports=function(){function a(a,b,c){if(b.isLive)if(a=J(a)){var d=M(a);var e=I(a)}else u.warn("smooth: could not find traf atom");else d=null;e||(e={d:c.duration,ts:c.time});return{nextSegments:d,currentSegment:e}}var c=m(0>=arguments.length||void 0===arguments[0]?{}:arguments[0]),h={loader:function(a){var b=a.adaptation,c=a.representation;a=a.segment;if(a.init){a=b.smoothProtection||{};switch(b.type){case "video":var h=e(c.index.timescale,c.width,c.height,72,72,4,c.codecPrivateData,a.keyId,a.keySystems);
break;case "audio":h=d(c.index.timescale,c.channels,c.bitsPerSample,c.packetSize,c.samplingRate,c.codecPrivateData,a.keyId,a.keySystems)}return p({blob:h,size:h.length,duration:100})}if(h=a.range){var k=h[0];k=(h=h[1])&&Infinity!==h?"bytes="+ +k+"-"+ +h:"bytes="+ +k+"-";k={Range:k}}b=f(b,c,a);return R({url:b,format:"arraybuffer",headers:k})},parser:function(b){var c=b.adaptation,d=b.response;b=b.segment;if(b.init)return p({blob:d.blob,timings:null});d=new Uint8Array(d.blob);b=a(d,c,b);c=b.nextSegments;
b=b.currentSegment;return p({blob:C(d,b.ts),nextSegments:c,currentSegment:b})}};return{manifest:{resolver:function(a){a=a.url;var b=n(a);return(E.test(a)?R({url:q(a,""),format:"document"}).map(function(a){return a.blob.getElementsByTagName("media")[0].getAttribute("src")}):p(a)).map(function(a){var c=a.match(z);a=c?a.replace(c[1],c[1]+"/manifest"):a;return{url:q(a,b)}})},loader:function(a){return R({url:a.url,format:"document"})},parser:function(a){a=a.response;return p({manifest:c(a.blob),url:a.url})}},
audio:h,video:h,text:{loader:function(a){var c=a.adaptation,d=a.representation,e=a.segment;if(e.init)return b();a=d.mimeType;c=f(c,d,e);return 0<=a.indexOf("mp4")?R({url:c,format:"arraybuffer"}):R({url:c,format:"text"})},parser:function(b){var c=b.response,d=b.adaptation,e=b.representation;b=b.segment;var f=d.lang,h=e.mimeType,k=W[h];if(!k)throw Error("smooth: could not find a text-track parser for the type "+h);var m=c.blob;0<=h.indexOf("mp4")?(m=new Uint8Array(m),c=w(B(m))):c=m;h=a(m,d,b);d=h.nextSegments;
h=h.currentSegment;return p({blob:k(c,f,b.time/e.index.timescale),currentSegment:h,nextSegments:d})}}}}},function(r,h,c){function n(a,b){return k(B(b.length+8),W(a),b)}function q(a,b,c,e,f){for(var h=0,k=a.length,m;h<k;){m=d(a,h);if(1970628964===d(a,h+4)&&d(a,h+8)===b&&d(a,h+12)===c&&d(a,h+16)===e&&d(a,h+20)===f)return a.subarray(h+24,h+m);h+=m}}function f(a,b){for(var c=0,e=a.length,f,h;c+8<e&&(h=d(a,c),f=d(a,c+4),x(0<h,"dash: out of range size"),f!==b);)c+=h;if(!(c>=e))return a.subarray(c+8,c+h)}
function a(a,b,c,d){var e=[a,b,c];p.each(d,function(a){a=z.pssh(a.systemId,a.privateData,a.keyIds);e.push(a)});return e}function b(b,c,d,e,f,h,m){d=z.mult("stbl",[d,n("stts",new Uint8Array(8)),n("stsc",new Uint8Array(8)),n("stsz",new Uint8Array(12)),n("stco",new Uint8Array(8))]);var D=n("url ",new Uint8Array([0,0,0,1])),D=z.dref(D),D=z.mult("dinf",[D]);e=z.mult("minf",[e,D,d]);c=z.hdlr(c);d=z.mdhd(b);c=z.mult("mdia",[d,c,e]);f=z.tkhd(f,h,1);f=z.mult("trak",[f,c]);h=z.trex(1);h=z.mult("mvex",[h]);
b=z.mvhd(b,1);m=z.mult("moov",a(b,h,f,m));b=z.ftyp("isom",["isom","iso2","iso6","avc1","dash"]);return k(b,m)}var p=c(1),x=c(2);h=c(7);var k=h.concat,w=h.strToBytes,u=h.hexToBytes,m=h.bytesToHex,C=h.be2toi,e=h.itobe2,d=h.be4toi,B=h.itobe4,J=h.be8toi,M=h.itobe8,I=[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350],W=p.memoize(w),z={mult:function(a,b){return n(a,k.apply(null,b))},avc1encv:function(a,b,c,d,f,h,m,p,q,u){return n(a,k(6,e(b),16,e(c),e(d),e(f),2,e(h),6,[0,1,m.length],w(m),
31-m.length,e(p),[255,255],q,"encv"===a?u:[]))},avcc:function(a,b,c){return n("avcC",k([1,a[1],a[2],a[3],252|(2===c?1:4===c?3:0),225],e(a.length),a,[1],e(b.length),b))},dref:function(a){return n("dref",k(7,[1],a))},esds:function(a,b){return n("esds",k(4,[3,25],e(a),[0,4,17,64,21],11,[5,2],u(b),[6,1,2]))},frma:function(a){return n("frma",w(a))},free:function(a){return n("free",new Uint8Array(a-8))},ftyp:function(a,b){return n("ftyp",k.apply(null,[w(a),[0,0,0,1]].concat(b.map(w))))},hdlr:function(a){return n("hdlr",
k(8,w("audio"===a?"soun":"vide"),12,w("Media Handler")))},mdhd:function(a){return n("mdhd",k(12,B(a),8))},moof:function(a,b){return z.mult("moof",[a,b])},mp4aenca:function(a,b,c,d,f,h,m,p){return n(a,k(6,e(b),8,e(c),e(d),2,e(f),e(h),2,m,"enca"===a?p:[]))},mvhd:function(a,b){return n("mvhd",k(12,B(a),4,[0,1],2,[1,0],10,[0,1],14,[0,1],14,[64,0,0,0],26,e(b+1)))},pssh:function(a){var b=1>=arguments.length||void 0===arguments[1]?[]:arguments[1],c=2>=arguments.length||void 0===arguments[2]?[]:arguments[2];
a=a.replace(/-/g,"");x(32===a.length,"wrong system id length");var d=c.length;if(0<d){var e=1;c=k.apply(null,[B(d)].concat(c))}else e=0,c=[];return n("pssh",k([e,0,0,0],u(a),c,B(b.length),b))},saio:function(a,b,c,d){return n("saio",k(4,[0,0,0,1],B(a.length+b.length+c.length+d.length+8+8+8+8)))},saiz:function(a){if(0===a.length)return n("saiz",new Uint8Array);var b=d(a,0),c=d(a,4),e=new Uint8Array(9+c);e.set(B(c),5);for(var c=9,f=8,h,k;f<a.length;)f+=8,2===(b&2)?(k=2,h=C(a,f),f+=2+6*h):k=h=0,e[c]=
6*h+8+k,c++;return n("saiz",e)},schm:function(a,b){return n("schm",k(4,w(a),B(b)))},senc:function(a){return n("senc",a)},smhd:function(){return n("smhd",new Uint8Array(8))},stsd:function(a){return n("stsd",k.apply(null,[7,[a.length]].concat(a)))},tkhd:function(a,b,c){return n("tkhd",k(B(7),8,B(c),20,[1,0,0,0],[0,1,0,0],12,[0,1,0,0],12,[64,0,0,0],e(a),2,e(b),2))},trex:function(a){return n("trex",k(4,B(a),[0,0,0,1],12))},tfdt:function(a){return n("tfdt",k([1,0,0,0],M(a)))},tenc:function(a,b,c){return n("tenc",
k(6,[a,b],u(c)))},traf:function(a,b,c,d,e){var f=[a,b,c];d&&f.push(z.senc(d),z.saiz(d),z.saio(e,a,b,c));return z.mult("traf",f)},trun:function(a){if(a[11]&1)return a;var b=new Uint8Array(a.length+4);b.set(B(a.length+4),0);b.set(a.slice(4,16),4);b[11]|=1;b.set([0,0,0,0],16);b.set(a.slice(16,a.length),20);return b},vmhd:function(){var a=new Uint8Array(12);a[3]=1;return n("vmhd",a)}},E={traf:function(a){return(a=f(a,1836019558))?f(a,1953653094):null},senc:function(a){return q(a,2721664850,1520127764,
2722393154,2086964724)},tfxd:function(a){return q(a,1830656773,1121273062,2162299933,2952222642)},tfrf:function(a){return q(a,3565190898,3392751253,2387879627,2655430559)},mdat:function(a){return f(a,1835295092)}};r.exports={getMdat:E.mdat,getTraf:E.traf,parseTfrf:function(a){a=E.tfrf(a);if(!a)return[];for(var b=[],c=a[0],e=a[4],f=0;f<e;f++){if(1==c){var h=J(a,16*f+5);var k=J(a,16*f+13)}else h=d(a,8*f+5),k=d(a,8*f+9);b.push({ts:h,d:k})}return b},parseTfxd:function(a){if(a=E.tfxd(a))return{d:J(a,12),
ts:J(a,4)}},createVideoInitSegment:function(a,c,d,e,f,h,k,m,n){n||(n=[]);var p=k.split("00000001");k=p[2];p=u(p[1]);k=u(k);h=z.avcc(p,k,h);n.length?(m=z.tenc(1,8,m),m=z.mult("schi",[m]),k=z.schm("cenc",65536),p=z.frma("avc1"),m=z.mult("sinf",[p,k,m]),e=z.avc1encv("encv",1,c,d,e,f,"AVC Coding",24,h,m)):e=z.avc1encv("avc1",1,c,d,e,f,"AVC Coding",24,h);e=z.stsd([e]);return b(a,"video",e,z.vmhd(),c,d,n)},createAudioInitSegment:function(a,c,d,f,h,k,n,p){p||(p=[]);k||(k=(32|I.indexOf(h)&31)<<4,k=m(e((k|
c&31)<<3)));k=z.esds(1,k);if(p.length){n=z.tenc(1,8,n);n=z.mult("schi",[n]);var q=z.schm("cenc",65536),u=z.frma("mp4a");n=z.mult("sinf",[u,q,n]);c=z.mp4aenca("enca",1,c,d,f,h,k,n)}else c=z.mp4aenca("mp4a",1,c,d,f,h,k);c=z.stsd([c]);return b(a,"audio",c,z.smhd(),0,0,p)},patchSegment:function(a,b){var c=a.subarray(0,d(a,0)),e=z.tfdt(b);b=e.length;var f=d(c,8),h=d(c,8+f),k=d(c,8+f+8),m=d(c,8+f+8+k),n=c.subarray(8,8+f),p=c.subarray(8+f+8,8+f+8+h-8),h=p.subarray(0,k),m=p.subarray(k,k+m);h.set([0,0,0,1],
12);p=E.senc(p);m=z.trun(m);e=z.traf(h,e,m,p,n);n=z.moof(n,e);b=8+f+8+k+b;k=a.length;f=n.length;c=c.length;a=a.subarray(c,k);c=new Uint8Array(f+(k-c));c.set(n,0);c.set(a,f);c.set(B(n.length+8),b+16);return c}}},function(r,h,c){function n(a){return"boolean"==typeof a?a:"string"==typeof a?"TRUE"===a.toUpperCase():!1}function q(b){var c=a.last(b.timeline);return(c.ts+(c.r+1)*c.d)/b.timescale}function f(a){return[{systemId:"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",privateData:p.concat([8,1,18,16],a)}]}var a=
c(1),b=c(2),p=c(7),x={audio:"audio/mp4",video:"video/mp4",text:"application/ttml+xml"},k={audio:"mp4a.40.2",video:"avc1.4D401E"};h={AACL:"audio/mp4",AVC1:"video/mp4",H264:"video/mp4",TTML:"application/ttml+xml+mp4"};c={AACL:"mp4a.40.5",AACH:"mp4a.40.5",AVC1:"avc1.4D401E",H264:"avc1.4D401E"};var w={audio:[["Bitrate","bitrate",parseInt],["AudioTag","audiotag",parseInt],["FourCC","mimeType",h],["FourCC","codecs",c],["Channels","channels",parseInt],["SamplingRate","samplingRate",parseInt],["BitsPerSample",
"bitsPerSample",parseInt],["PacketSize","packetSize",parseInt],["CodecPrivateData","codecPrivateData",String]],video:[["Bitrate","bitrate",parseInt],["FourCC","mimeType",h],["FourCC","codecs",c],["MaxWidth","width",parseInt],["MaxHeight","height",parseInt],["CodecPrivateData","codecPrivateData",String]],text:[["Bitrate","bitrate",parseInt],["FourCC","mimeType",h]]};r.exports=function(){function c(a,b,c){for(a=a.firstElementChild;a;)c=b(c,a.nodeName,a),a=a.nextElementSibling;return c}function h(b,
c){return a.reduce(c,function(c,d){var e=d[0],f=d[2];c[d[1]]=a.isFunction(f)?f(b.getAttribute(e)):f[b.getAttribute(e)];return c},{})}function r(d,e){d.hasAttribute("Timescale")&&(e=+d.getAttribute("Timescale"));var f=d.getAttribute("Type"),m=d.getAttribute("Subtype"),n=w[f];b(n,"parser: unrecognized QualityLevel type "+f);var p=0,q=c(d,function(a,b,c){switch(b){case "QualityLevel":c=h(c,n);if("video"!=f||c.bitrate>W)c.id=p++,a.representations.push(c);break;case "c":b=a.index;var d=a.index.timeline,
e=d.length,k=0<e?d[e-1]:{d:0,ts:0,r:0},m=+c.getAttribute("d"),F=c.getAttribute("t");(c=+c.getAttribute("r"))&&c--;0<e&&!k.d&&(k.d=F-k.ts,d[e-1]=k);0<e&&m==k.d&&null==F?k.r+=(c||0)+1:d.push({d:m,ts:null==F?k.ts+k.d*(k.r+1):+F,r:c});b.timeline=d}return a},{representations:[],index:{timeline:[],indexType:"timeline",timescale:e,initialization:{}}});e=q.representations;q=q.index;b(e.length,"parser: adaptation should have at least one representation");var r=e[0].codecs;r||(r=k[f],a.each(e,function(a){return a.codecs=
r}));var u=e[0].mimeType;u||(u=x[f],a.each(e,function(a){return a.mimeType=u}));return"ADVT"==m?null:{type:f,index:q,representations:e,name:d.getAttribute("Name"),lang:d.getAttribute("Language"),baseURL:d.getAttribute("Url")}}function e(a){return d((new DOMParser).parseFromString(a,"application/xml"))}function d(d){d=d.documentElement;b.equal(d.nodeName,"SmoothStreamingMedia","parser: document root should be SmoothStreamingMedia");b(/^[2]-[0-2]$/.test(d.getAttribute("MajorVersion")+"-"+d.getAttribute("MinorVersion")),
"Version should be 2.0, 2.1 or 2.2");var e=+d.getAttribute("Timescale")||1E7,f=0,h=c(d,function(a,c,d){switch(c){case "Protection":d=d.firstElementChild;b.equal(d.nodeName,"ProtectionHeader","parser: Protection should have ProtectionHeader child");c=p.strToBytes(atob(d.textContent));var h=p.le2toi(c,8);h=p.bytesToUTF16Str(c.subarray(10,10+h));h=(new DOMParser).parseFromString(h,"application/xml").querySelector("KID").textContent;h=p.guidToUuid(atob(h)).toLowerCase();var k=p.hexToBytes(h);d=d.getAttribute("SystemID").toLowerCase().replace(/\{|\}/g,
"");c={keyId:h,keySystems:[{systemId:d,privateData:c}].concat(z(k))};a.protection=c;break;case "StreamIndex":if(c=r(d,e))c.id=f++,a.adaptations.push(c)}return a},{protection:null,adaptations:[]}),k=h.protection,h=h.adaptations;a.each(h,function(a){return a.smoothProtection=k});var m=n(d.getAttribute("IsLive"));if(m){var u=M;var w=+d.getAttribute("DVRWindowLength")/e;var B=I;var C=a.find(h,function(a){return"video"==a.type});var x=a.find(h,function(a){return"audio"==a.type});C=Math.min(q(C.index),
q(x.index));C=Date.now()/1E3-(C+B)}return{transportType:"smoothstreaming",profiles:"",type:m?"dynamic":"static",suggestedPresentationDelay:u,timeShiftBufferDepth:w,presentationLiveGap:C,availabilityStartTime:B,periods:[{duration:(+d.getAttribute("Duration")||Infinity)/e,adaptations:h,laFragCount:+d.getAttribute("LookAheadFragmentCount")}]}}function B(b){if(a.isString(b))return e(b);if(b instanceof window.Document)return d(b);throw Error("parser: unsupported type to parse");}var J=0>=arguments.length||
void 0===arguments[0]?{}:arguments[0],M=J.suggestedPresentationDelay||20,I=J.referenceDateTime||Date.UTC(1970,0,1,0,0,0,0)/1E3,W=J.minRepresentationBitrate||19E4,z=J.keySystems||f;B.parseFromString=e;B.parseFromDocument=d;return B}},function(r,h,c){function n(c){return c.replace(b,"\n").replace(a,function(a,b){return String.fromCharCode(b)})}var q=c(1),f=c(2),a=/&#([0-9]+);/g,b=/<br>/gi,p=/<style[^>]*>([\s\S]*?)<\/style[^>]*>/i,x=/\s*<p class=([^>]+)>(.*)/i,k=/<sync[^>]+?start="?([0-9]*)"?[^0-9]/i;
r.exports={parseSami:function(a,b){var c=/<sync[ >]/ig,h=/<sync[ >]|<\/body>/ig,e=[],d=a.match(p)[1];h.exec(a);var r=/\.(\S+)\s*{([^}]*)}/gi;for(var u,w={};u=r.exec(d);){var I=u[1];u=u[2].match(/\s*lang:\s*(\S+);/i)[1];I&&u&&(w[u]=I)}d=w[b];for(f(d,"sami: could not find lang "+b+" in CSS");;){b=c.exec(a);r=h.exec(a);if(!b&&!r)break;if(!b||!r||b.index>=r.index)throw Error("parse error");r=a.slice(b.index,r.index);b=r.match(k);if(!b)throw Error("parse error: sync time attribute");w=+b[1];if(isNaN(w))throw Error("parse error: sync time attribute NaN");
b=e;r=r.split("\n");w/=1E3;for(I=r.length;0<=--I;)if(u=r[I].match(x)){var W=u[2];d===u[1]&&("&nbsp;"===W?q.last(b).end=w:b.push({text:n(W),start:w}))}}return e}}},function(r,h,c){function n(b,c){var h=0;b=b.firstChild;for(var k=[],e;b;){if(1===b.nodeType)switch(b.tagName.toUpperCase()){case "P":e=b;var d=c,p=q(e.getAttribute("begin"),d),r=q(e.getAttribute("end"),d),u=q(e.getAttribute("dur"),0);if(!f.isNumber(p)&&!f.isNumber(r)&&!f.isNumber(u))throw Error("ttml: unsupported timestamp format");0<u?
(null==p&&(p=h||d),null==r&&(r=p+u)):null==r&&(r=q(e.getAttribute("duration"),0),r=0<=r?r+p:Number.MAX_VALUE);e={id:e.getAttribute("xml:id")||e.getAttribute("id"),text:decodeURIComponent(x(e.innerHTML.replace(a,"\n"))),start:p,end:r};h=e.end;k.push(e);break;case "DIV":e=q(b.getAttribute("begin"),0),null==e&&(e=c),k.push.apply(k,n(b,e))}b=b.nextSibling}return k}function q(a,c){if(a){var f;if(f=a.match(b)){c=f;a=c[3];f=c[4];var h=c[6];return 3600*parseInt(c[2]||0,10)+60*parseInt(a,10)+parseInt(f,10)+
parseFloat("0."+h)}if(f=a.match(p))return a=f,f=a[4],parseFloat(a[1])*k[f]+c}}var f=c(1),a=/<br[^>]+>/gm,b=/^(([0-9]+):)?([0-9]+):([0-9]+)(\.([0-9]+))?$/,p=/(([0-9]+)(\.[0-9]+)?)(ms|h|m|s)/,x=window.escape,k={h:3600,m:60,s:1,ms:.001};r.exports={parseTTML:function(a,b,c){a=f.isString(a)?(new DOMParser).parseFromString(a,"text/xml"):a;if(!(a instanceof window.Document||a instanceof window.HTMLElement))throw Error("ttml: needs a Document to parse");a=a.querySelector("tt");if(!a)throw Error("ttml: could not find <tt> tag");
a=n(a.querySelector("body"),0);f.each(a,function(a){a.start+=c;a.end+=c});return a}}},function(r,h){function c(){this.arr=[]}c.prototype.add=function(c){this.arr.push(c)};c.prototype.remove=function(c){c=this.arr.indexOf(c);0<=c&&this.arr.splice(c,1)};c.prototype.test=function(c){return 0<=this.arr.indexOf(c)};c.prototype.size=function(){return this.arr.length};r.exports={ArraySet:c}},function(r,h,c){function n(a){return null==a?"":String(a).replace(w,function(a){return u[a]})}function q(a){var b=
a.getAverageBitrates(),c,d;b.video.subscribe(function(a){return d=a|0}).dispose();b.audio.subscribe(function(a){return c=a|0}).dispose();return{manifest:a.man,version:a.version,timeFragment:a.frag,currentTime:a.getCurrentTime(),state:a.getPlayerState(),buffer:p(a.video.buffered),volume:a.getVolume(),video:{adaptation:a.adas.video,representation:a.reps.video,maxBitrate:a.getVideoMaxBitrate(),bufferSize:a.getVideoBufferSize(),avrBitrate:d},audio:{adaptation:a.adas.audio,representation:a.reps.audio,
maxBitrate:a.getAudioMaxBitrate(),bufferSize:a.getAudioBufferSize(),avrBitrate:c}}}function f(a,b){if(b=b.parentNode.querySelector("#cp--debug-infos-content")){try{var c=q(a)}catch(J){return}var d=c;a=d.video;var f=d.audio,d=d.manifest;c="<b>Player v"+c.version+"</b> ("+c.state+")<br>";d&&a&&f&&(c+=["Container: "+n(d.transportType),"Live: "+n(""+d.isLive),"Downloading bitrate (Kbit/s): "+(a.representation.bitrate/1E3).toFixed(3)+"/"+(f.representation.bitrate/1E3).toFixed(3),"Estimated bandwidth (Kbit/s): "+
(a.avrBitrate/1E3).toFixed(3)+"/"+(f.avrBitrate/1E3).toFixed(3),"Location: "+d.locations[0]].join("<br>"));b.innerHTML=c}}function a(a,c){var e="<style>\n#cp--debug-infos {\n  position: absolute;\n  top: "+n(c.offsetTop+10)+"px;\n  left: "+n(c.offsetLeft+10)+'px;\n  width: 500px;\n  height: 300px;\n  background-color: rgba(10, 10, 10, 0.83);\n  overflow: hidden;\n  color: white;\n  text-align: left;\n  padding: 2em;\n  box-sizing: border-box;\n}\n#cp--debug-hide-infos {\n  float: right;\n  cursor: pointer;\n}\n</style>\n<div id="cp--debug-infos">\n  <a id="cp--debug-hide-infos">[x]</a>\n  <p id="cp--debug-infos-content"></p>\n</div>',
d=c.parentNode,h=d.querySelector("#cp--debug-infos-container");h||(h=document.createElement("div"),h.setAttribute("id","cp--debug-infos-container"),d.appendChild(h));h.innerHTML=e;k||(k=d.querySelector("#cp--debug-hide-infos"),k.addEventListener("click",function(){return b(c)}));x&&clearInterval(x);x=setInterval(function(){return f(a,c)},1E3);f(a,c)}function b(a){(a=a.parentNode.querySelector("#cp--debug-infos-container"))&&a.parentNode.removeChild(a);x&&(clearInterval(x),x=null);k&&(k.removeEventListener("click",
b),k=null)}var p=c(9).bufferedToArray,x,k,w=/[&<>"']/g,u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};r.exports={getDebug:q,showDebug:a,hideDebug:b,toggleDebug:function(c,f){f.parentNode.querySelector("#cp--debug-infos-container")?b(f):a(c,f)}}},function(r,h,c){var n;(function(q,f,a){(function(){function b(a){return"function"===typeof a}function p(){return function(){q.nextTick(u)}}function r(){var a=0,b=new ea(u),c=document.createTextNode("");b.observe(c,{characterData:!0});return function(){c.data=
a=++a%2}}function k(){var a=new MessageChannel;a.port1.onmessage=u;return function(){a.port2.postMessage(0)}}function w(){return function(){setTimeout(u,1)}}function u(){for(var a=0;a<H;a+=2)(0,fa[a])(fa[a+1]),fa[a]=void 0,fa[a+1]=void 0;H=0}function m(){}function C(a,b,c,d){try{a.call(b,c,d)}catch(ua){return ua}}function e(a,b,c){X(function(a){var d=!1,e=C(c,b,function(c){d||(d=!0,b!==c?B(a,c):M(a,c))},function(b){d||(d=!0,I(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,I(a,e))},
a)}function d(a,b){1===b._state?M(a,b._result):2===a._state?I(a,b._result):W(b,void 0,function(b){B(a,b)},function(b){I(a,b)})}function B(a,c){if(a===c)I(a,new TypeError("You cannot resolve a promise with itself"));else if("function"===typeof c||"object"===typeof c&&null!==c)if(c.constructor===a.constructor)d(a,c);else{try{var f=c.then}catch(ma){U.error=ma,f=U}f===U?I(a,U.error):void 0===f?M(a,c):b(f)?e(a,c,f):M(a,c)}else M(a,c)}function J(a){a._onerror&&a._onerror(a._result);z(a)}function M(a,b){void 0===
a._state&&(a._result=b,a._state=1,0!==a._subscribers.length&&X(z,a))}function I(a,b){void 0===a._state&&(a._state=2,a._result=b,X(J,a))}function W(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null;e[f]=b;e[f+1]=c;e[f+2]=d;0===f&&a._state&&X(z,a)}function z(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,h=0;h<b.length;h+=3)d=b[h],e=b[h+c],d?D(c,d,e,f):e(f);a._subscribers.length=0}}function E(){this.error=null}function D(a,c,d,e){var f=b(d);if(f){try{var h=d(e)}catch(V){Z.error=
V,h=Z}if(h===Z){var k=!0;var m=h.error;h=null}else var n=!0;if(c===h){I(c,new TypeError("A promises callback cannot return that same promise."));return}}else h=e,n=!0;void 0===c._state&&(f&&n?B(c,h):k?I(c,m):1===a?M(c,h):2===a&&I(c,h))}function R(a,b){try{b(function(b){B(a,b)},function(b){I(a,b)})}catch(O){I(a,O)}}function S(a,b,c,d){this._instanceConstructor=a;this.promise=new a(m,d);this._abortOnReject=c;this._validateInput(b)?(this._input=b,this._remaining=this.length=b.length,this._init(),0===
this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&M(this.promise,this._result))):I(this.promise,this._validationError())}function T(a){this._id=aa++;this._result=this._state=void 0;this._subscribers=[];if(m!==a){if(!b(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof T))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
R(this,a)}}var P=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},H=0,X=function(a,b){fa[H]=a;fa[H+1]=b;H+=2;2===H&&da()},ca="undefined"!==typeof window?window:{},ea=ca.MutationObserver||ca.WebKitMutationObserver,ca="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel,fa=Array(1E3);var da="undefined"!==typeof q&&"[object process]"==={}.toString.call(q)?p():ea?r():ca?k():w();var U=new E,Z=
new E;S.prototype._validateInput=function(a){return P(a)};S.prototype._validationError=function(){return Error("Array Methods must be provided an Array")};S.prototype._init=function(){this._result=Array(this.length)};S.prototype._enumerate=function(){for(var a=this.length,b=this.promise,c=this._input,d=0;void 0===b._state&&d<a;d++)this._eachEntry(c[d],d)};S.prototype._eachEntry=function(a,b){var c=this._instanceConstructor;"object"===typeof a&&null!==a?a.constructor===c&&void 0!==a._state?(a._onerror=
null,this._settledAt(a._state,b,a._result)):this._willSettleAt(c.resolve(a),b):(this._remaining--,this._result[b]=this._makeResult(1,b,a))};S.prototype._settledAt=function(a,b,c){var d=this.promise;void 0===d._state&&(this._remaining--,this._abortOnReject&&2===a?I(d,c):this._result[b]=this._makeResult(a,b,c));0===this._remaining&&M(d,this._result)};S.prototype._makeResult=function(a,b,c){return c};S.prototype._willSettleAt=function(a,b){var c=this;W(a,void 0,function(a){c._settledAt(1,b,a)},function(a){c._settledAt(2,
b,a)})};var aa=0;T.all=function(a,b){return(new S(this,a,!0,b)).promise};T.race=function(a,b){function c(a){B(e,a)}function d(a){I(e,a)}var e=new this(m,b);if(!P(a))return I(e,new TypeError("You must pass an array to race.")),e;b=a.length;for(var f=0;void 0===e._state&&f<b;f++)W(this.resolve(a[f]),void 0,c,d);return e};T.resolve=function(a,b){if(a&&"object"===typeof a&&a.constructor===this)return a;b=new this(m,b);B(b,a);return b};T.reject=function(a,b){b=new this(m,b);I(b,a);return b};T.prototype=
{constructor:T,then:function(a,b){var c=this._state;if(1===c&&!a||2===c&&!b)return this;var d=new this.constructor(m),e=this._result;if(c){var f=arguments[c-1];X(function(){D(c,d,f,e)})}else W(this,d,a,b);return d},"catch":function(a){return this.then(null,a)}};var ka={Promise:T,polyfill:function(){var a="undefined"!==typeof f?f:"undefined"!==typeof window&&window.document?window:self;"Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var c;
new a.Promise(function(a){c=a});return b(c)}()||(a.Promise=T)}};c(50).amd?!(n=function(){return ka}.call(h,c,h,a),void 0!==n&&(a.exports=n)):"undefined"!==typeof a&&a.exports?a.exports=ka:"undefined"!==typeof this&&(this.ES6Promise=ka)}).call(this)}).call(h,c(15),function(){return this}(),c(22)(r))},function(r,h){r.exports=function(){throw Error("define cannot be used indirect");}}])});
